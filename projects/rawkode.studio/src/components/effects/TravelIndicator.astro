---
// TravelIndicator.astro component
---

<!-- Travel Indicator UI -->
<div
  id="travel-indicator"
  class="fixed bottom-5 right-5 bg-gray-900/80 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-700/50 text-xs text-gray-300 space-y-1 transition-opacity duration-500 ease-out opacity-0 pointer-events-none"
  style="z-index: 100;"
  data-visible="false"
>
  <!-- Blinking Heading -->
  <h4 id="travel-indicator-heading" class="text-center font-semibold text-amber-400 text-sm mb-1 font-mono">
    Gate Activity Detected
  </h4>

  <!-- Slot 1 -->
  <div class="travel-slot border-t border-gray-700/30 pt-1 mt-1" style="display: none;">
    <div class="flex justify-between items-center">
      <span class="travel-start-name font-mono text-blue-300/90"></span>
      <span class="mx-2 text-gray-500">&rarr;</span>
      <span class="travel-end-name font-mono text-blue-300/90"></span>
    </div>
    <div class="travel-visual relative w-40 h-2 bg-black/30 rounded-full overflow-hidden mx-auto">
       <div class="travel-indicator-line"></div>
       <div class="travel-indicator-dot"></div>
    </div>
  </div>

  <!-- Slot 2 -->
  <div class="travel-slot border-t border-gray-700/30 pt-1 mt-1" style="display: none;">
    <div class="flex justify-between items-center">
      <span class="travel-start-name font-mono text-blue-300/90"></span>
      <span class="mx-2 text-gray-500">&rarr;</span>
      <span class="travel-end-name font-mono text-blue-300/90"></span>
    </div>
    <div class="travel-visual relative w-40 h-2 bg-black/30 rounded-full overflow-hidden mx-auto">
       <div class="travel-indicator-line"></div>
       <div class="travel-indicator-dot"></div>
    </div>
  </div>

  <!-- Slot 3 -->
  <div class="travel-slot border-t border-gray-700/30 pt-1 mt-1" style="display: none;">
    <div class="flex justify-between items-center">
      <span class="travel-start-name font-mono text-blue-300/90"></span>
      <span class="mx-2 text-gray-500">&rarr;</span>
      <span class="travel-end-name font-mono text-blue-300/90"></span>
    </div>
    <div class="travel-visual relative w-40 h-2 bg-black/30 rounded-full overflow-hidden mx-auto">
       <div class="travel-indicator-line"></div>
       <div class="travel-indicator-dot"></div>
    </div>
  </div>
</div>

<style>
  /* Travel Indicator Specific Styles */
  .travel-indicator-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 1px;
    transform: translateY(-50%);
    background: repeating-linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.4),
      rgba(255, 255, 255, 0.4) 3px, /* Shorter dashes */
      transparent 3px,
      transparent 6px
    );
    animation: dashMove 0.8s linear infinite; /* Reuse main animation */
    animation-direction: normal; /* Always move left to right */
  }

  .travel-indicator-dot {
    position: absolute;
    top: 50%;
    left: 0; /* Start at left */
    width: 4px;
    height: 4px;
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 50%;
    box-shadow:
      0 0 4px 1px rgba(120, 220, 255, 0.9), /* Slightly smaller shadow */
      0 0 8px 2px rgba(50, 180, 255, 0.6);
    transform: translate(0, -50%);
    animation-name: travelIndicatorMove;
    animation-timing-function: linear; /* Use linear for simplicity */
    animation-fill-mode: forwards;
  }

  @keyframes travelIndicatorMove {
    from { left: 0%; transform: translate(0, -50%); }
    to   { left: 100%; transform: translate(-100%, -50%); } /* End fully inside */
  }

  /* Style for the Travel Indicator Heading */
  #travel-indicator-heading {
    animation: slowBlink 2.5s infinite ease-in-out;
  }

  /* Styles for Travel Indicator visibility */
  #travel-indicator.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .travel-slot {
     opacity: 0;
     transition: opacity 0.4s ease-out;
     pointer-events: none;
  }

  .travel-slot.active {
      opacity: 1;
      pointer-events: auto;
  }

  /* Animation for moving dashed line */
  @keyframes dashMove {
    from { background-position-x: 0; }
    to { background-position-x: 24px; }
  }

  /* Slow Blinking Animation */
  @keyframes slowBlink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }
</style>
