WEBVTT

NOTE
Transcription provided by Deepgram
Request Id: 5aac1ece-f8f3-44bc-8e30-be6c90f2442d
Created: 2025-04-29T14:15:09.061Z
Duration: 545.47815
Channels: 1

00:00:00.000 --> 00:00:01.040
<v Speaker 0>Security

00:00:01.599 --> 00:00:02.479
<v Speaker 0>is hard.

00:00:03.040 --> 00:00:04.320
<v Speaker 0>Authentication

00:00:04.400 --> 00:00:05.280
<v Speaker 0>is hard.

00:00:05.680 --> 00:00:07.760
<v Speaker 0>User management, you guessed it,

00:00:08.080 --> 00:00:10.960
<v Speaker 0>hard. So let's make our Portainer lives a

00:00:10.960 --> 00:00:11.920
<v Speaker 0>little bit simpler

00:00:12.255 --> 00:00:13.855
<v Speaker 0>by using an authentication

00:00:13.855 --> 00:00:16.815
<v Speaker 0>method that we know and we trust. Today,

00:00:16.815 --> 00:00:18.815
<v Speaker 0>we'll take a look at configuring Portainer

00:00:18.815 --> 00:00:20.335
<v Speaker 0>to use GitHub

00:00:20.335 --> 00:00:22.335
<v Speaker 0>and Google. In just a few clicks, you

00:00:22.335 --> 00:00:24.335
<v Speaker 0>could turn on single sign on and never

00:00:24.335 --> 00:00:27.135
<v Speaker 0>have to worry about manually provisioning users again.

00:00:27.150 --> 00:00:29.710
<v Speaker 0>Let's take a look at our Portainer instance.

00:00:29.710 --> 00:00:32.270
<v Speaker 0>So here we are on the Portainer homepage.

00:00:32.430 --> 00:00:34.270
<v Speaker 0>You'll see here that I have added my

00:00:34.270 --> 00:00:37.870
<v Speaker 0>local Docker instance, my Docker desktop on macOS,

00:00:39.645 --> 00:00:41.405
<v Speaker 0>where we can click and see all the

00:00:41.405 --> 00:00:43.165
<v Speaker 0>usual information that we expect.

00:00:44.045 --> 00:00:47.165
<v Speaker 0>Stacks, images, networks, yada yada yada.

00:00:47.885 --> 00:00:51.085
<v Speaker 0>However, for me to access this Portainer instance,

00:00:51.325 --> 00:00:53.245
<v Speaker 0>I used local authentication.

00:00:54.080 --> 00:00:56.160
<v Speaker 0>You can see here in the admin user

00:00:56.160 --> 00:00:58.000
<v Speaker 0>and if I pop back here, I log

00:00:58.000 --> 00:01:00.480
<v Speaker 0>in with my username and password.

00:01:01.920 --> 00:01:04.799
<v Speaker 0>If we go to settings and click authentication,

00:01:05.760 --> 00:01:07.360
<v Speaker 0>we have the ability here

00:01:07.535 --> 00:01:10.655
<v Speaker 0>to select between internal authentication that we're using

00:01:10.655 --> 00:01:11.295
<v Speaker 0>now,

00:01:12.015 --> 00:01:13.055
<v Speaker 0>LDAP,

00:01:13.295 --> 00:01:15.215
<v Speaker 0>active directory or and

00:01:15.695 --> 00:01:16.575
<v Speaker 0>OAuth.

00:01:18.095 --> 00:01:20.655
<v Speaker 0>We're gonna focus today on OAuth because this

00:01:20.655 --> 00:01:22.735
<v Speaker 0>is the authentication method

00:01:22.440 --> 00:01:24.840
<v Speaker 0>that most people will find handy.

00:01:26.040 --> 00:01:27.640
<v Speaker 0>We can click on OAuth here and we'll

00:01:27.640 --> 00:01:29.400
<v Speaker 0>see that we have a couple of toggles

00:01:29.400 --> 00:01:30.600
<v Speaker 0>that we can change.

00:01:31.320 --> 00:01:33.400
<v Speaker 0>One, do we even want to use single

00:01:33.400 --> 00:01:33.880
<v Speaker 0>sign on?

00:01:35.005 --> 00:01:39.565
<v Speaker 0>Spoiler alert, yeah, we do. Managing individual users

00:01:39.965 --> 00:01:40.845
<v Speaker 0>sucks.

00:01:41.485 --> 00:01:43.725
<v Speaker 0>You then have a decision to make. Do

00:01:43.725 --> 00:01:45.405
<v Speaker 0>you want to enable automatic

00:01:45.405 --> 00:01:46.285
<v Speaker 0>user provisioning?

00:01:47.320 --> 00:01:49.640
<v Speaker 0>This just means that if you want anyone

00:01:49.640 --> 00:01:50.920
<v Speaker 0>within your organization,

00:01:51.000 --> 00:01:53.720
<v Speaker 0>anyone with an account on your external

00:01:53.720 --> 00:01:56.600
<v Speaker 0>authentication provider, single sign on provider,

00:01:57.400 --> 00:01:59.320
<v Speaker 0>to access your Portainer, that can be configured.

00:01:59.935 --> 00:02:02.175
<v Speaker 0>And to do so, you configure a default

00:02:02.175 --> 00:02:02.735
<v Speaker 0>team.

00:02:03.295 --> 00:02:05.615
<v Speaker 0>For today, we're not gonna use that.

00:02:06.975 --> 00:02:08.975
<v Speaker 0>The other setting you can enable is automatic

00:02:08.975 --> 00:02:10.255
<v Speaker 0>team membership.

00:02:10.495 --> 00:02:13.375
<v Speaker 0>So giving people access to teams by default

00:02:13.375 --> 00:02:16.800
<v Speaker 0>based on claims within the external authentication provider.

00:02:17.439 --> 00:02:19.120
<v Speaker 0>And we will do a follow-up video where

00:02:19.120 --> 00:02:21.439
<v Speaker 0>we take a look at automatic user provisioning

00:02:21.439 --> 00:02:23.200
<v Speaker 0>and automatic team membership.

00:02:23.439 --> 00:02:25.519
<v Speaker 0>But today, we're gonna keep this short and

00:02:25.519 --> 00:02:26.080
<v Speaker 0>sweet.

00:02:26.400 --> 00:02:28.925
<v Speaker 0>We're gonna focus on setting up Google and

00:02:28.925 --> 00:02:30.525
<v Speaker 0>GitHub authentication

00:02:30.525 --> 00:02:32.285
<v Speaker 0>for your Portainer instance.

00:02:33.405 --> 00:02:34.925
<v Speaker 0>Let's start with GitHub.

00:02:35.165 --> 00:02:37.965
<v Speaker 0>Like most OAuth configurations, you need a client

00:02:37.965 --> 00:02:41.005
<v Speaker 0>ID and a client secret. To get these,

00:02:41.565 --> 00:02:43.805
<v Speaker 0>you can go to your GitHub organization

00:02:44.870 --> 00:02:46.870
<v Speaker 0>where you can click settings,

00:02:47.190 --> 00:02:49.510
<v Speaker 0>scroll all the way down to developer and

00:02:49.510 --> 00:02:51.190
<v Speaker 0>select OAuth apps.

00:02:51.590 --> 00:02:53.430
<v Speaker 0>Now you'll see I already have a few,

00:02:53.430 --> 00:02:54.790
<v Speaker 0>but we're going to create a new one.

00:02:56.165 --> 00:02:58.165
<v Speaker 0>I'm going to call this Portainer

00:02:58.165 --> 00:02:59.685
<v Speaker 0>in production.

00:03:01.525 --> 00:03:03.685
<v Speaker 0>And it doesn't matter what your homepage is

00:03:03.685 --> 00:03:05.685
<v Speaker 0>set to. So I'm just going to say

00:03:05.685 --> 00:03:06.725
<v Speaker 0>google.com.

00:03:08.490 --> 00:03:11.290
<v Speaker 0>For the authorization callback, this will need to

00:03:11.290 --> 00:03:13.930
<v Speaker 0>be a URL that resolves to your Portainer

00:03:13.930 --> 00:03:14.730
<v Speaker 0>instance.

00:03:15.210 --> 00:03:17.610
<v Speaker 0>Because I'm running this locally, I'm going to

00:03:17.610 --> 00:03:20.090
<v Speaker 0>use local host 9 4 4 3.

00:03:21.705 --> 00:03:23.785
<v Speaker 0>From here, we can click register.

00:03:25.785 --> 00:03:27.625
<v Speaker 0>Oh, and make sure you get the protocol

00:03:27.625 --> 00:03:28.345
<v Speaker 0>right.

00:03:30.265 --> 00:03:32.745
<v Speaker 0>This gives us a client ID like so.

00:03:33.690 --> 00:03:36.090
<v Speaker 0>Let's pop back over to Portainer and drop

00:03:36.090 --> 00:03:38.810
<v Speaker 0>it in. Next, we need a client secret.

00:03:40.090 --> 00:03:43.050
<v Speaker 0>So we'll click generate new client secret,

00:03:43.050 --> 00:03:45.370
<v Speaker 0>but you'll have to provide some authentication to

00:03:45.370 --> 00:03:45.769
<v Speaker 0>GitHub.

00:03:47.875 --> 00:03:49.875
<v Speaker 0>This secret will never be shown to you

00:03:49.875 --> 00:03:51.635
<v Speaker 0>again, so make sure you store it at

00:03:51.635 --> 00:03:53.235
<v Speaker 0>a nice safe place.

00:03:55.475 --> 00:03:57.075
<v Speaker 0>We drop this in like so

00:03:57.795 --> 00:03:59.075
<v Speaker 0>and hit save.

00:03:59.555 --> 00:04:02.610
<v Speaker 0>And that's it. You've now configured your Portainer

00:04:02.610 --> 00:04:04.050
<v Speaker 0>instance to authenticate

00:04:04.050 --> 00:04:05.890
<v Speaker 0>with a GitHub application.

00:04:05.890 --> 00:04:07.650
<v Speaker 0>Now before we log out and test our

00:04:07.650 --> 00:04:08.850
<v Speaker 0>GitHub authentication,

00:04:09.090 --> 00:04:10.690
<v Speaker 0>we need to do one more thing.

00:04:11.250 --> 00:04:14.690
<v Speaker 0>Because automatic user provisioning is disabled and automatic

00:04:14.690 --> 00:04:16.130
<v Speaker 0>team membership is disabled,

00:04:16.634 --> 00:04:19.035
<v Speaker 0>we have to go to users and add

00:04:19.035 --> 00:04:19.995
<v Speaker 0>Rawkode.

00:04:20.074 --> 00:04:22.074
<v Speaker 0>This is my GitHub username.

00:04:22.555 --> 00:04:24.555
<v Speaker 0>From here, I can say I

00:04:25.514 --> 00:04:26.875
<v Speaker 0>am an administrator.

00:04:28.875 --> 00:04:31.275
<v Speaker 0>Let's pop that in here to authentication.

00:04:32.050 --> 00:04:34.290
<v Speaker 0>Click save just to confirm that everything looks

00:04:34.290 --> 00:04:34.930
<v Speaker 0>alright

00:04:35.730 --> 00:04:36.610
<v Speaker 0>before

00:04:36.610 --> 00:04:37.410
<v Speaker 0>finally

00:04:37.890 --> 00:04:38.850
<v Speaker 0>logging out.

00:04:43.650 --> 00:04:45.810
<v Speaker 0>Now you'll see right away that it'll log

00:04:45.810 --> 00:04:47.794
<v Speaker 0>me straight back in. And if you caught

00:04:47.794 --> 00:04:49.315
<v Speaker 0>the little flickers, you would have seen the

00:04:49.315 --> 00:04:50.435
<v Speaker 0>Portainer logo

00:04:50.595 --> 00:04:51.955
<v Speaker 0>that detected

00:04:51.955 --> 00:04:53.795
<v Speaker 0>that I'm not unauthenticated.

00:04:53.875 --> 00:04:55.955
<v Speaker 0>Now that we've logged out of Portainer,

00:04:56.195 --> 00:04:58.275
<v Speaker 0>it's redirected us to a GitHub page.

00:04:58.995 --> 00:05:00.915
<v Speaker 0>What's happened is we browse to local host

00:05:00.915 --> 00:05:01.794
<v Speaker 0>9443.

00:05:02.110 --> 00:05:04.590
<v Speaker 0>Portainer has detected that we're no longer logged

00:05:04.590 --> 00:05:06.750
<v Speaker 0>in. We directed us to get up to

00:05:06.750 --> 00:05:08.830
<v Speaker 0>see if it can get authentication details,

00:05:09.150 --> 00:05:12.350
<v Speaker 0>where I've logged out and authentication has failed.

00:05:12.430 --> 00:05:12.910
<v Speaker 0>So

00:05:13.470 --> 00:05:15.070
<v Speaker 0>we can say, hey. Let's log in to

00:05:15.070 --> 00:05:16.905
<v Speaker 0>get up. And you'll see that our continue

00:05:16.905 --> 00:05:19.545
<v Speaker 0>with the Portainer in production application is here.

00:05:20.745 --> 00:05:22.105
<v Speaker 0>We click sign in,

00:05:22.425 --> 00:05:24.105
<v Speaker 0>verify our TOTP,

00:05:24.425 --> 00:05:26.345
<v Speaker 0>and now we're being asked to authenticate the

00:05:26.345 --> 00:05:28.264
<v Speaker 0>Portainer in production app against GitHub.

00:05:29.030 --> 00:05:30.550
<v Speaker 0>We can click authorize,

00:05:30.870 --> 00:05:32.150
<v Speaker 0>we'll be redirected,

00:05:32.470 --> 00:05:34.230
<v Speaker 0>and logged in to Portainer.

00:05:35.670 --> 00:05:37.670
<v Speaker 0>And that is GitHub authentication.

00:05:38.150 --> 00:05:40.070
<v Speaker 0>Now word of warning, this is easy to

00:05:40.070 --> 00:05:41.910
<v Speaker 0>mess up. And in fact, I've done it

00:05:41.910 --> 00:05:42.470
<v Speaker 0>a few times.

00:05:43.715 --> 00:05:46.435
<v Speaker 0>You can turn off the hide authentication

00:05:46.675 --> 00:05:48.675
<v Speaker 0>hide internal authentication

00:05:48.675 --> 00:05:49.555
<v Speaker 0>prompt.

00:05:49.955 --> 00:05:51.395
<v Speaker 0>This just means that if you do mess

00:05:51.395 --> 00:05:53.794
<v Speaker 0>up any settings, you can come back here

00:05:54.354 --> 00:05:55.155
<v Speaker 0>and log out.

00:05:57.970 --> 00:05:59.570
<v Speaker 0>We'll sign out of GitHub.

00:06:00.690 --> 00:06:02.210
<v Speaker 0>Go back to Portainer.

00:06:03.730 --> 00:06:05.570
<v Speaker 0>And now we have an option. Log in

00:06:05.570 --> 00:06:08.610
<v Speaker 0>with GitHub or use internal authentication.

00:06:09.090 --> 00:06:11.165
<v Speaker 0>So if you do mess up, don't worry.

00:06:11.165 --> 00:06:13.725
<v Speaker 0>Just remember to check that box. And that

00:06:14.045 --> 00:06:16.365
<v Speaker 0>is external authentication with GitHub.

00:06:16.925 --> 00:06:19.565
<v Speaker 0>So next, let's take a look at Google.

00:06:19.565 --> 00:06:21.725
<v Speaker 0>So we go back to the settings authentication

00:06:21.725 --> 00:06:24.470
<v Speaker 0>screen where we can select Google. Now it's

00:06:24.470 --> 00:06:26.630
<v Speaker 0>important to note that you can only have

00:06:26.630 --> 00:06:28.550
<v Speaker 0>one of these enabled at any given time.

00:06:28.550 --> 00:06:31.270
<v Speaker 0>When we select Google, we lose GitHub.

00:06:32.070 --> 00:06:34.230
<v Speaker 0>We're going to delete the client ID.

00:06:34.710 --> 00:06:36.950
<v Speaker 0>The client secret is already hidden, and we're

00:06:36.950 --> 00:06:38.630
<v Speaker 0>gonna head over to Google Cloud.

00:06:40.875 --> 00:06:42.634
<v Speaker 0>From Google Cloud, you're gonna want to go

00:06:42.634 --> 00:06:45.195
<v Speaker 0>to API and services and credentials.

00:06:45.275 --> 00:06:46.715
<v Speaker 0>The easy way to get there is in

00:06:46.715 --> 00:06:48.634
<v Speaker 0>the search bar to type OAuth, and that's

00:06:48.634 --> 00:06:49.835
<v Speaker 0>the second hit.

00:06:50.715 --> 00:06:53.115
<v Speaker 0>From here, we say create credentials where we

00:06:53.115 --> 00:06:55.650
<v Speaker 0>want to create an OAuth client ID.

00:06:57.490 --> 00:06:58.850
<v Speaker 0>Now we can see that we are web

00:06:58.850 --> 00:06:59.650
<v Speaker 0>application,

00:06:59.730 --> 00:07:01.490
<v Speaker 0>and we'll call this Portainer

00:07:01.490 --> 00:07:02.850
<v Speaker 0>in production.

00:07:03.410 --> 00:07:04.930
<v Speaker 0>And I'm just gonna add Google to that

00:07:04.930 --> 00:07:07.970
<v Speaker 0>to avoid any confusion or ambiguity with the

00:07:07.970 --> 00:07:08.930
<v Speaker 0>GitHub client.

00:07:11.175 --> 00:07:14.135
<v Speaker 0>From here, we can add the authorized JavaScript

00:07:14.135 --> 00:07:15.015
<v Speaker 0>origin.

00:07:15.895 --> 00:07:18.135
<v Speaker 0>We're gonna use local host nine four four

00:07:18.135 --> 00:07:20.215
<v Speaker 0>three. And in fact, we're going to copy

00:07:20.215 --> 00:07:22.935
<v Speaker 0>this for the authorized redirect URLs

00:07:22.935 --> 00:07:23.255
<v Speaker 0>too.

00:07:24.480 --> 00:07:27.120
<v Speaker 0>We click create and much like the GitHub

00:07:27.120 --> 00:07:29.120
<v Speaker 0>one, we get our client ID.

00:07:29.680 --> 00:07:32.000
<v Speaker 0>We can hit copy, pop back,

00:07:32.480 --> 00:07:33.360
<v Speaker 0>and paste.

00:07:35.760 --> 00:07:37.920
<v Speaker 0>Next, we're going to copy the secret

00:07:38.080 --> 00:07:39.920
<v Speaker 0>where we head back to Portainer

00:07:40.855 --> 00:07:41.815
<v Speaker 0>and paste.

00:07:43.175 --> 00:07:45.575
<v Speaker 0>From here, we click save. Much like the

00:07:45.575 --> 00:07:48.295
<v Speaker 0>GitHub, we have to pre add our user.

00:07:49.015 --> 00:07:50.215
<v Speaker 0>Go back to users.

00:07:51.655 --> 00:07:54.295
<v Speaker 0>Now we're going to add david at Rawkode

00:07:54.295 --> 00:07:58.110
<v Speaker 0>dot academy. Why? That is my Google username.

00:07:58.590 --> 00:08:00.110
<v Speaker 0>And I'm going to make me

00:08:02.590 --> 00:08:03.870
<v Speaker 0>an administrator.

00:08:04.990 --> 00:08:08.270
<v Speaker 0>Now we can go and log out. So

00:08:08.270 --> 00:08:10.030
<v Speaker 0>let's click log in with Google.

00:08:11.475 --> 00:08:13.955
<v Speaker 0>We get presented with the account switcher,

00:08:14.035 --> 00:08:15.235
<v Speaker 0>and you can see that it's going to

00:08:15.235 --> 00:08:17.715
<v Speaker 0>continue to the Rawkode Academy because that's the

00:08:17.715 --> 00:08:19.875
<v Speaker 0>Google Cloud project name that we should.

00:08:20.595 --> 00:08:21.715
<v Speaker 0>We select the user,

00:08:23.440 --> 00:08:24.960
<v Speaker 0>and we're logged in.

00:08:25.280 --> 00:08:27.280
<v Speaker 0>This is just a short video today showing

00:08:27.280 --> 00:08:29.919
<v Speaker 0>you how to improve your security posture

00:08:30.319 --> 00:08:32.799
<v Speaker 0>by removing some headaches from managing your Portainer

00:08:32.799 --> 00:08:33.600
<v Speaker 0>instance.

00:08:33.760 --> 00:08:36.399
<v Speaker 0>Nobody likes managing individual user account.

00:08:37.225 --> 00:08:39.945
<v Speaker 0>You're probably already using GitHub,

00:08:39.945 --> 00:08:43.705
<v Speaker 0>Google, or some other authentication provider. So just

00:08:43.705 --> 00:08:45.625
<v Speaker 0>let that do the heavy lifting and manage

00:08:45.625 --> 00:08:48.345
<v Speaker 0>your Portainer users too. In the next video,

00:08:48.345 --> 00:08:51.305
<v Speaker 0>we'll take a look at automatic team membership

00:08:50.790 --> 00:08:53.269
<v Speaker 0>and automatic account creation

00:08:53.509 --> 00:08:55.829
<v Speaker 0>using those two little checkboxes we avoided in

00:08:55.829 --> 00:08:56.790
<v Speaker 0>the first video.

00:08:57.269 --> 00:08:58.870
<v Speaker 0>So come back and see how to go

00:08:58.870 --> 00:09:02.070
<v Speaker 0>a little deeper with Portainer's external authentication.

00:09:02.070 --> 00:09:03.350
<v Speaker 0>We'll see you in a couple of days.

00:09:03.350 --> 00:09:04.949
<v Speaker 0>Until then, have a great day.
