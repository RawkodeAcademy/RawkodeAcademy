WEBVTT

NOTE
Transcription provided by Deepgram
Request Id: 01256342-5ce7-4564-8444-001280f82f01
Created: 2025-04-29T22:56:34.346Z
Duration: 5259.477
Channels: 1

00:03:37.855 --> 00:03:38.335
<v Speaker 0>Hello?

00:03:44.990 --> 00:03:45.870
<v Speaker 0>Okay.

00:03:48.990 --> 00:03:50.270
<v Speaker 0>I

00:03:50.270 --> 00:03:52.110
<v Speaker 0>think we are good.

00:03:54.575 --> 00:03:55.535
<v Speaker 0>Awesome.

00:03:57.615 --> 00:03:58.575
<v Speaker 0>Hey, John.

00:04:00.015 --> 00:04:01.375
<v Speaker 0>Alright. So

00:04:01.375 --> 00:04:02.335
<v Speaker 0>today,

00:04:05.295 --> 00:04:08.335
<v Speaker 0>I'm gonna take a look at

00:04:08.840 --> 00:04:10.680
<v Speaker 0>monitoring Kubernetes

00:04:11.000 --> 00:04:12.840
<v Speaker 0>with InfluxDB.

00:04:16.760 --> 00:04:19.320
<v Speaker 0>So a little bit about me, I guess.

00:04:19.480 --> 00:04:20.440
<v Speaker 0>I've been

00:04:21.000 --> 00:04:23.960
<v Speaker 0>actively using containers in Kubernetes for many years.

00:04:26.005 --> 00:04:28.325
<v Speaker 0>I'm a Kubernetes organization member.

00:04:29.925 --> 00:04:32.085
<v Speaker 0>I've been working with the release team.

00:04:32.645 --> 00:04:35.045
<v Speaker 0>I think I know Kubernetes pretty well.

00:04:36.165 --> 00:04:37.525
<v Speaker 0>I know InfluxDB

00:04:37.525 --> 00:04:38.165
<v Speaker 0>pretty well.

00:04:39.580 --> 00:04:43.020
<v Speaker 0>So today's plan is to try

00:04:43.660 --> 00:04:45.100
<v Speaker 0>and put those two

00:04:46.060 --> 00:04:47.900
<v Speaker 0>two skills of mine together.

00:04:48.220 --> 00:04:50.460
<v Speaker 0>Now I have been trying to focus

00:04:50.460 --> 00:04:51.580
<v Speaker 0>my efforts

00:04:51.979 --> 00:04:54.455
<v Speaker 0>as I work in FluxDB on

00:04:55.735 --> 00:04:57.895
<v Speaker 0>it's making our Kubernetes story a little bit

00:04:57.895 --> 00:04:58.535
<v Speaker 0>better.

00:05:01.495 --> 00:05:04.535
<v Speaker 0>And a major focus of that at least

00:05:04.535 --> 00:05:05.735
<v Speaker 0>over

00:05:08.120 --> 00:05:09.480
<v Speaker 0>the last what?

00:05:09.800 --> 00:05:10.840
<v Speaker 0>Three months

00:05:12.040 --> 00:05:14.920
<v Speaker 0>has been maintaining the helm charts repository.

00:05:16.760 --> 00:05:18.280
<v Speaker 0>So we're gonna see how far we can

00:05:18.280 --> 00:05:20.375
<v Speaker 0>get using these charts.

00:05:22.854 --> 00:05:23.575
<v Speaker 0>Then

00:05:23.655 --> 00:05:26.455
<v Speaker 0>we are gonna take a look at another

00:05:26.455 --> 00:05:27.495
<v Speaker 0>InfluxDBata

00:05:27.495 --> 00:05:28.375
<v Speaker 0>initiative.

00:05:31.255 --> 00:05:33.095
<v Speaker 0>Which is our community templates.

00:05:33.970 --> 00:05:37.890
<v Speaker 0>I haven't used this Kubernetes template before.

00:05:44.450 --> 00:05:47.010
<v Speaker 0>But someone has contributed it.

00:05:48.370 --> 00:05:50.225
<v Speaker 0>So we're gonna use the helm charts.

00:05:50.544 --> 00:05:53.105
<v Speaker 0>We're gonna get all of the telegraphs running.

00:05:53.665 --> 00:05:55.665
<v Speaker 0>We're gonna deploy these dashboards

00:05:55.905 --> 00:05:57.425
<v Speaker 0>and we're gonna take a bit of an

00:05:57.425 --> 00:05:58.865
<v Speaker 0>objective look at them.

00:06:00.145 --> 00:06:02.385
<v Speaker 0>I kind of leverage my experience of both

00:06:02.385 --> 00:06:03.824
<v Speaker 0>products, try and identify

00:06:04.319 --> 00:06:06.639
<v Speaker 0>what's missing from this template and then we'll

00:06:06.639 --> 00:06:08.240
<v Speaker 0>try and contribute that back.

00:06:09.039 --> 00:06:12.320
<v Speaker 0>I don't expect it to be complete.

00:06:12.800 --> 00:06:15.199
<v Speaker 0>The community templates project is pretty new.

00:06:17.195 --> 00:06:19.035
<v Speaker 0>But you know, by doing this, we can

00:06:19.035 --> 00:06:21.195
<v Speaker 0>identify what needs to be improved and just,

00:06:21.195 --> 00:06:22.395
<v Speaker 0>you know, do it.

00:06:23.515 --> 00:06:25.115
<v Speaker 0>There are some telegraph plugins that we're gonna

00:06:25.115 --> 00:06:26.795
<v Speaker 0>take advantage of. We'll cover all of that

00:06:26.795 --> 00:06:27.595
<v Speaker 0>as we go.

00:06:29.250 --> 00:06:30.290
<v Speaker 0>Hopefully

00:06:30.690 --> 00:06:31.890
<v Speaker 0>that sounds good.

00:06:32.850 --> 00:06:34.210
<v Speaker 0>So what I've done,

00:06:34.610 --> 00:06:35.650
<v Speaker 0>what I did,

00:06:36.290 --> 00:06:37.890
<v Speaker 0>I'll learn how to speak English.

00:06:38.610 --> 00:06:41.490
<v Speaker 0>I'm running mini cube and there's pretty much

00:06:41.490 --> 00:06:43.655
<v Speaker 0>nothing here. You can see I've ran, get

00:06:43.655 --> 00:06:45.255
<v Speaker 0>pods, all namespaces.

00:06:45.255 --> 00:06:46.535
<v Speaker 0>This is a pretty,

00:06:47.655 --> 00:06:49.095
<v Speaker 0>pretty new setup.

00:06:50.215 --> 00:06:52.294
<v Speaker 0>So we're gonna follow the documentation for the

00:06:52.294 --> 00:06:53.335
<v Speaker 0>helm charts

00:06:54.215 --> 00:06:56.134
<v Speaker 0>and get the first few components

00:06:56.134 --> 00:06:56.694
<v Speaker 0>working.

00:06:57.980 --> 00:07:00.380
<v Speaker 0>So step one, we're going to add the

00:07:00.380 --> 00:07:03.340
<v Speaker 0>influx data helm repository.

00:07:05.980 --> 00:07:06.620
<v Speaker 0>Done.

00:07:07.020 --> 00:07:09.580
<v Speaker 0>Nice. Let's hope it's always easy as that.

00:07:10.780 --> 00:07:13.100
<v Speaker 0>We don't actually need to search do we?

00:07:13.235 --> 00:07:15.155
<v Speaker 0>You know, I know what charts that are,

00:07:15.155 --> 00:07:15.795
<v Speaker 0>but

00:07:16.675 --> 00:07:18.195
<v Speaker 0>I've never I don't think I've ever run

00:07:18.195 --> 00:07:19.715
<v Speaker 0>helm search before so.

00:07:20.835 --> 00:07:21.635
<v Speaker 0>Cool.

00:07:22.115 --> 00:07:24.435
<v Speaker 0>So the first thing I wanna get

00:07:24.755 --> 00:07:27.235
<v Speaker 0>done here is

00:07:28.510 --> 00:07:30.030
<v Speaker 0>deploy InfluxDB

00:07:30.030 --> 00:07:30.910
<v Speaker 0>two.

00:07:32.990 --> 00:07:34.510
<v Speaker 0>Yes. Let's do that.

00:07:35.790 --> 00:07:36.510
<v Speaker 0>So

00:07:37.070 --> 00:07:39.390
<v Speaker 0>let's fire open code.

00:07:43.835 --> 00:07:45.675
<v Speaker 0>What we'll do is

00:07:45.835 --> 00:07:48.235
<v Speaker 0>we'll just I like make fails, make fails

00:07:48.235 --> 00:07:49.355
<v Speaker 0>make me happy.

00:07:50.795 --> 00:07:52.395
<v Speaker 0>I guess I can make this font a

00:07:52.395 --> 00:07:52.875
<v Speaker 0>bit bigger.

00:07:56.569 --> 00:07:58.090
<v Speaker 0>Go with 24.

00:07:58.330 --> 00:07:59.850
<v Speaker 0>Sure won't be too wild.

00:08:01.289 --> 00:08:03.289
<v Speaker 0>And we want to deploy

00:08:03.449 --> 00:08:04.250
<v Speaker 0>InfluxDB

00:08:04.250 --> 00:08:05.050
<v Speaker 0>two

00:08:06.090 --> 00:08:08.169
<v Speaker 0>and to do this, we're gonna do a

00:08:08.169 --> 00:08:10.490
<v Speaker 0>helm upgrade

00:08:09.755 --> 00:08:10.795
<v Speaker 0>install.

00:08:11.514 --> 00:08:14.475
<v Speaker 0>Gonna need the name, let's call that InfluxDB

00:08:15.035 --> 00:08:18.875
<v Speaker 0>and the chart which will be influx data

00:08:18.875 --> 00:08:20.475
<v Speaker 0>slash influx DB.

00:08:23.910 --> 00:08:26.470
<v Speaker 0>Let's take a look at the values file

00:08:29.750 --> 00:08:31.830
<v Speaker 0>and see if there's anything that we need

00:08:31.830 --> 00:08:33.190
<v Speaker 0>to overwrite.

00:08:33.510 --> 00:08:34.230
<v Speaker 0>So

00:08:35.910 --> 00:08:38.150
<v Speaker 0>I've not modified this chart since March.

00:08:38.405 --> 00:08:41.045
<v Speaker 0>So it might make sense to upgrade the

00:08:41.205 --> 00:08:42.085
<v Speaker 0>tag.

00:08:42.405 --> 00:08:44.805
<v Speaker 0>I believe it might be running the alpha.

00:08:44.805 --> 00:08:46.645
<v Speaker 0>We don't want to run the alpha.

00:08:47.285 --> 00:08:47.925
<v Speaker 0>And

00:08:50.005 --> 00:08:53.605
<v Speaker 0>Oh, it's gonna go with chart app version.

00:08:56.140 --> 00:08:58.060
<v Speaker 0>Oh, beta. Nice.

00:08:58.300 --> 00:08:59.420
<v Speaker 0>Did I do that?

00:09:05.820 --> 00:09:06.779
<v Speaker 0>I did.

00:09:07.565 --> 00:09:11.245
<v Speaker 0>Go me. Alright. So back to the values.

00:09:15.405 --> 00:09:16.685
<v Speaker 0>So we don't need to touch any of

00:09:16.685 --> 00:09:19.245
<v Speaker 0>this. Not gonna put any resource requirements on

00:09:19.245 --> 00:09:19.485
<v Speaker 0>it.

00:09:21.180 --> 00:09:24.540
<v Speaker 0>I don't mind the user being admin organization.

00:09:24.540 --> 00:09:26.780
<v Speaker 0>Yep. Happy with all of that.

00:09:27.900 --> 00:09:30.300
<v Speaker 0>We'll go with 50 gigs of persistence. Right?

00:09:30.300 --> 00:09:32.860
<v Speaker 0>So I'm not gonna change anything in that.

00:09:32.860 --> 00:09:34.140
<v Speaker 0>I'm just gonna deploy it.

00:09:36.545 --> 00:09:37.265
<v Speaker 0>So

00:09:37.425 --> 00:09:38.704
<v Speaker 0>let's run,

00:09:38.704 --> 00:09:41.584
<v Speaker 0>make deploy and FlexDB.

00:09:52.225 --> 00:09:52.880
<v Speaker 0>And We wait.

00:10:01.955 --> 00:10:04.035
<v Speaker 0>I'm assuming I sound okay. I'm hoping someone

00:10:04.035 --> 00:10:06.675
<v Speaker 0>would have said you don't sound okay by

00:10:06.675 --> 00:10:07.235
<v Speaker 0>now.

00:10:08.835 --> 00:10:10.755
<v Speaker 0>I didn't check the audio but the video

00:10:10.755 --> 00:10:11.395
<v Speaker 0>was okay.

00:10:21.339 --> 00:10:24.540
<v Speaker 0>I don't recall why it would be holding,

00:10:27.225 --> 00:10:28.585
<v Speaker 0>But we can be patient.

00:10:29.705 --> 00:10:31.945
<v Speaker 0>What I will do is just gonna split

00:10:31.945 --> 00:10:34.505
<v Speaker 0>this and run get NS.

00:10:36.745 --> 00:10:37.545
<v Speaker 0>Thank you, John.

00:10:41.040 --> 00:10:42.000
<v Speaker 0>And

00:10:43.600 --> 00:10:46.079
<v Speaker 0>yeah. So I'm okay with the error just

00:10:46.079 --> 00:10:48.079
<v Speaker 0>now that job will retry.

00:10:48.880 --> 00:10:49.839
<v Speaker 0>There we go.

00:10:51.839 --> 00:10:53.525
<v Speaker 0>So I was just waiting on the setup

00:10:53.525 --> 00:10:55.205
<v Speaker 0>job. So InfluxDB,

00:10:55.365 --> 00:10:58.565
<v Speaker 0>you you cannot disable the authentication at all.

00:10:59.285 --> 00:11:01.445
<v Speaker 0>So the way that we handle that in

00:11:01.445 --> 00:11:02.565
<v Speaker 0>the helm chart

00:11:03.765 --> 00:11:05.925
<v Speaker 0>is we use a setup job

00:11:09.420 --> 00:11:12.380
<v Speaker 0>Which just runs the influx setup command

00:11:13.660 --> 00:11:16.060
<v Speaker 0>and it'll retry that until it works. So

00:11:16.060 --> 00:11:17.820
<v Speaker 0>even though it fails twice and that's just

00:11:17.820 --> 00:11:19.420
<v Speaker 0>because InfluxDB isn't

00:11:19.500 --> 00:11:21.580
<v Speaker 0>really running yet. You know, the container started

00:11:21.580 --> 00:11:22.940
<v Speaker 0>but there's a few things that have to

00:11:22.940 --> 00:11:23.180
<v Speaker 0>happen.

00:11:24.435 --> 00:11:26.035
<v Speaker 0>And then the cell works.

00:11:26.275 --> 00:11:26.995
<v Speaker 0>Now,

00:11:27.555 --> 00:11:29.635
<v Speaker 0>if I want to browse to InfluxDB,

00:11:31.075 --> 00:11:33.635
<v Speaker 0>what I will do is just, we're gonna

00:11:33.635 --> 00:11:34.915
<v Speaker 0>need that a lot. So I'm just gonna

00:11:34.915 --> 00:11:37.075
<v Speaker 0>keep that open here. We'll do a port

00:11:37.075 --> 00:11:37.555
<v Speaker 0>forward.

00:11:42.670 --> 00:11:50.350
<v Speaker 0>And 0999999

00:11:51.150 --> 00:11:53.630
<v Speaker 0>And we'll just leave that quite happy there.

00:11:55.505 --> 00:11:57.024
<v Speaker 0>Okay. So,

00:11:58.464 --> 00:11:59.665
<v Speaker 0>if we browse,

00:12:00.065 --> 00:12:01.825
<v Speaker 0>our username was

00:12:01.985 --> 00:12:03.024
<v Speaker 0>admin,

00:12:03.425 --> 00:12:04.464
<v Speaker 0>but we need the password.

00:12:06.600 --> 00:12:08.920
<v Speaker 0>So let's deal with that. In order to

00:12:08.920 --> 00:12:10.440
<v Speaker 0>get the password, we have to pull out

00:12:10.440 --> 00:12:12.600
<v Speaker 0>the secret. So we're going to do get

00:12:12.600 --> 00:12:13.560
<v Speaker 0>secrets.

00:12:15.800 --> 00:12:18.600
<v Speaker 0>And we have influx DB off.

00:12:19.720 --> 00:12:20.839
<v Speaker 0>No YAML.

00:12:23.835 --> 00:12:25.435
<v Speaker 0>We want

00:12:26.395 --> 00:12:27.195
<v Speaker 0>data

00:12:27.435 --> 00:12:29.435
<v Speaker 0>admin password.

00:12:29.515 --> 00:12:30.955
<v Speaker 0>Let's see if I can override the data

00:12:30.955 --> 00:12:31.675
<v Speaker 0>admin

00:12:33.275 --> 00:12:34.075
<v Speaker 0>password.

00:12:39.889 --> 00:12:41.170
<v Speaker 0>I wish we could have to do the

00:12:41.170 --> 00:12:43.890
<v Speaker 0>j q stuff. Is it just quotes maybe?

00:12:45.490 --> 00:12:46.610
<v Speaker 0>I'll

00:12:46.610 --> 00:12:47.810
<v Speaker 0>try one more time.

00:12:49.410 --> 00:12:51.170
<v Speaker 0>Nah. Okay. So we're just gonna be sixty

00:12:51.170 --> 00:12:52.450
<v Speaker 0>four. I copied it. So

00:12:53.345 --> 00:12:56.225
<v Speaker 0>drop that. Oh, come on. I thought I

00:12:56.225 --> 00:12:57.024
<v Speaker 0>copied it.

00:12:58.384 --> 00:12:59.185
<v Speaker 0>Password

00:12:59.185 --> 00:13:00.065
<v Speaker 0>copy.

00:13:00.065 --> 00:13:01.505
<v Speaker 0>Base sixty four.

00:13:02.384 --> 00:13:03.185
<v Speaker 0>Paste.

00:13:03.904 --> 00:13:05.504
<v Speaker 0>And here is my password.

00:13:11.389 --> 00:13:14.110
<v Speaker 0>Awesome. So we have nothing I would imagine.

00:13:14.110 --> 00:13:15.949
<v Speaker 0>We do have a default bucket that is

00:13:15.949 --> 00:13:18.990
<v Speaker 0>created for us. We've got no dashboards, no

00:13:18.990 --> 00:13:21.069
<v Speaker 0>task, there's nothing like that. So

00:13:22.225 --> 00:13:23.985
<v Speaker 0>the next step is

00:13:24.625 --> 00:13:26.785
<v Speaker 0>we could start loading telegraph in.

00:13:27.345 --> 00:13:27.985
<v Speaker 0>So

00:13:28.785 --> 00:13:30.225
<v Speaker 0>taking a look at the data

00:13:31.105 --> 00:13:33.024
<v Speaker 0>but I think what we'll do is we'll

00:13:33.024 --> 00:13:35.920
<v Speaker 0>just pull these dashboards and right away. I

00:13:35.920 --> 00:13:37.600
<v Speaker 0>don't think there's any point in those hanging

00:13:37.600 --> 00:13:38.240
<v Speaker 0>around.

00:13:39.200 --> 00:13:41.360
<v Speaker 0>And even if these don't show us anything

00:13:41.360 --> 00:13:42.720
<v Speaker 0>just yet, at least we can get a

00:13:42.720 --> 00:13:44.560
<v Speaker 0>rough idea of what we're getting out of

00:13:44.560 --> 00:13:46.400
<v Speaker 0>the box with this community template.

00:13:47.600 --> 00:13:49.120
<v Speaker 0>So let's do

00:13:49.495 --> 00:13:51.495
<v Speaker 0>raw copy of this.

00:13:55.254 --> 00:13:55.894
<v Speaker 0>And

00:13:56.055 --> 00:13:57.334
<v Speaker 0>if we use

00:13:57.654 --> 00:13:59.894
<v Speaker 0>I may just have to blow in old

00:13:59.894 --> 00:14:00.855
<v Speaker 0>config, but

00:14:01.550 --> 00:14:05.310
<v Speaker 0>have we used Influx package dash dash fail

00:14:06.029 --> 00:14:07.709
<v Speaker 0>and point it to this.

00:14:09.550 --> 00:14:11.629
<v Speaker 0>And we just need to specify

00:14:11.629 --> 00:14:12.509
<v Speaker 0>the

00:14:14.029 --> 00:14:16.990
<v Speaker 0>token which are good point. I haven't

00:14:17.395 --> 00:14:19.075
<v Speaker 0>Let's grab the token

00:14:21.955 --> 00:14:23.315
<v Speaker 0>base to code that.

00:14:24.275 --> 00:14:25.235
<v Speaker 0>There we go.

00:14:27.235 --> 00:14:30.035
<v Speaker 0>The token just gives me API access. So

00:14:30.770 --> 00:14:31.490
<v Speaker 0>we

00:14:31.650 --> 00:14:33.490
<v Speaker 0>wanna specify the token

00:14:33.810 --> 00:14:34.450
<v Speaker 0>here

00:14:36.370 --> 00:14:39.010
<v Speaker 0>and we wanna specify the organization here,

00:14:39.170 --> 00:14:40.610
<v Speaker 0>which would influx data.

00:14:43.815 --> 00:14:46.295
<v Speaker 0>I guess that doesn't support remote URLs,

00:14:46.295 --> 00:14:48.535
<v Speaker 0>which means I'm now gonna curl that.

00:14:48.855 --> 00:14:49.654
<v Speaker 0>And

00:14:51.495 --> 00:14:53.495
<v Speaker 0>I don't have that in the clipboard anymore.

00:14:56.935 --> 00:14:59.255
<v Speaker 0>I wonder if I could just

00:14:58.720 --> 00:14:59.280
<v Speaker 0>computer

00:15:01.520 --> 00:15:03.520
<v Speaker 0>fail me today as always.

00:15:04.240 --> 00:15:06.320
<v Speaker 0>Let's just copy it. And then I'll lose

00:15:06.320 --> 00:15:08.320
<v Speaker 0>my token and have to do that again,

00:15:08.400 --> 00:15:08.880
<v Speaker 0>but

00:15:10.805 --> 00:15:11.605
<v Speaker 0>Alright.

00:15:13.285 --> 00:15:16.165
<v Speaker 0>So we probably could just pay the influx

00:15:16.165 --> 00:15:17.524
<v Speaker 0>package command,

00:15:19.045 --> 00:15:21.125
<v Speaker 0>but I'm sure I'll get something wrong there.

00:15:21.125 --> 00:15:22.404
<v Speaker 0>So let's just

00:15:23.980 --> 00:15:26.540
<v Speaker 0>let's just download the file and then

00:15:27.019 --> 00:15:28.779
<v Speaker 0>copy that token again,

00:15:30.300 --> 00:15:31.980
<v Speaker 0>which is nails away.

00:15:35.100 --> 00:15:36.060
<v Speaker 0>That didn't work.

00:15:38.634 --> 00:15:40.634
<v Speaker 0>I will look up that JQ syntax later

00:15:40.634 --> 00:15:42.075
<v Speaker 0>and get annoyed at myself,

00:15:42.235 --> 00:15:42.714
<v Speaker 0>but

00:15:43.514 --> 00:15:44.475
<v Speaker 0>no biggie.

00:15:45.675 --> 00:15:46.315
<v Speaker 0>Talking.

00:15:49.675 --> 00:15:50.875
<v Speaker 0>So I will

00:15:51.035 --> 00:15:53.274
<v Speaker 0>say here that this is one of the

00:15:53.274 --> 00:15:53.915
<v Speaker 0>coolest,

00:15:54.450 --> 00:15:56.210
<v Speaker 0>I could have just did that. This is

00:15:56.210 --> 00:15:57.650
<v Speaker 0>one of the coolest features we've added to

00:15:57.650 --> 00:15:58.610
<v Speaker 0>InfluxDB.

00:16:00.130 --> 00:16:03.490
<v Speaker 0>All pretty much single handedly developed by Johnny.

00:16:03.490 --> 00:16:05.730
<v Speaker 0>One of the engineers on the tools team.

00:16:05.730 --> 00:16:07.970
<v Speaker 0>But it gives you like this declarative interface

00:16:09.035 --> 00:16:12.235
<v Speaker 0>to create any resource inside of InfluxDB.

00:16:12.235 --> 00:16:13.595
<v Speaker 0>Very similar to the way you would apply

00:16:13.595 --> 00:16:14.875
<v Speaker 0>a Kubernetes manifest.

00:16:15.275 --> 00:16:16.315
<v Speaker 0>Super awesome.

00:16:16.715 --> 00:16:18.475
<v Speaker 0>We get this nice preview. This is all

00:16:18.475 --> 00:16:19.995
<v Speaker 0>the stuff that's gonna create. I'm not gonna

00:16:19.995 --> 00:16:21.435
<v Speaker 0>go through that. We will just

00:16:21.900 --> 00:16:24.220
<v Speaker 0>gonna deploy and and and prod through the

00:16:24.220 --> 00:16:24.940
<v Speaker 0>UI.

00:16:26.300 --> 00:16:28.060
<v Speaker 0>But if you take a look, okay, if

00:16:28.060 --> 00:16:30.060
<v Speaker 0>we just get the syntax highlighting back, you

00:16:30.060 --> 00:16:32.300
<v Speaker 0>know, we can create labels and the manifest

00:16:32.300 --> 00:16:35.144
<v Speaker 0>format here just as Kubernetes style manifest. The

00:16:35.144 --> 00:16:37.305
<v Speaker 0>idea being that eventually there'll be an operator

00:16:37.305 --> 00:16:39.305
<v Speaker 0>on Kubernetes where we just support this as

00:16:39.305 --> 00:16:41.305
<v Speaker 0>a CRD. At least some of the resources

00:16:41.305 --> 00:16:42.505
<v Speaker 0>as a CRD.

00:16:43.625 --> 00:16:46.264
<v Speaker 0>It creates dashboard. It's got flux created in

00:16:46.264 --> 00:16:46.825
<v Speaker 0>it.

00:16:48.024 --> 00:16:50.760
<v Speaker 0>All the UI blah, blah, So what we

00:16:50.760 --> 00:16:53.800
<v Speaker 0>should see is that they create any buckets.

00:16:56.760 --> 00:16:57.880
<v Speaker 0>No.

00:16:57.880 --> 00:16:58.920
<v Speaker 0>No buckets.

00:16:59.160 --> 00:17:00.440
<v Speaker 0>Does it create

00:17:01.880 --> 00:17:04.280
<v Speaker 0>won't create the holographic scrapers or anything I

00:17:04.280 --> 00:17:05.174
<v Speaker 0>would have thought.

00:17:06.135 --> 00:17:07.255
<v Speaker 0>Any tasks?

00:17:07.255 --> 00:17:10.934
<v Speaker 0>Nope. Any alerts? Nope. So already there's there's

00:17:10.934 --> 00:17:12.694
<v Speaker 0>things we can add to this I believe,

00:17:12.855 --> 00:17:14.214
<v Speaker 0>but we do have dashboards.

00:17:14.375 --> 00:17:14.854
<v Speaker 0>So

00:17:15.335 --> 00:17:18.294
<v Speaker 0>we have a cube inventory dashboard

00:17:18.640 --> 00:17:21.279
<v Speaker 0>and a node metrics dashboard.

00:17:22.480 --> 00:17:24.240
<v Speaker 0>And we have no data but

00:17:24.960 --> 00:17:27.119
<v Speaker 0>we expect that for the time being. In

00:17:27.119 --> 00:17:28.800
<v Speaker 0>fact, I wonder if they do provide a

00:17:28.800 --> 00:17:30.800
<v Speaker 0>telegraph config for scraping this.

00:17:31.545 --> 00:17:32.665
<v Speaker 0>There

00:17:34.185 --> 00:17:34.985
<v Speaker 0>we go.

00:17:36.745 --> 00:17:38.905
<v Speaker 0>We're gonna use the home charts anyway,

00:17:39.225 --> 00:17:41.865
<v Speaker 0>but nice that this is provided.

00:17:43.385 --> 00:17:44.905
<v Speaker 0>So it's collecting metrics

00:17:44.980 --> 00:17:45.619
<v Speaker 0>on

00:17:45.860 --> 00:17:48.179
<v Speaker 0>a one minute interval with a ten second

00:17:48.179 --> 00:17:48.899
<v Speaker 0>flush.

00:17:50.179 --> 00:17:52.419
<v Speaker 0>Okay. I think that can be tweaked. I

00:17:52.419 --> 00:17:53.700
<v Speaker 0>don't think that makes a lot of sense,

00:17:53.700 --> 00:17:54.179
<v Speaker 0>but

00:17:55.620 --> 00:17:56.339
<v Speaker 0>okay.

00:17:57.220 --> 00:17:57.620
<v Speaker 0>Alright.

00:17:59.915 --> 00:18:01.755
<v Speaker 0>So we want to deploy

00:18:01.755 --> 00:18:02.715
<v Speaker 0>Helm charts.

00:18:03.835 --> 00:18:05.915
<v Speaker 0>So the Influx

00:18:05.915 --> 00:18:07.674
<v Speaker 0>Helm charts do provide

00:18:08.955 --> 00:18:11.940
<v Speaker 0>one very opinionated way of collecting metrics and

00:18:11.940 --> 00:18:13.220
<v Speaker 0>then one flexible

00:18:13.220 --> 00:18:15.779
<v Speaker 0>option. So let's talk about that.

00:18:16.260 --> 00:18:17.779
<v Speaker 0>The telegraph DS

00:18:18.419 --> 00:18:20.580
<v Speaker 0>is our opinionated

00:18:20.580 --> 00:18:22.179
<v Speaker 0>very little configuration

00:18:22.820 --> 00:18:24.580
<v Speaker 0>helm chart to deploy

00:18:26.235 --> 00:18:29.275
<v Speaker 0>Kubernetes and node based metric collection.

00:18:29.995 --> 00:18:31.915
<v Speaker 0>And we have had pull requests and issues

00:18:31.915 --> 00:18:33.275
<v Speaker 0>where people want us to add new things

00:18:33.275 --> 00:18:35.035
<v Speaker 0>to it, but you know, if you want

00:18:35.035 --> 00:18:36.475
<v Speaker 0>to run your own plugins and save the

00:18:36.475 --> 00:18:37.915
<v Speaker 0>cluster, you should just use

00:18:38.390 --> 00:18:39.269
<v Speaker 0>telegraph.

00:18:39.590 --> 00:18:41.190
<v Speaker 0>The DS one is just,

00:18:41.510 --> 00:18:43.350
<v Speaker 0>if you want to monitor Kubernetes just use

00:18:43.350 --> 00:18:45.429
<v Speaker 0>this chart and it's gonna get you a

00:18:45.429 --> 00:18:46.629
<v Speaker 0>pretty good way through it.

00:18:46.950 --> 00:18:49.029
<v Speaker 0>Let's see what we get for, get with

00:18:49.029 --> 00:18:51.990
<v Speaker 0>this. So let's do deploy telegraph

00:18:51.990 --> 00:18:53.029
<v Speaker 0>DS

00:18:53.865 --> 00:18:56.185
<v Speaker 0>Throw in this command. I'm happy with all

00:18:56.185 --> 00:18:58.505
<v Speaker 0>that. I don't think there's really much to

00:18:58.505 --> 00:18:59.304
<v Speaker 0>change here.

00:19:01.145 --> 00:19:03.065
<v Speaker 0>Yep. We're gonna run telegraph one fourteen. We're

00:19:03.065 --> 00:19:04.424
<v Speaker 0>gonna run Alpine variant.

00:19:04.665 --> 00:19:07.500
<v Speaker 0>I'm not fussed about the resource things. We

00:19:07.500 --> 00:19:09.340
<v Speaker 0>do need to use the downward API just

00:19:09.340 --> 00:19:10.700
<v Speaker 0>to inject the host name.

00:19:12.380 --> 00:19:13.900
<v Speaker 0>And that's just so that we can hit

00:19:13.900 --> 00:19:14.940
<v Speaker 0>the cubelet

00:19:14.940 --> 00:19:18.300
<v Speaker 0>from each node inside of the cluster without

00:19:18.300 --> 00:19:20.460
<v Speaker 0>going through the API proxy server

00:19:21.065 --> 00:19:22.985
<v Speaker 0>or maybe we do go through that anyway,

00:19:22.985 --> 00:19:24.345
<v Speaker 0>but that's irrelevant.

00:19:24.665 --> 00:19:26.904
<v Speaker 0>Host IP, some prox stuff,

00:19:27.785 --> 00:19:30.664
<v Speaker 0>service accounts and then the config itself,

00:19:33.385 --> 00:19:35.705
<v Speaker 0>where it's going to try and write

00:19:38.159 --> 00:19:38.799
<v Speaker 0>to

00:19:39.039 --> 00:19:39.759
<v Speaker 0>here,

00:19:40.559 --> 00:19:42.559
<v Speaker 0>which won't work for us. So we do

00:19:42.559 --> 00:19:44.080
<v Speaker 0>need to tweak that.

00:19:46.000 --> 00:19:46.559
<v Speaker 0>Okay.

00:19:51.485 --> 00:19:52.525
<v Speaker 0>Let's just

00:19:52.925 --> 00:19:55.005
<v Speaker 0>double check how this works.

00:20:04.525 --> 00:20:05.645
<v Speaker 0>ConfigMap.

00:20:06.045 --> 00:20:08.740
<v Speaker 0>There we go. So it enables

00:20:09.620 --> 00:20:11.220
<v Speaker 0>so we have the ability to change the

00:20:11.220 --> 00:20:12.820
<v Speaker 0>agent, processes,

00:20:12.820 --> 00:20:14.340
<v Speaker 0>aggregators and outputs.

00:20:14.660 --> 00:20:17.780
<v Speaker 0>There is no possibility to change the inputs

00:20:17.780 --> 00:20:18.180
<v Speaker 0>though.

00:20:20.975 --> 00:20:22.495
<v Speaker 0>And we do just go through a straight

00:20:22.495 --> 00:20:24.975
<v Speaker 0>to the Qplet IP. We don't go through

00:20:24.975 --> 00:20:27.455
<v Speaker 0>the API server proxy. So that's good.

00:20:28.575 --> 00:20:30.414
<v Speaker 0>May not work on JKE if I remember

00:20:30.414 --> 00:20:31.455
<v Speaker 0>correctly though.

00:20:32.174 --> 00:20:36.230
<v Speaker 0>So we want to values config outputs.

00:20:36.230 --> 00:20:38.390
<v Speaker 0>We wanna modify that to rate the influx

00:20:38.390 --> 00:20:39.590
<v Speaker 0>DB two.

00:20:40.790 --> 00:20:42.150
<v Speaker 0>So config

00:20:42.150 --> 00:20:44.070
<v Speaker 0>outputs. In fact, if we just copy all

00:20:44.070 --> 00:20:45.510
<v Speaker 0>of this and delete the stuff that we

00:20:45.510 --> 00:20:46.310
<v Speaker 0>don't need.

00:20:47.030 --> 00:20:48.390
<v Speaker 0>So telegraph.

00:20:52.205 --> 00:20:53.085
<v Speaker 0>YAML.

00:20:53.965 --> 00:20:56.125
<v Speaker 0>I will turn on monitor self.

00:20:58.125 --> 00:21:00.044
<v Speaker 0>I'm not gonna touch any of this.

00:21:00.285 --> 00:21:02.044
<v Speaker 0>We just want to modify this.

00:21:02.765 --> 00:21:05.320
<v Speaker 0>We're just gonna go to the InfluxDB

00:21:05.320 --> 00:21:06.279
<v Speaker 0>service,

00:21:06.680 --> 00:21:07.159
<v Speaker 0>which

00:21:09.880 --> 00:21:10.919
<v Speaker 0>should exist.

00:21:14.440 --> 00:21:16.440
<v Speaker 0>Didn't do a full name override,

00:21:16.680 --> 00:21:17.480
<v Speaker 0>we'll just

00:21:17.800 --> 00:21:20.735
<v Speaker 0>drop that in on port nine nine nine

00:21:20.735 --> 00:21:23.455
<v Speaker 0>nine. And now actually, yeah, I think the

00:21:23.455 --> 00:21:25.695
<v Speaker 0>service that just goes over standard 80,

00:21:26.495 --> 00:21:28.014
<v Speaker 0>so we can just take that off.

00:21:28.414 --> 00:21:31.740
<v Speaker 0>Database wise, let's well, that's not about setting

00:21:31.740 --> 00:21:34.860
<v Speaker 0>for this. What we want is bucket and

00:21:34.860 --> 00:21:36.140
<v Speaker 0>we want default.

00:21:37.660 --> 00:21:38.380
<v Speaker 0>We

00:21:40.380 --> 00:21:41.019
<v Speaker 0>need

00:21:41.340 --> 00:21:42.059
<v Speaker 0>our

00:21:43.180 --> 00:21:44.380
<v Speaker 0>organization

00:21:44.380 --> 00:21:45.020
<v Speaker 0>maybe.

00:21:45.995 --> 00:21:47.275
<v Speaker 0>Influx data.

00:21:47.355 --> 00:21:48.635
<v Speaker 0>We need token.

00:21:49.195 --> 00:21:49.835
<v Speaker 0>And

00:21:50.235 --> 00:21:52.395
<v Speaker 0>I'm just gonna hardcore the token for now

00:21:52.395 --> 00:21:54.715
<v Speaker 0>but if someone reminds me,

00:21:55.675 --> 00:21:57.195
<v Speaker 0>we'll clean that up later.

00:21:57.835 --> 00:22:00.075
<v Speaker 0>There is a project I've been working on.

00:22:02.630 --> 00:22:03.669
<v Speaker 0>Telegraph,

00:22:04.549 --> 00:22:05.350
<v Speaker 0>nope.

00:22:05.590 --> 00:22:06.789
<v Speaker 0>InfluxDB

00:22:07.429 --> 00:22:08.389
<v Speaker 0>operator.

00:22:09.110 --> 00:22:09.669
<v Speaker 0>This

00:22:12.390 --> 00:22:13.749
<v Speaker 0>actually allows

00:22:14.390 --> 00:22:15.429
<v Speaker 0>if we take a look,

00:22:17.164 --> 00:22:18.605
<v Speaker 0>I can't even remember where I put the

00:22:18.605 --> 00:22:19.484
<v Speaker 0>fails,

00:22:19.645 --> 00:22:20.604
<v Speaker 0>samples.

00:22:21.164 --> 00:22:22.604
<v Speaker 0>This allows you to

00:22:24.445 --> 00:22:26.604
<v Speaker 0>define an InfluxDB that exists,

00:22:26.605 --> 00:22:29.325
<v Speaker 0>you specify the organization ID, you can provide

00:22:29.325 --> 00:22:30.524
<v Speaker 0>the root token

00:22:30.605 --> 00:22:31.485
<v Speaker 0>and then

00:22:31.700 --> 00:22:34.740
<v Speaker 0>anything inside of your Kubernetes cluster can request

00:22:34.740 --> 00:22:36.260
<v Speaker 0>additional tokens

00:22:36.740 --> 00:22:38.260
<v Speaker 0>for that InfluxDB.

00:22:39.140 --> 00:22:40.980
<v Speaker 0>Something that doesn't do just yet is allow

00:22:40.980 --> 00:22:43.220
<v Speaker 0>you to scope that token to be just

00:22:43.220 --> 00:22:45.220
<v Speaker 0>one or two buckets or just read access

00:22:45.220 --> 00:22:46.820
<v Speaker 0>but you know, still a work in progress.

00:22:47.865 --> 00:22:49.465
<v Speaker 0>So we can try and drop that in

00:22:49.465 --> 00:22:51.145
<v Speaker 0>later but I don't want that to slow

00:22:51.145 --> 00:22:52.345
<v Speaker 0>me down right now.

00:22:53.145 --> 00:22:54.745
<v Speaker 0>So we need to

00:22:55.225 --> 00:22:56.265
<v Speaker 0>add a token.

00:22:56.985 --> 00:23:00.025
<v Speaker 0>Got it. So if I find that token

00:23:00.025 --> 00:23:02.185
<v Speaker 0>again from just taking a look at,

00:23:04.800 --> 00:23:07.040
<v Speaker 0>I'm in a different directory, I switched to

00:23:07.040 --> 00:23:08.240
<v Speaker 0>global history

00:23:08.320 --> 00:23:09.760
<v Speaker 0>and flux

00:23:09.840 --> 00:23:11.039
<v Speaker 0>dash t.

00:23:14.880 --> 00:23:16.560
<v Speaker 0>Yeah, let's just get it back. Okay.

00:23:21.164 --> 00:23:22.124
<v Speaker 0>YAML.

00:23:22.684 --> 00:23:24.604
<v Speaker 0>I don't remember how to JQ

00:23:26.125 --> 00:23:27.724
<v Speaker 0>base 64.

00:23:28.365 --> 00:23:30.284
<v Speaker 0>I know all my history is randomly showing

00:23:30.284 --> 00:23:32.125
<v Speaker 0>up. Switch that back

00:23:32.460 --> 00:23:34.139
<v Speaker 0>and there's our token

00:23:36.620 --> 00:23:38.460
<v Speaker 0>and back to local history.

00:23:38.540 --> 00:23:39.100
<v Speaker 0>So

00:23:40.220 --> 00:23:41.820
<v Speaker 0>dropping the token.

00:23:42.540 --> 00:23:43.419
<v Speaker 0>Let's just

00:23:43.900 --> 00:23:45.995
<v Speaker 0>make sure I've not forgotten

00:23:45.995 --> 00:23:47.755
<v Speaker 0>anything. Where did I just put all those

00:23:47.755 --> 00:23:48.474
<v Speaker 0>tabs?

00:23:49.434 --> 00:23:51.354
<v Speaker 0>So

00:23:51.515 --> 00:23:52.474
<v Speaker 0>telegraph.

00:23:55.914 --> 00:23:57.835
<v Speaker 0>I just wanna double check the config before

00:23:57.835 --> 00:23:59.595
<v Speaker 0>I go applying this and realize I've forgotten

00:23:59.595 --> 00:24:02.370
<v Speaker 0>something else. So inputs,

00:24:02.370 --> 00:24:03.649
<v Speaker 0>no outputs.

00:24:03.889 --> 00:24:04.690
<v Speaker 0>InfluxDB

00:24:04.690 --> 00:24:05.489
<v Speaker 0>two.

00:24:09.490 --> 00:24:13.649
<v Speaker 0>Talking got URLs got organization got bucket got

00:24:13.889 --> 00:24:14.529
<v Speaker 0>perfect.

00:24:15.145 --> 00:24:17.784
<v Speaker 0>Token organization bucket URLs,

00:24:18.505 --> 00:24:19.625
<v Speaker 0>fix the name,

00:24:21.545 --> 00:24:22.745
<v Speaker 0>monitor self.

00:24:27.945 --> 00:24:28.985
<v Speaker 0>Let's see what happens.

00:24:32.250 --> 00:24:33.690
<v Speaker 0>Let's run get pods.

00:24:35.290 --> 00:24:37.450
<v Speaker 0>Telegraph of creatine. Let's run a watch on

00:24:37.450 --> 00:24:38.649
<v Speaker 0>that and just wait.

00:24:40.890 --> 00:24:42.090
<v Speaker 0>It's running.

00:24:43.370 --> 00:24:46.144
<v Speaker 0>Let's grab some logs, make sure it's happy.

00:24:49.184 --> 00:24:51.345
<v Speaker 0>It's right into the wrong place.

00:24:52.065 --> 00:24:55.345
<v Speaker 0>Helps

00:24:55.345 --> 00:24:56.065
<v Speaker 0>if

00:24:56.145 --> 00:24:57.825
<v Speaker 0>I tell it to use the values file.

00:24:58.940 --> 00:25:00.540
<v Speaker 0>So telegraph

00:25:00.540 --> 00:25:01.580
<v Speaker 0>d s

00:25:01.820 --> 00:25:03.020
<v Speaker 0>dot yaml.

00:25:04.380 --> 00:25:06.779
<v Speaker 0>Let's just update that deployment.

00:25:10.140 --> 00:25:12.380
<v Speaker 0>Let that terminate, spin back up

00:25:12.965 --> 00:25:15.365
<v Speaker 0>and then pull out the logs one more

00:25:15.365 --> 00:25:15.924
<v Speaker 0>time.

00:25:17.445 --> 00:25:18.245
<v Speaker 0>Perfect.

00:25:18.405 --> 00:25:20.405
<v Speaker 0>So we'll give that ten seconds.

00:25:26.080 --> 00:25:27.279
<v Speaker 0>Just wanna make sure we don't get an

00:25:27.279 --> 00:25:29.119
<v Speaker 0>error message when it tries to do the

00:25:29.200 --> 00:25:30.399
<v Speaker 0>buffer flush.

00:25:31.279 --> 00:25:33.679
<v Speaker 0>Looks okay to me. I'm gonna jump over

00:25:33.679 --> 00:25:34.239
<v Speaker 0>here

00:25:35.279 --> 00:25:37.200
<v Speaker 0>and let's just have a look at the

00:25:37.200 --> 00:25:39.594
<v Speaker 0>data. Nice. We have loads of data.

00:25:39.755 --> 00:25:40.394
<v Speaker 0>Okay.

00:25:41.595 --> 00:25:42.794
<v Speaker 0>So if we wanna take a look at

00:25:42.794 --> 00:25:43.754
<v Speaker 0>the CPU,

00:25:43.835 --> 00:25:46.154
<v Speaker 0>I should put in few of these or

00:25:46.154 --> 00:25:47.274
<v Speaker 0>all of them, I guess.

00:25:49.755 --> 00:25:51.274
<v Speaker 0>Five minutes

00:25:51.355 --> 00:25:53.434
<v Speaker 0>and data, data, data, data, data.

00:25:54.799 --> 00:25:55.440
<v Speaker 0>Okay.

00:25:56.320 --> 00:25:58.480
<v Speaker 0>What do our boards look like now?

00:26:05.440 --> 00:26:07.600
<v Speaker 0>Okay. So default.

00:26:07.600 --> 00:26:08.240
<v Speaker 0>There we go.

00:26:10.815 --> 00:26:13.294
<v Speaker 0>So our node metrics dashboard

00:26:13.775 --> 00:26:15.215
<v Speaker 0>gives us

00:26:16.975 --> 00:26:19.534
<v Speaker 0>node names and node count.

00:26:21.535 --> 00:26:24.119
<v Speaker 0>We've got some CPU metrics.

00:26:24.600 --> 00:26:25.880
<v Speaker 0>So we don't have a lot of data

00:26:25.880 --> 00:26:26.840
<v Speaker 0>just yet.

00:26:31.399 --> 00:26:34.360
<v Speaker 0>What are these doing? Allocatable CPU

00:26:34.360 --> 00:26:35.000
<v Speaker 0>cores.

00:26:37.095 --> 00:26:37.815
<v Speaker 0>So

00:26:38.855 --> 00:26:42.215
<v Speaker 0>filters on Kubernetes pulls out this field aggregates

00:26:42.215 --> 00:26:43.975
<v Speaker 0>and pulls out the last value.

00:26:47.415 --> 00:26:48.054
<v Speaker 0>Well,

00:26:48.455 --> 00:26:52.855
<v Speaker 0>maybe that'll pop up later. Nano core distribution

00:26:52.350 --> 00:26:53.549
<v Speaker 0>by node.

00:27:01.150 --> 00:27:02.190
<v Speaker 0>Not

00:27:02.190 --> 00:27:03.070
<v Speaker 0>something

00:27:03.390 --> 00:27:04.269
<v Speaker 0>I think

00:27:04.590 --> 00:27:05.789
<v Speaker 0>I would find

00:27:06.590 --> 00:27:06.990
<v Speaker 0>useful.

00:27:07.465 --> 00:27:09.225
<v Speaker 0>Maybe there's a better way we can build

00:27:09.225 --> 00:27:10.345
<v Speaker 0>this visualization.

00:27:10.345 --> 00:27:11.785
<v Speaker 0>I prefer this one. I think that's a

00:27:11.785 --> 00:27:12.585
<v Speaker 0>little better

00:27:13.065 --> 00:27:14.745
<v Speaker 0>when we have some more data here.

00:27:17.065 --> 00:27:18.505
<v Speaker 0>Nano core distribution.

00:27:19.305 --> 00:27:19.545
<v Speaker 0>Me.

00:27:21.560 --> 00:27:22.840
<v Speaker 0>Pod capacity.

00:27:22.920 --> 00:27:25.159
<v Speaker 0>So I'm assuming that's pulling and

00:27:26.200 --> 00:27:27.880
<v Speaker 0>pod per node limit

00:27:28.120 --> 00:27:30.759
<v Speaker 0>probably doesn't exist in many cube.

00:27:33.000 --> 00:27:35.774
<v Speaker 0>And node current is fine. Memory consumption.

00:27:35.855 --> 00:27:37.054
<v Speaker 0>Alright. Perfect.

00:27:37.615 --> 00:27:39.855
<v Speaker 0>Let's just break distribution by

00:27:47.535 --> 00:27:48.255
<v Speaker 0>node name.

00:27:51.160 --> 00:27:51.880
<v Speaker 0>Okay.

00:27:52.520 --> 00:27:53.640
<v Speaker 0>File system.

00:27:55.880 --> 00:27:57.800
<v Speaker 0>Yep. Everyone needs to know when this is

00:27:57.800 --> 00:27:59.320
<v Speaker 0>gonna fill up. We could build on all

00:27:59.320 --> 00:28:00.680
<v Speaker 0>that around us for sure.

00:28:01.240 --> 00:28:03.720
<v Speaker 0>Nothing worse than being woken up at 3AM.

00:28:03.720 --> 00:28:04.840
<v Speaker 0>I've been disconnected there.

00:28:06.055 --> 00:28:08.535
<v Speaker 0>And our network consumption. Yeah. Of course. We

00:28:08.535 --> 00:28:09.495
<v Speaker 0>need to understand

00:28:09.975 --> 00:28:11.495
<v Speaker 0>what's going through the pipes.

00:28:11.815 --> 00:28:12.535
<v Speaker 0>Okay.

00:28:14.215 --> 00:28:15.095
<v Speaker 0>I think

00:28:17.520 --> 00:28:19.680
<v Speaker 0>I mean I mean, it does say Kubernetes

00:28:19.680 --> 00:28:20.799
<v Speaker 0>node metrics.

00:28:23.280 --> 00:28:25.679
<v Speaker 0>I think the Linux system dashboard

00:28:26.560 --> 00:28:29.040
<v Speaker 0>may be a slightly better fit, give us

00:28:29.040 --> 00:28:30.320
<v Speaker 0>a bit more information

00:28:30.585 --> 00:28:31.384
<v Speaker 0>and

00:28:31.705 --> 00:28:34.345
<v Speaker 0>there's nothing really Kubernetes specific here other than

00:28:34.345 --> 00:28:35.465
<v Speaker 0>some pod stuff.

00:28:39.544 --> 00:28:42.745
<v Speaker 0>So John says the bar interface at least

00:28:42.745 --> 00:28:44.664
<v Speaker 0>shows what nodes are above the median load

00:28:44.664 --> 00:28:46.930
<v Speaker 0>wise could be good for balance. Yeah.

00:28:48.450 --> 00:28:49.330
<v Speaker 0>Fair point.

00:28:50.530 --> 00:28:52.770
<v Speaker 0>Alright. Cool. That's the first dashboard.

00:28:54.130 --> 00:28:55.330
<v Speaker 0>Next dashboard,

00:28:55.410 --> 00:28:58.370
<v Speaker 0>cube inventory. This is actually going to show

00:28:58.370 --> 00:29:00.290
<v Speaker 0>us

00:29:01.005 --> 00:29:02.764
<v Speaker 0>Kubernetes resources.

00:29:05.965 --> 00:29:08.764
<v Speaker 0>I've got this memory and CPU stuff again,

00:29:09.085 --> 00:29:10.924
<v Speaker 0>a little bit of duplication.

00:29:12.125 --> 00:29:14.284
<v Speaker 0>But we're not actually getting

00:29:16.309 --> 00:29:17.669
<v Speaker 0>any Kubernetes stuff.

00:29:18.789 --> 00:29:21.190
<v Speaker 0>So this dashboard shows Kubernetes

00:29:21.190 --> 00:29:23.909
<v Speaker 0>metrics based on the cube inventory APIs

00:29:23.909 --> 00:29:26.710
<v Speaker 0>collected via telegraph cube inventory plugin.

00:29:26.995 --> 00:29:30.514
<v Speaker 0>Make sure you have the bucket variable selected,

00:29:31.235 --> 00:29:32.114
<v Speaker 0>which I do.

00:29:34.355 --> 00:29:36.274
<v Speaker 0>So that we configure

00:29:38.515 --> 00:29:40.674
<v Speaker 0>Influx cube inventory

00:29:41.154 --> 00:29:41.794
<v Speaker 0>plugin.

00:29:42.970 --> 00:29:43.850
<v Speaker 0>Let's just

00:29:44.170 --> 00:29:44.970
<v Speaker 0>jump

00:29:44.970 --> 00:29:47.050
<v Speaker 0>inside of this pod and

00:29:48.490 --> 00:29:50.570
<v Speaker 0>let's go and take a look.

00:29:51.370 --> 00:29:53.610
<v Speaker 0>I could probably be a bit faster if

00:29:53.610 --> 00:29:54.890
<v Speaker 0>I just put up the help me pull,

00:29:54.890 --> 00:29:55.450
<v Speaker 0>but

00:29:56.490 --> 00:29:59.075
<v Speaker 0>okay. Right. So we don't enable cube inventory

00:29:59.075 --> 00:30:00.835
<v Speaker 0>on this. Actually, that makes sense. Right. This

00:30:00.835 --> 00:30:02.995
<v Speaker 0>is a daemon set deployment and the cube

00:30:02.995 --> 00:30:05.075
<v Speaker 0>inventory plug in, we only want one off.

00:30:05.554 --> 00:30:07.234
<v Speaker 0>So let's get that deployed.

00:30:07.315 --> 00:30:08.754
<v Speaker 0>So deploy

00:30:08.835 --> 00:30:09.475
<v Speaker 0>telegraph.

00:30:10.720 --> 00:30:12.880
<v Speaker 0>We'll call this telegraph Kubernetes. We may have

00:30:12.880 --> 00:30:14.639
<v Speaker 0>more telegraphs. I think there'll be other stuff

00:30:14.639 --> 00:30:16.079
<v Speaker 0>that we want to deploy to.

00:30:18.399 --> 00:30:19.999
<v Speaker 0>So we're gonna deploy

00:30:20.240 --> 00:30:21.759
<v Speaker 0>telegraph Kubernetes.

00:30:22.080 --> 00:30:22.960
<v Speaker 0>I hate

00:30:23.225 --> 00:30:25.304
<v Speaker 0>shortening it to Kate's but

00:30:25.545 --> 00:30:27.145
<v Speaker 0>brevity I think is gonna be my friend

00:30:27.145 --> 00:30:27.784
<v Speaker 0>here.

00:30:28.585 --> 00:30:29.945
<v Speaker 0>And we'll have this

00:30:30.185 --> 00:30:33.225
<v Speaker 0>and we'll have this. We're gonna create

00:30:33.385 --> 00:30:34.904
<v Speaker 0>a telegraph

00:30:34.985 --> 00:30:35.785
<v Speaker 0>Kubernetes.

00:30:36.910 --> 00:30:39.470
<v Speaker 0>We're gonna jump over to the helm charts

00:30:39.470 --> 00:30:40.270
<v Speaker 0>again.

00:30:40.270 --> 00:30:42.750
<v Speaker 0>So this time we wanna take the hello.

00:30:42.750 --> 00:30:45.630
<v Speaker 0>I'm correct. The telegraph chart that allows us

00:30:46.270 --> 00:30:48.670
<v Speaker 0>to inject pretty much any configuration that we

00:30:48.670 --> 00:30:48.910
<v Speaker 0>want.

00:30:50.355 --> 00:30:52.275
<v Speaker 0>Now if we open the values file here,

00:30:52.275 --> 00:30:54.674
<v Speaker 0>yes, we're only gonna want one for this.

00:30:54.675 --> 00:30:56.434
<v Speaker 0>We're gonna use the same image.

00:31:02.275 --> 00:31:04.035
<v Speaker 0>Probably disabled that. I don't know why that's

00:31:04.035 --> 00:31:06.220
<v Speaker 0>there. It's probably been there since before the

00:31:06.220 --> 00:31:08.700
<v Speaker 0>charts were under influx data control or at

00:31:08.700 --> 00:31:10.940
<v Speaker 0>least maintenance, not control. That was a horrible

00:31:10.940 --> 00:31:11.899
<v Speaker 0>way to say that.

00:31:15.660 --> 00:31:18.300
<v Speaker 0>We've got

00:31:16.905 --> 00:31:17.705
<v Speaker 0>volumes

00:31:17.705 --> 00:31:19.865
<v Speaker 0>here. Oh, yeah. I fixed this recently because

00:31:19.865 --> 00:31:20.745
<v Speaker 0>it didn't work.

00:31:21.865 --> 00:31:23.625
<v Speaker 0>So an older volume and key was previously

00:31:23.625 --> 00:31:25.225
<v Speaker 0>added which will likely not work as you

00:31:25.225 --> 00:31:27.865
<v Speaker 0>expect. It doesn't work at all. Please use

00:31:27.865 --> 00:31:30.345
<v Speaker 0>this New York configuration. So we can inject

00:31:30.345 --> 00:31:31.785
<v Speaker 0>our own config. Good.

00:31:32.269 --> 00:31:35.230
<v Speaker 0>Our back stuff, service accounts. We've got config,

00:31:35.230 --> 00:31:36.109
<v Speaker 0>config, config.

00:31:40.750 --> 00:31:42.429
<v Speaker 0>I don't know why. I don't know why

00:31:42.429 --> 00:31:44.350
<v Speaker 0>you'd wanna do that. I'm sure this a

00:31:44.350 --> 00:31:45.789
<v Speaker 0>use case I can't think of right now.

00:31:47.835 --> 00:31:49.755
<v Speaker 0>So this is the default

00:31:50.315 --> 00:31:52.315
<v Speaker 0>really. Well, I mean, I don't know why

00:31:52.315 --> 00:31:53.515
<v Speaker 0>stats d is

00:31:55.195 --> 00:31:56.635
<v Speaker 0>running as a default configuration,

00:31:58.890 --> 00:32:01.210
<v Speaker 0>but let's just ignore that for now and

00:32:01.210 --> 00:32:02.410
<v Speaker 0>let's copy

00:32:02.970 --> 00:32:03.690
<v Speaker 0>this.

00:32:05.130 --> 00:32:07.050
<v Speaker 0>So what we want to deploy here,

00:32:07.450 --> 00:32:08.810
<v Speaker 0>I'm not thinking off the top of my

00:32:08.810 --> 00:32:10.810
<v Speaker 0>head that I want this to be easier

00:32:10.810 --> 00:32:13.295
<v Speaker 0>for people that wanna monitor Kubernetes clusters. I

00:32:13.295 --> 00:32:15.535
<v Speaker 0>think the telegraph DS one is great because

00:32:16.095 --> 00:32:18.335
<v Speaker 0>no configuration is really required.

00:32:19.535 --> 00:32:21.055
<v Speaker 0>Except for just telling it where to write

00:32:21.055 --> 00:32:22.095
<v Speaker 0>the metrics too.

00:32:23.295 --> 00:32:24.735
<v Speaker 0>I think maybe there should be another

00:32:25.570 --> 00:32:27.650
<v Speaker 0>chart or maybe we should just provide a

00:32:27.650 --> 00:32:28.690
<v Speaker 0>values

00:32:29.250 --> 00:32:31.169
<v Speaker 0>Kubernetes or something here.

00:32:33.170 --> 00:32:34.930
<v Speaker 0>So that just says this is your this

00:32:34.930 --> 00:32:36.530
<v Speaker 0>is the one that you use for getting,

00:32:37.250 --> 00:32:39.890
<v Speaker 0>you know, Kubernetes resources metrics. I don't know.

00:32:40.595 --> 00:32:42.355
<v Speaker 0>Anyone get any thoughts on that? I'd love

00:32:42.355 --> 00:32:43.235
<v Speaker 0>to hear that.

00:32:44.675 --> 00:32:46.035
<v Speaker 0>So let's copy

00:32:47.075 --> 00:32:49.235
<v Speaker 0>this which is normally a bad idea. I

00:32:49.235 --> 00:32:51.075
<v Speaker 0>hate copying stuff but again,

00:32:51.715 --> 00:32:53.555
<v Speaker 0>an interest of not boring the hell out

00:32:53.555 --> 00:32:53.875
<v Speaker 0>of these.

00:32:54.910 --> 00:32:55.950
<v Speaker 0>Let's copy.

00:32:56.990 --> 00:32:59.470
<v Speaker 0>We can just nuke all of this.

00:33:01.150 --> 00:33:02.830
<v Speaker 0>Oh, did I go to far?

00:33:04.430 --> 00:33:06.190
<v Speaker 0>We can just add output for ourselves.

00:33:08.445 --> 00:33:09.725
<v Speaker 0>And put wise,

00:33:10.045 --> 00:33:12.445
<v Speaker 0>don't care for stats d. What I do

00:33:12.445 --> 00:33:13.965
<v Speaker 0>want is cube inventory.

00:33:17.645 --> 00:33:20.445
<v Speaker 0>And what I'll add is I

00:33:19.840 --> 00:33:22.240
<v Speaker 0>really dislike this name when the plugin launched

00:33:22.240 --> 00:33:23.919
<v Speaker 0>and then tried to get it changed. It's

00:33:23.919 --> 00:33:25.759
<v Speaker 0>just I've never heard anyone in the Kubernetes

00:33:25.759 --> 00:33:26.799
<v Speaker 0>ecosystem

00:33:27.279 --> 00:33:29.759
<v Speaker 0>refer to it as an inventory. Maybe like

00:33:29.759 --> 00:33:31.360
<v Speaker 0>from Ansible chef

00:33:31.360 --> 00:33:32.320
<v Speaker 0>puppet

00:33:32.399 --> 00:33:33.039
<v Speaker 0>backgrounds,

00:33:33.865 --> 00:33:36.184
<v Speaker 0>but just not in Kubernetes. I tried to

00:33:36.184 --> 00:33:38.904
<v Speaker 0>get it named cube resources or something, but

00:33:38.904 --> 00:33:41.465
<v Speaker 0>I lost that fight maybe another day.

00:33:42.345 --> 00:33:43.705
<v Speaker 0>So how do we configure

00:33:44.424 --> 00:33:45.144
<v Speaker 0>that?

00:33:45.625 --> 00:33:47.544
<v Speaker 0>Let's go inputs

00:33:47.705 --> 00:33:48.664
<v Speaker 0>cube

00:33:50.550 --> 00:33:51.590
<v Speaker 0>inventory.

00:33:53.270 --> 00:33:54.149
<v Speaker 0>We,

00:33:54.870 --> 00:33:57.430
<v Speaker 0>you know, wanna grab a URL.

00:34:06.795 --> 00:34:08.795
<v Speaker 0>Need to change that

00:34:11.515 --> 00:34:12.715
<v Speaker 0>namespace.

00:34:12.715 --> 00:34:15.114
<v Speaker 0>We wanna do all. We'll leave that blank.

00:34:17.849 --> 00:34:19.850
<v Speaker 0>Better talking path.

00:34:22.170 --> 00:34:24.010
<v Speaker 0>Yep. I think I've been trying to get

00:34:24.010 --> 00:34:25.770
<v Speaker 0>that set as a default for a long

00:34:25.770 --> 00:34:26.489
<v Speaker 0>time,

00:34:27.609 --> 00:34:28.409
<v Speaker 0>but not yet.

00:34:30.955 --> 00:34:32.315
<v Speaker 0>At least I got a comment at the

00:34:32.315 --> 00:34:32.875
<v Speaker 0>time.

00:34:33.594 --> 00:34:34.554
<v Speaker 0>There we go.

00:34:36.955 --> 00:34:37.995
<v Speaker 0>What else?

00:34:39.514 --> 00:34:40.795
<v Speaker 0>We're gonna include everything.

00:34:47.190 --> 00:34:49.190
<v Speaker 0>What I'm going to do is I'm pretty

00:34:49.190 --> 00:34:50.949
<v Speaker 0>sure I've configured this before

00:34:51.510 --> 00:34:54.549
<v Speaker 0>and my InfluxDB examples repository

00:34:56.415 --> 00:34:58.175
<v Speaker 0>where I have a full end to end

00:34:58.175 --> 00:35:00.175
<v Speaker 0>Kubernetes thing here that I'm trying not to

00:35:00.175 --> 00:35:01.055
<v Speaker 0>use today.

00:35:02.975 --> 00:35:04.175
<v Speaker 0>But I

00:35:04.175 --> 00:35:05.135
<v Speaker 0>think

00:35:08.575 --> 00:35:10.895
<v Speaker 0>it may be useful just to double check.

00:35:14.640 --> 00:35:16.720
<v Speaker 0>So

00:35:16.720 --> 00:35:19.040
<v Speaker 0>this is how I configure it normally.

00:35:21.520 --> 00:35:23.200
<v Speaker 0>Don't know why I'm turning them to blank.

00:35:23.200 --> 00:35:24.240
<v Speaker 0>I'm sure there's a reading.

00:35:25.914 --> 00:35:27.355
<v Speaker 0>Kubernetes defaults.

00:35:27.355 --> 00:35:30.555
<v Speaker 0>Fine. Open. Fine. There was something else, wasn't

00:35:30.555 --> 00:35:31.115
<v Speaker 0>there?

00:35:31.355 --> 00:35:33.595
<v Speaker 0>Wait. I'm thinking of the Gelps example.

00:35:37.674 --> 00:35:39.835
<v Speaker 0>There's a new flag added to this plugin.

00:35:40.089 --> 00:35:41.369
<v Speaker 0>I thought I was trying to remember what

00:35:41.369 --> 00:35:42.090
<v Speaker 0>it was.

00:35:47.290 --> 00:35:48.090
<v Speaker 0>Maybe.

00:35:54.410 --> 00:35:56.395
<v Speaker 0>Tell you what. Let's do

00:35:57.835 --> 00:35:59.355
<v Speaker 0>you know what? That's not important.

00:36:00.395 --> 00:36:01.115
<v Speaker 0>Alright.

00:36:01.755 --> 00:36:03.194
<v Speaker 0>We never got a reminder of what that

00:36:03.194 --> 00:36:05.835
<v Speaker 0>was anyway. We have the key. I guess

00:36:05.835 --> 00:36:06.795
<v Speaker 0>that may work.

00:36:08.315 --> 00:36:09.194
<v Speaker 0>And

00:36:09.194 --> 00:36:11.180
<v Speaker 0>we're going to should

00:36:12.220 --> 00:36:13.500
<v Speaker 0>be okay.

00:36:17.260 --> 00:36:19.099
<v Speaker 0>Yeah. So the flag that was added to

00:36:19.099 --> 00:36:22.619
<v Speaker 0>the telegraph Kubernetes plugin allows you to actually

00:36:22.619 --> 00:36:23.180
<v Speaker 0>extract

00:36:23.545 --> 00:36:24.585
<v Speaker 0>annotations

00:36:24.585 --> 00:36:27.385
<v Speaker 0>from the resources and apply them as tags

00:36:27.385 --> 00:36:28.745
<v Speaker 0>on the metrics.

00:36:29.945 --> 00:36:30.825
<v Speaker 0>We

00:36:30.825 --> 00:36:32.585
<v Speaker 0>may need that, but I can always look

00:36:32.585 --> 00:36:34.585
<v Speaker 0>it up when we do rather than

00:36:35.465 --> 00:36:38.980
<v Speaker 0>pondering it at the moment. So let's confirm.

00:36:43.380 --> 00:36:45.460
<v Speaker 0>Okay. So many queue pass

00:36:45.460 --> 00:36:46.980
<v Speaker 0>is self signed

00:36:47.380 --> 00:36:48.339
<v Speaker 0>certificate

00:36:49.859 --> 00:36:51.859
<v Speaker 0>and secure skip verify.

00:36:52.685 --> 00:36:54.365
<v Speaker 0>I don't know if this

00:36:58.205 --> 00:37:00.605
<v Speaker 0>Yeah. Let's try to find it. I think

00:37:00.605 --> 00:37:01.645
<v Speaker 0>it might be safer

00:37:02.445 --> 00:37:03.885
<v Speaker 0>and then reapply.

00:37:03.965 --> 00:37:04.125
<v Speaker 0>So

00:37:06.020 --> 00:37:07.060
<v Speaker 0>we're on one.

00:37:10.740 --> 00:37:11.860
<v Speaker 0>Get pods,

00:37:11.940 --> 00:37:13.140
<v Speaker 0>run a watch,

00:37:13.940 --> 00:37:17.380
<v Speaker 0>error. Okay. Destrangify quick go

00:37:20.105 --> 00:37:21.545
<v Speaker 0>and watch.

00:37:28.184 --> 00:37:29.625
<v Speaker 0>No. It's running. Okay.

00:37:30.825 --> 00:37:31.785
<v Speaker 0>Logs,

00:37:31.785 --> 00:37:32.424
<v Speaker 0>telegraph,

00:37:33.069 --> 00:37:33.869
<v Speaker 0>kits.

00:37:34.510 --> 00:37:37.710
<v Speaker 0>Okay. So now we've got our back hell.

00:37:39.309 --> 00:37:41.710
<v Speaker 0>Let's double check the config there.

00:37:41.869 --> 00:37:43.869
<v Speaker 0>Does it not create the RBAC

00:37:43.869 --> 00:37:44.910
<v Speaker 0>by default?

00:37:48.825 --> 00:37:49.625
<v Speaker 0>Does.

00:37:54.985 --> 00:37:55.705
<v Speaker 0>Okay.

00:37:56.505 --> 00:37:57.305
<v Speaker 0>Let's

00:37:57.385 --> 00:37:58.665
<v Speaker 0>take a look at the part.

00:38:03.770 --> 00:38:05.450
<v Speaker 0>And we want to know

00:38:05.690 --> 00:38:07.290
<v Speaker 0>the service

00:38:09.610 --> 00:38:10.490
<v Speaker 0>cat.

00:38:13.370 --> 00:38:15.850
<v Speaker 0>So it's running with telegraph kits.

00:38:17.115 --> 00:38:19.115
<v Speaker 0>Let's take a look at

00:38:19.115 --> 00:38:20.075
<v Speaker 0>service

00:38:20.235 --> 00:38:21.035
<v Speaker 0>account.

00:38:21.035 --> 00:38:23.355
<v Speaker 0>Is it a cluster or namespaced?

00:38:32.069 --> 00:38:34.470
<v Speaker 0>Sorry, it's against our always namespace. Do.

00:38:34.869 --> 00:38:37.190
<v Speaker 0>Alright. What we actually care about is the

00:38:37.190 --> 00:38:38.150
<v Speaker 0>binding.

00:38:38.470 --> 00:38:39.430
<v Speaker 0>So okay.

00:38:42.625 --> 00:38:44.385
<v Speaker 0>Is it gonna be cluster rule?

00:38:44.545 --> 00:38:45.905
<v Speaker 0>Oh, wait. Okay.

00:38:51.825 --> 00:38:53.025
<v Speaker 0>Let's just enable that.

00:38:59.620 --> 00:39:02.580
<v Speaker 0>Yes. This is our one super telegraph

00:39:02.580 --> 00:39:04.900
<v Speaker 0>cluster wave monitoring thingy.

00:39:07.060 --> 00:39:08.340
<v Speaker 0>Maybe I should just get you out of

00:39:08.340 --> 00:39:09.140
<v Speaker 0>way. There we go.

00:39:12.125 --> 00:39:13.645
<v Speaker 0>I don't know what that's gonna do. Now

00:39:13.645 --> 00:39:15.165
<v Speaker 0>that I've changed that to be Is it

00:39:15.165 --> 00:39:16.445
<v Speaker 0>gonna delete the

00:39:16.925 --> 00:39:18.684
<v Speaker 0>role binding and create the cost of role

00:39:18.684 --> 00:39:19.325
<v Speaker 0>binding?

00:39:21.565 --> 00:39:22.445
<v Speaker 0>Who knows?

00:39:22.605 --> 00:39:24.684
<v Speaker 0>Let's try role bindings.

00:39:25.630 --> 00:39:26.350
<v Speaker 0>Done.

00:39:27.070 --> 00:39:28.750
<v Speaker 0>That's the rule bindings.

00:39:30.750 --> 00:39:31.390
<v Speaker 0>Cool.

00:39:32.190 --> 00:39:33.070
<v Speaker 0>Nice job.

00:39:34.430 --> 00:39:36.910
<v Speaker 0>Nice job, Helm. Not me, obviously.

00:39:38.110 --> 00:39:39.790
<v Speaker 0>Logs. Okay. Let's see.

00:39:40.655 --> 00:39:44.335
<v Speaker 0>Alright. So we still got some permission problems.

00:39:44.335 --> 00:39:45.855
<v Speaker 0>Is that just because the pod needs re

00:39:46.095 --> 00:39:46.815
<v Speaker 0>yep.

00:39:48.015 --> 00:39:49.615
<v Speaker 0>We just need to put the pod.

00:39:49.855 --> 00:39:50.495
<v Speaker 0>So

00:39:50.734 --> 00:39:51.775
<v Speaker 0>hopefully,

00:39:51.775 --> 00:39:52.895
<v Speaker 0>we just need to put the pod.

00:39:55.589 --> 00:39:56.470
<v Speaker 0>And

00:39:57.349 --> 00:39:58.630
<v Speaker 0>k logs,

00:39:58.630 --> 00:39:59.590
<v Speaker 0>telegraph,

00:39:59.910 --> 00:40:00.870
<v Speaker 0>Kubernetes.

00:40:01.190 --> 00:40:02.230
<v Speaker 0>Okay.

00:40:03.510 --> 00:40:06.550
<v Speaker 0>So that now has a cluster role binding,

00:40:10.155 --> 00:40:13.675
<v Speaker 0>but still doesn't have the permissions.

00:40:15.115 --> 00:40:16.475
<v Speaker 0>That can be nicer.

00:40:17.515 --> 00:40:20.155
<v Speaker 0>Maybe that's me now leaning towards we should

00:40:20.155 --> 00:40:21.275
<v Speaker 0>have a

00:40:23.410 --> 00:40:24.690
<v Speaker 0>a telegraph DS

00:40:25.010 --> 00:40:27.650
<v Speaker 0>for the node based stuff and then a

00:40:27.650 --> 00:40:28.530
<v Speaker 0>telegraph

00:40:28.530 --> 00:40:29.410
<v Speaker 0>Kubernetes

00:40:29.410 --> 00:40:31.650
<v Speaker 0>for the cluster wide stuff.

00:40:32.610 --> 00:40:34.210
<v Speaker 0>Yeah. I think that would probably make a

00:40:34.210 --> 00:40:35.170
<v Speaker 0>little bit of sense.

00:40:37.235 --> 00:40:37.875
<v Speaker 0>Okay.

00:40:38.435 --> 00:40:39.315
<v Speaker 0>Let's

00:40:40.035 --> 00:40:43.155
<v Speaker 0>see what is on this cluster rule binding.

00:40:43.155 --> 00:40:45.395
<v Speaker 0>So cluster rule binding,

00:40:47.075 --> 00:40:48.915
<v Speaker 0>telegraph Kubernetes,

00:40:49.955 --> 00:40:50.755
<v Speaker 0>Yamalet.

00:40:53.630 --> 00:40:56.829
<v Speaker 0>So it is a cluster role called telegraph

00:40:56.829 --> 00:40:58.190
<v Speaker 0>k, so probably

00:40:58.190 --> 00:40:59.630
<v Speaker 0>could have guessed that.

00:41:02.270 --> 00:41:04.349
<v Speaker 0>And it has

00:41:08.805 --> 00:41:09.445
<v Speaker 0>nothing.

00:41:14.165 --> 00:41:14.885
<v Speaker 0>Okay.

00:41:16.485 --> 00:41:18.565
<v Speaker 0>So what does this comment say? Maybe that

00:41:18.565 --> 00:41:19.685
<v Speaker 0>would have been useful

00:41:20.005 --> 00:41:23.500
<v Speaker 0>when using Prometheus to input that when using

00:41:23.500 --> 00:41:26.220
<v Speaker 0>the Prometheus input to strip all the pods,

00:41:26.460 --> 00:41:28.700
<v Speaker 0>then you need to be have the permissions,

00:41:28.700 --> 00:41:29.740
<v Speaker 0>yada yada yada.

00:41:32.299 --> 00:41:34.859
<v Speaker 0>So that gives us nodes, node proxy,

00:41:34.859 --> 00:41:35.900
<v Speaker 0>node metrics,

00:41:35.900 --> 00:41:37.260
<v Speaker 0>services, endpoints, pods,

00:41:38.234 --> 00:41:39.035
<v Speaker 0>inquiries.

00:41:39.914 --> 00:41:41.434
<v Speaker 0>I mean, it looks like there's still a

00:41:41.434 --> 00:41:44.155
<v Speaker 0>few things they're missing that I would want.

00:41:46.315 --> 00:41:49.035
<v Speaker 0>So I wonder, do I have an R

00:41:49.035 --> 00:41:50.395
<v Speaker 0>back policy here

00:41:50.954 --> 00:41:52.394
<v Speaker 0>that I'm happy to steal?

00:41:56.930 --> 00:41:58.450
<v Speaker 0>Telegraph yamo,

00:41:59.730 --> 00:42:01.490
<v Speaker 0>just a demon set.

00:42:03.170 --> 00:42:04.850
<v Speaker 0>We've config.

00:42:04.850 --> 00:42:05.650
<v Speaker 0>Chris

00:42:05.810 --> 00:42:06.930
<v Speaker 0>are back in here.

00:42:07.455 --> 00:42:08.575
<v Speaker 0>Been too long.

00:42:10.255 --> 00:42:12.095
<v Speaker 0>Telugu service account,

00:42:13.055 --> 00:42:14.415
<v Speaker 0>cluster role.

00:42:15.135 --> 00:42:17.855
<v Speaker 0>That's the everything permission. That's the just do

00:42:17.855 --> 00:42:20.655
<v Speaker 0>it button. So I mean, we'll start there.

00:42:20.655 --> 00:42:21.375
<v Speaker 0>Obviously,

00:42:22.095 --> 00:42:24.630
<v Speaker 0>I'll tidy that up when I do make

00:42:24.630 --> 00:42:26.390
<v Speaker 0>a chart to make this

00:42:26.950 --> 00:42:27.830
<v Speaker 0>easy.

00:42:29.430 --> 00:42:31.670
<v Speaker 0>And if I want to apply that then

00:42:31.670 --> 00:42:33.110
<v Speaker 0>we need rules

00:42:33.589 --> 00:42:34.310
<v Speaker 0>here.

00:42:36.069 --> 00:42:37.430
<v Speaker 0>So rules.

00:42:40.115 --> 00:42:42.195
<v Speaker 0>Oh, I already had rules. Okay.

00:42:51.315 --> 00:42:51.875
<v Speaker 0>There we go.

00:42:53.390 --> 00:42:55.790
<v Speaker 0>So all API groups already sources.

00:42:56.430 --> 00:42:58.830
<v Speaker 0>I mean, doesn't definitely doesn't need that. Probably

00:42:58.830 --> 00:43:00.910
<v Speaker 0>get away with less than gap, but

00:43:01.150 --> 00:43:02.830
<v Speaker 0>in the interest of

00:43:02.830 --> 00:43:04.270
<v Speaker 0>time, let's

00:43:05.390 --> 00:43:06.350
<v Speaker 0>push the go button.

00:43:09.815 --> 00:43:12.295
<v Speaker 0>Now that we have our new super role,

00:43:13.015 --> 00:43:14.775
<v Speaker 0>I'm assuming just need to

00:43:15.735 --> 00:43:16.455
<v Speaker 0>flush that.

00:43:19.730 --> 00:43:22.130
<v Speaker 0>Let's see where we are now.

00:43:30.050 --> 00:43:30.369
<v Speaker 0>Okay.

00:43:33.905 --> 00:43:36.785
<v Speaker 0>When in doubt, forget our back exists.

00:43:38.865 --> 00:43:40.225
<v Speaker 0>Let's hit refresh here.

00:43:49.720 --> 00:43:50.920
<v Speaker 0>What do we got?

00:43:51.080 --> 00:43:51.800
<v Speaker 0>So

00:43:53.160 --> 00:43:55.320
<v Speaker 0>parts and replicas.

00:43:56.600 --> 00:43:57.640
<v Speaker 0>Interesting label.

00:43:59.255 --> 00:43:59.975
<v Speaker 0>So

00:44:00.935 --> 00:44:02.135
<v Speaker 0>it is

00:44:04.775 --> 00:44:07.415
<v Speaker 0>looking at the Kubernetes deployment measurement, filtering on

00:44:07.415 --> 00:44:08.855
<v Speaker 0>the replicas available

00:44:09.575 --> 00:44:11.655
<v Speaker 0>and then just grabbing the latest value.

00:44:14.369 --> 00:44:17.250
<v Speaker 0>So if we just run that manually,

00:44:18.050 --> 00:44:19.810
<v Speaker 0>see what we're dealing with here.

00:44:22.530 --> 00:44:25.810
<v Speaker 0>View raw data

00:44:24.905 --> 00:44:26.744
<v Speaker 0>and we can just see this reports one

00:44:26.744 --> 00:44:28.745
<v Speaker 0>available, one available, one available.

00:44:30.744 --> 00:44:32.585
<v Speaker 0>Maybe I was too quick to leave that

00:44:32.585 --> 00:44:34.265
<v Speaker 0>dashboard but I guess really what I wanna

00:44:34.265 --> 00:44:35.065
<v Speaker 0>know is

00:44:35.464 --> 00:44:37.385
<v Speaker 0>there's one available but how many do I

00:44:37.385 --> 00:44:37.704
<v Speaker 0>want?

00:44:38.340 --> 00:44:41.220
<v Speaker 0>Like, am I one available of six requested?

00:44:42.660 --> 00:44:43.380
<v Speaker 0>So

00:44:45.700 --> 00:44:48.180
<v Speaker 0>and there's there's there's none of that information

00:44:48.180 --> 00:44:50.020
<v Speaker 0>just is not there for me on the

00:44:50.020 --> 00:44:50.500
<v Speaker 0>dashboard.

00:44:51.075 --> 00:44:53.075
<v Speaker 0>So that's definitely something that I think can

00:44:53.075 --> 00:44:53.875
<v Speaker 0>be improved.

00:44:54.515 --> 00:44:55.795
<v Speaker 0>I don't I actually

00:44:56.675 --> 00:44:58.035
<v Speaker 0>it's of no interest to me how many

00:44:58.035 --> 00:44:58.835
<v Speaker 0>pods

00:44:59.555 --> 00:45:01.315
<v Speaker 0>are running in my cluster. I mean, as

00:45:01.315 --> 00:45:03.635
<v Speaker 0>that number grows, it just becomes less and

00:45:03.714 --> 00:45:05.475
<v Speaker 0>less useless useful.

00:45:05.955 --> 00:45:07.360
<v Speaker 0>And when we got when we start talking

00:45:07.360 --> 00:45:09.520
<v Speaker 0>about horizontal pod auto scaling like

00:45:09.760 --> 00:45:11.360
<v Speaker 0>nobody can look at this dashboard and go,

00:45:11.360 --> 00:45:12.880
<v Speaker 0>oh, there's 324

00:45:12.880 --> 00:45:14.880
<v Speaker 0>pods. That's exactly what I wanted. Like

00:45:16.080 --> 00:45:18.560
<v Speaker 0>so that's I think one

00:45:18.560 --> 00:45:21.280
<v Speaker 0>of the glaring things we wanna fix right

00:45:20.715 --> 00:45:23.275
<v Speaker 0>away. The pod capacity many cube obviously does

00:45:23.275 --> 00:45:25.275
<v Speaker 0>set us here. So it's a 10 per

00:45:25.275 --> 00:45:25.995
<v Speaker 0>node.

00:45:27.595 --> 00:45:28.395
<v Speaker 0>I mean,

00:45:28.875 --> 00:45:30.715
<v Speaker 0>I guess really what I wanna see there

00:45:30.715 --> 00:45:31.355
<v Speaker 0>is

00:45:31.915 --> 00:45:33.515
<v Speaker 0>how close to that am I? I guess

00:45:33.515 --> 00:45:34.715
<v Speaker 0>one to a 10.

00:45:35.190 --> 00:45:37.430
<v Speaker 0>Maybe these two could just be merged into

00:45:37.430 --> 00:45:40.230
<v Speaker 0>a single thing like how much how much

00:45:40.390 --> 00:45:42.150
<v Speaker 0>what is my window here? Where's my ceiling?

00:45:42.150 --> 00:45:44.230
<v Speaker 0>Sorry. Like when am I when am I

00:45:44.230 --> 00:45:46.390
<v Speaker 0>gonna run out of capacity? It's probably a

00:45:46.390 --> 00:45:47.830
<v Speaker 0>little bit more important to me.

00:45:48.550 --> 00:45:50.390
<v Speaker 0>We have three running what?

00:45:50.855 --> 00:45:53.095
<v Speaker 0>Pause and replicas one running pods.

00:45:54.135 --> 00:45:56.535
<v Speaker 0>Replica cabin. Okay. I just I don't think

00:45:56.535 --> 00:45:59.494
<v Speaker 0>I like any of this. And so let's

00:45:59.575 --> 00:46:01.174
<v Speaker 0>I think we'll start building our own dashboard.

00:46:04.750 --> 00:46:06.430
<v Speaker 0>I I guess it's the use case of

00:46:06.430 --> 00:46:07.870
<v Speaker 0>the of the dashboard. I don't wanna get

00:46:07.870 --> 00:46:08.110
<v Speaker 0>into

00:46:08.750 --> 00:46:10.510
<v Speaker 0>I'm I'm not a fan of dashboards. I

00:46:10.510 --> 00:46:12.750
<v Speaker 0>think dashboards are a debugging tool.

00:46:13.150 --> 00:46:15.630
<v Speaker 0>They probably shouldn't be on your wall. It's

00:46:15.630 --> 00:46:17.675
<v Speaker 0>something that you look at. What I'm getting

00:46:17.675 --> 00:46:18.635
<v Speaker 0>about this is it's

00:46:19.195 --> 00:46:21.035
<v Speaker 0>this is something you look at dashboard and

00:46:21.035 --> 00:46:23.115
<v Speaker 0>not a shit's on fire and I need

00:46:23.115 --> 00:46:24.795
<v Speaker 0>to fix this quick dashboard.

00:46:25.595 --> 00:46:26.795
<v Speaker 0>Maybe

00:46:26.795 --> 00:46:28.875
<v Speaker 0>there is definitely people that would really like

00:46:28.875 --> 00:46:29.995
<v Speaker 0>to see this information.

00:46:30.315 --> 00:46:31.675
<v Speaker 0>I just don't think I'm one of them.

00:46:34.410 --> 00:46:36.410
<v Speaker 0>Demon sets. Right. Okay. And then we've got

00:46:36.410 --> 00:46:38.090
<v Speaker 0>this repeated notes stuff.

00:46:38.650 --> 00:46:40.570
<v Speaker 0>PVC stuff is definitely

00:46:40.730 --> 00:46:42.970
<v Speaker 0>really important to monitor in Kubernetes.

00:46:44.845 --> 00:46:46.765
<v Speaker 0>Unbound stuff to me is more important. I'd

00:46:46.765 --> 00:46:48.285
<v Speaker 0>probably just wanna see a list of PVCs

00:46:48.285 --> 00:46:49.965
<v Speaker 0>aren't being used and I wanna know why

00:46:49.965 --> 00:46:51.085
<v Speaker 0>they're not being used.

00:46:51.805 --> 00:46:53.085
<v Speaker 0>And the capacity

00:46:53.405 --> 00:46:54.125
<v Speaker 0>like

00:46:55.005 --> 00:46:56.765
<v Speaker 0>how close is that to being full? Like

00:46:56.765 --> 00:46:58.605
<v Speaker 0>I I I don't have that front and

00:46:58.605 --> 00:46:58.925
<v Speaker 0>center.

00:46:59.440 --> 00:47:01.120
<v Speaker 0>That's something to me that would be really

00:47:01.120 --> 00:47:01.760
<v Speaker 0>important.

00:47:03.680 --> 00:47:06.000
<v Speaker 0>Okay. We've got work to do and

00:47:06.000 --> 00:47:08.240
<v Speaker 0>we're forty five minutes in.

00:47:08.400 --> 00:47:09.040
<v Speaker 0>Okay.

00:47:11.200 --> 00:47:12.880
<v Speaker 0>So I'm curious, I'm not even sure how

00:47:12.880 --> 00:47:14.560
<v Speaker 0>many people are on the stream

00:47:16.365 --> 00:47:18.205
<v Speaker 0>But give me your thoughts on on on

00:47:18.205 --> 00:47:19.885
<v Speaker 0>where we are, what these dashboards present to

00:47:19.885 --> 00:47:21.645
<v Speaker 0>you, what you want to see from them

00:47:21.645 --> 00:47:23.885
<v Speaker 0>and we'll and we'll put this together. We'll

00:47:23.885 --> 00:47:26.045
<v Speaker 0>we'll get a really good Kubernetes dashboard.

00:47:26.845 --> 00:47:27.405
<v Speaker 0>So

00:47:28.950 --> 00:47:31.030
<v Speaker 0>step number one for me is,

00:47:33.910 --> 00:47:35.350
<v Speaker 0>well let's create a dashboard.

00:47:38.070 --> 00:47:39.510
<v Speaker 0>What do I consider

00:47:39.589 --> 00:47:42.390
<v Speaker 0>to be a good dashboard?

00:47:43.305 --> 00:47:44.025
<v Speaker 0>So

00:47:44.185 --> 00:47:45.145
<v Speaker 0>Kubernetes.

00:47:48.025 --> 00:47:48.825
<v Speaker 0>Buyer.

00:47:50.984 --> 00:47:51.705
<v Speaker 0>Buyer.

00:47:52.425 --> 00:47:54.585
<v Speaker 0>Why didn't I Oh, why didn't I inject

00:47:54.585 --> 00:47:55.305
<v Speaker 0>buyer?

00:47:56.105 --> 00:47:58.585
<v Speaker 0>Maybe it just doesn't like put into the

00:48:03.250 --> 00:48:04.370
<v Speaker 0>give me fire.

00:48:05.330 --> 00:48:06.930
<v Speaker 0>Why is my plug in not working?

00:48:07.730 --> 00:48:08.530
<v Speaker 0>It works there.

00:48:11.225 --> 00:48:13.145
<v Speaker 0>I can't even have to copy that manually.

00:48:13.145 --> 00:48:13.625
<v Speaker 0>Alright.

00:48:15.065 --> 00:48:16.745
<v Speaker 0>Fire. I'm good. Okay.

00:48:22.265 --> 00:48:23.785
<v Speaker 0>So in order to make

00:48:24.905 --> 00:48:26.345
<v Speaker 0>right now we have a healthy cluster.

00:48:31.119 --> 00:48:33.599
<v Speaker 0>So that means I should be able

00:48:35.119 --> 00:48:36.960
<v Speaker 0>to just add a single stat

00:48:37.440 --> 00:48:39.359
<v Speaker 0>that returns the number zero

00:48:40.315 --> 00:48:44.155
<v Speaker 0>that is showing me that there's nothing that

00:48:44.715 --> 00:48:47.435
<v Speaker 0>is expected or scheduled to be running that

00:48:47.435 --> 00:48:48.635
<v Speaker 0>is in a build

00:48:49.115 --> 00:48:49.915
<v Speaker 0>state.

00:48:50.555 --> 00:48:51.595
<v Speaker 0>To me that's important.

00:48:52.810 --> 00:48:54.890
<v Speaker 0>If we run get pods all namespaces,

00:48:55.530 --> 00:48:57.370
<v Speaker 0>everything is is pretty happy.

00:48:59.050 --> 00:49:00.410
<v Speaker 0>Excuse me.

00:49:00.810 --> 00:49:01.530
<v Speaker 0>Okay.

00:49:02.650 --> 00:49:04.224
<v Speaker 0>Let's have a look at the metrics metrics

00:49:04.224 --> 00:49:06.145
<v Speaker 0>that we've got collection right now. I'm not

00:49:06.145 --> 00:49:08.145
<v Speaker 0>sure if this is gonna be complete. We

00:49:08.145 --> 00:49:10.145
<v Speaker 0>may have to add a few things,

00:49:12.385 --> 00:49:15.025
<v Speaker 0>but let's see what we get with pod

00:49:15.025 --> 00:49:15.665
<v Speaker 0>container.

00:49:18.350 --> 00:49:20.910
<v Speaker 0>State code sounds like it could be useful.

00:49:23.070 --> 00:49:25.390
<v Speaker 0>And we have a state code of zero

00:49:25.390 --> 00:49:28.110
<v Speaker 0>and that strikes me as potentially being in

00:49:28.110 --> 00:49:28.990
<v Speaker 0>enum.

00:49:30.430 --> 00:49:30.750
<v Speaker 0>So

00:49:33.025 --> 00:49:35.185
<v Speaker 0>I'm not gonna close that community template. So

00:49:35.185 --> 00:49:36.225
<v Speaker 0>I'm gonna come back to that. I wanted

00:49:36.225 --> 00:49:38.225
<v Speaker 0>to play it to learn a system template

00:49:39.345 --> 00:49:41.425
<v Speaker 0>because we still wanna understand the

00:49:41.825 --> 00:49:43.665
<v Speaker 0>VM or the bare metal underneath.

00:49:43.985 --> 00:49:45.500
<v Speaker 0>So let's

00:49:46.220 --> 00:49:48.300
<v Speaker 0>go take a look at the

00:49:48.940 --> 00:49:50.700
<v Speaker 0>curb inventory

00:49:51.900 --> 00:49:54.220
<v Speaker 0>plugin to see if there's some information

00:49:55.740 --> 00:49:58.060
<v Speaker 0>on that enum, if it's an enum.

00:50:00.325 --> 00:50:01.765
<v Speaker 0>So state

00:50:01.765 --> 00:50:02.325
<v Speaker 0>oh,

00:50:02.565 --> 00:50:04.165
<v Speaker 0>state code.

00:50:04.485 --> 00:50:05.205
<v Speaker 0>Yep.

00:50:09.045 --> 00:50:09.685
<v Speaker 0>Well,

00:50:10.005 --> 00:50:11.445
<v Speaker 0>I mean, I know it could be zero.

00:50:11.445 --> 00:50:11.845
<v Speaker 0>Thank you.

00:50:19.940 --> 00:50:20.580
<v Speaker 0>Okay.

00:50:22.660 --> 00:50:24.420
<v Speaker 0>So we're gonna add document. I wish I

00:50:24.420 --> 00:50:26.260
<v Speaker 0>had a pen and paper now. Alright. I'm

00:50:26.260 --> 00:50:28.955
<v Speaker 0>also gonna add documentation to this to describe

00:50:28.955 --> 00:50:31.355
<v Speaker 0>what those state codes are.

00:50:32.875 --> 00:50:34.395
<v Speaker 0>Really weird that they seem to do that

00:50:34.395 --> 00:50:36.235
<v Speaker 0>for PV and PVC,

00:50:38.395 --> 00:50:40.155
<v Speaker 0>just not anything else.

00:50:41.275 --> 00:50:41.675
<v Speaker 0>Okay.

00:50:43.430 --> 00:50:44.950
<v Speaker 0>So let's see

00:50:45.029 --> 00:50:47.190
<v Speaker 0>what's the best way to deal with this.

00:50:48.069 --> 00:50:50.470
<v Speaker 0>Get pods, telegraph kits

00:50:50.630 --> 00:50:53.510
<v Speaker 0>blah blah blah dash o yamo,

00:50:53.510 --> 00:50:54.710
<v Speaker 0>grab dash I.

00:50:58.065 --> 00:51:00.465
<v Speaker 0>Okay, let's get a few more lines there.

00:51:01.745 --> 00:51:03.105
<v Speaker 0>Did I do that wrong?

00:51:04.385 --> 00:51:06.305
<v Speaker 0>So where is that state code?

00:51:09.265 --> 00:51:09.985
<v Speaker 0>State test,

00:51:11.700 --> 00:51:13.300
<v Speaker 0>State running.

00:51:13.300 --> 00:51:15.140
<v Speaker 0>Okay. So zero potentially

00:51:15.140 --> 00:51:16.340
<v Speaker 0>means running.

00:51:16.980 --> 00:51:17.780
<v Speaker 0>Let's

00:51:17.780 --> 00:51:19.380
<v Speaker 0>go Kubernetes Kubernetes.

00:51:24.020 --> 00:51:25.380
<v Speaker 0>Search for running.

00:51:29.655 --> 00:51:31.095
<v Speaker 0>Maybe that was a bit of a loyal

00:51:31.095 --> 00:51:31.975
<v Speaker 0>guess.

00:51:33.415 --> 00:51:35.415
<v Speaker 0>Sometimes I forget just how big the Kubernetes

00:51:35.415 --> 00:51:36.454
<v Speaker 0>repository is.

00:51:39.960 --> 00:51:41.080
<v Speaker 0>Let's try

00:51:44.680 --> 00:51:46.600
<v Speaker 0>start to proceed code.

00:51:51.400 --> 00:51:51.800
<v Speaker 0>State.

00:52:06.305 --> 00:52:06.785
<v Speaker 0>Alright.

00:52:07.180 --> 00:52:09.020
<v Speaker 0>We'll get there. Let's take a look at

00:52:09.020 --> 00:52:10.140
<v Speaker 0>pod here.

00:52:13.100 --> 00:52:14.620
<v Speaker 0>Okay. So it's using

00:52:15.420 --> 00:52:16.940
<v Speaker 0>Kubernetes

00:52:17.020 --> 00:52:17.980
<v Speaker 0>library.

00:52:19.900 --> 00:52:21.974
<v Speaker 0>Let's go to state code.

00:52:22.454 --> 00:52:24.615
<v Speaker 0>Ah, we have it here.

00:52:26.214 --> 00:52:27.655
<v Speaker 0>Zero running,

00:52:28.535 --> 00:52:29.415
<v Speaker 0>terminated

00:52:29.815 --> 00:52:31.015
<v Speaker 0>and waiting.

00:52:33.335 --> 00:52:35.174
<v Speaker 0>Alright. So if the state code,

00:52:35.810 --> 00:52:37.330
<v Speaker 0>I mean terminated.

00:52:40.770 --> 00:52:42.770
<v Speaker 0>Yeah. Maybe there's some maybe it's useful to

00:52:42.770 --> 00:52:44.210
<v Speaker 0>know how many have been terminated in the

00:52:44.210 --> 00:52:45.170
<v Speaker 0>last window.

00:52:46.530 --> 00:52:48.050
<v Speaker 0>If that's consistently high,

00:52:48.645 --> 00:52:50.805
<v Speaker 0>would be an indicator something's going wrong.

00:52:52.245 --> 00:52:56.085
<v Speaker 0>But let's focus on, we have a pods,

00:52:56.085 --> 00:52:58.485
<v Speaker 0>duck and a waiting date.

00:52:58.885 --> 00:52:59.285
<v Speaker 0>Probably

00:53:01.400 --> 00:53:03.320
<v Speaker 0>to me that's a high priority. It's definitely

00:53:03.320 --> 00:53:05.240
<v Speaker 0>maybe a problem there if something is waiting

00:53:05.240 --> 00:53:06.280
<v Speaker 0>for too long.

00:53:06.440 --> 00:53:07.000
<v Speaker 0>So

00:53:08.360 --> 00:53:09.240
<v Speaker 0>let's

00:53:09.400 --> 00:53:11.720
<v Speaker 0>jump over here. What we wanna see, let's

00:53:11.720 --> 00:53:14.040
<v Speaker 0>jump down to the script editor and

00:53:16.695 --> 00:53:19.175
<v Speaker 0>we wanna see how many pods are waiting.

00:53:19.175 --> 00:53:21.015
<v Speaker 0>So state code two.

00:53:23.815 --> 00:53:25.095
<v Speaker 0>We're gonna filter

00:53:25.095 --> 00:53:26.855
<v Speaker 0>and we only want to see

00:53:28.615 --> 00:53:29.975
<v Speaker 0>value equals

00:53:30.135 --> 00:53:32.270
<v Speaker 0>two, which should be none right now.

00:53:32.589 --> 00:53:33.870
<v Speaker 0>We wanna count.

00:53:34.270 --> 00:53:36.190
<v Speaker 0>We wanna count of total.

00:53:36.830 --> 00:53:38.349
<v Speaker 0>And so there's something in flux you need

00:53:38.349 --> 00:53:40.510
<v Speaker 0>to do before you do something like a

00:53:40.510 --> 00:53:41.790
<v Speaker 0>count or any other

00:53:41.950 --> 00:53:44.110
<v Speaker 0>aggregate is just flatten the table structure.

00:53:44.430 --> 00:53:47.575
<v Speaker 0>In fact, let's see if we can demonstrate

00:53:47.575 --> 00:53:48.295
<v Speaker 0>that.

00:53:50.135 --> 00:53:53.335
<v Speaker 0>Yeah, okay. So here we have table zero

00:53:54.855 --> 00:53:59.015
<v Speaker 0>and the tables change whenever the series key

00:53:59.015 --> 00:53:59.575
<v Speaker 0>changes.

00:54:00.650 --> 00:54:02.970
<v Speaker 0>You can see here that's the InfluxDB

00:54:04.410 --> 00:54:07.370
<v Speaker 0>pod and this is the Kubernetes pod.

00:54:08.410 --> 00:54:10.570
<v Speaker 0>So we need to flatten the tables.

00:54:15.985 --> 00:54:18.145
<v Speaker 0>We probably only want the last value of

00:54:18.145 --> 00:54:19.265
<v Speaker 0>each two.

00:54:19.425 --> 00:54:20.945
<v Speaker 0>So let's

00:54:21.985 --> 00:54:23.345
<v Speaker 0>add the last.

00:54:23.665 --> 00:54:25.905
<v Speaker 0>We should get one entry per table.

00:54:26.305 --> 00:54:27.745
<v Speaker 0>Three tables, three pods.

00:54:29.270 --> 00:54:31.030
<v Speaker 0>Group into a single table.

00:54:32.470 --> 00:54:33.990
<v Speaker 0>And then run account.

00:54:34.790 --> 00:54:35.750
<v Speaker 0>Three.

00:54:36.710 --> 00:54:39.670
<v Speaker 0>Take off the raw data. Let's go single

00:54:39.670 --> 00:54:40.230
<v Speaker 0>stat.

00:54:41.964 --> 00:54:43.405
<v Speaker 0>And call this

00:54:43.964 --> 00:54:44.765
<v Speaker 0>waiting

00:54:45.805 --> 00:54:46.685
<v Speaker 0>pods

00:54:47.405 --> 00:54:49.405
<v Speaker 0>and update the status.

00:54:52.365 --> 00:54:55.165
<v Speaker 0>That's because we have a zero.

00:54:58.500 --> 00:54:59.540
<v Speaker 0>No data.

00:55:08.180 --> 00:55:10.020
<v Speaker 0>What do how do we show a zero?

00:55:13.095 --> 00:55:13.975
<v Speaker 0>You know, I'm not

00:55:14.695 --> 00:55:16.055
<v Speaker 0>let me think about that.

00:55:17.655 --> 00:55:19.495
<v Speaker 0>Waiting pods, no results.

00:55:19.575 --> 00:55:21.095
<v Speaker 0>I mean, I would prefer it was a

00:55:21.095 --> 00:55:22.855
<v Speaker 0>nice green zero, but for now,

00:55:23.415 --> 00:55:24.535
<v Speaker 0>let's stick with that.

00:55:27.670 --> 00:55:28.790
<v Speaker 0>Now let's

00:55:28.790 --> 00:55:30.310
<v Speaker 0>do something similar,

00:55:35.830 --> 00:55:37.270
<v Speaker 0>but I want to

00:55:39.590 --> 00:55:42.310
<v Speaker 0>graph the terminated pods over time.

00:55:53.235 --> 00:55:54.995
<v Speaker 0>And we see our job.

00:55:58.650 --> 00:55:59.210
<v Speaker 0>So

00:55:59.529 --> 00:56:00.730
<v Speaker 0>flat lane,

00:56:01.450 --> 00:56:02.250
<v Speaker 0>we

00:56:02.250 --> 00:56:02.810
<v Speaker 0>know

00:56:03.690 --> 00:56:05.849
<v Speaker 0>what that is. We know that that is

00:56:07.690 --> 00:56:09.690
<v Speaker 0>a job that's on a setup, it's finished,

00:56:09.690 --> 00:56:11.849
<v Speaker 0>it's not coming back. I'm okay with that.

00:56:12.675 --> 00:56:14.675
<v Speaker 0>Alright. We have a few comments

00:56:14.755 --> 00:56:17.075
<v Speaker 0>from Leo. So he says there are two

00:56:17.075 --> 00:56:18.355
<v Speaker 0>types of dashboards.

00:56:22.195 --> 00:56:24.915
<v Speaker 0>Contains things I would generally configure alerting for

00:56:24.915 --> 00:56:26.915
<v Speaker 0>effectively a dash that shows you how broken

00:56:26.915 --> 00:56:29.630
<v Speaker 0>things are. Yes. I like dashboards that show

00:56:29.630 --> 00:56:31.470
<v Speaker 0>me how broken things are. Definitely.

00:56:32.830 --> 00:56:35.150
<v Speaker 0>And takes them to details and helps debugging.

00:56:35.150 --> 00:56:36.910
<v Speaker 0>Yep. Couldn't agree with both of those.

00:56:37.870 --> 00:56:39.550
<v Speaker 0>So two is a higher level look.

00:56:40.795 --> 00:56:43.835
<v Speaker 0>Yep. So I I call them signals and

00:56:43.835 --> 00:56:45.035
<v Speaker 0>signal dashboards.

00:56:45.355 --> 00:56:47.515
<v Speaker 0>I still wouldn't wanna look at them though.

00:56:47.515 --> 00:56:49.515
<v Speaker 0>They would be purely for alerting.

00:56:50.715 --> 00:56:52.475
<v Speaker 0>In fact, if you have alerting rules, you

00:56:52.475 --> 00:56:55.380
<v Speaker 0>probably don't need the dashboard specifically and I

00:56:55.380 --> 00:56:57.940
<v Speaker 0>would probably lean towards only having debuggy dashboards,

00:56:57.940 --> 00:57:00.420
<v Speaker 0>ones that present information to me, correlations between

00:57:00.420 --> 00:57:02.100
<v Speaker 0>logs, metrics, etcetera.

00:57:03.780 --> 00:57:05.540
<v Speaker 0>I'll think about that a little bit more.

00:57:06.579 --> 00:57:08.099
<v Speaker 0>A common thing you had in your cluster

00:57:08.099 --> 00:57:09.984
<v Speaker 0>is running out of resources at some point

00:57:09.984 --> 00:57:11.984
<v Speaker 0>often due to no yeah. So no drawovers

00:57:11.984 --> 00:57:13.984
<v Speaker 0>obviously rather painful.

00:57:13.984 --> 00:57:16.065
<v Speaker 0>You've mentioned there isn't preemptible nodes. I'm assuming

00:57:16.065 --> 00:57:17.185
<v Speaker 0>that's a GKE,

00:57:17.345 --> 00:57:19.185
<v Speaker 0>GKE based on that language.

00:57:20.145 --> 00:57:22.705
<v Speaker 0>Yeah. I have I have run Kubernetes clusters

00:57:22.705 --> 00:57:24.464
<v Speaker 0>with preemptible nodes. It's

00:57:25.870 --> 00:57:26.590
<v Speaker 0>it's cheap,

00:57:27.470 --> 00:57:29.310
<v Speaker 0>but you definitely have to handle with a

00:57:29.310 --> 00:57:31.150
<v Speaker 0>high rotation of pod churn

00:57:31.310 --> 00:57:33.070
<v Speaker 0>as it gets rescheduled a lot.

00:57:33.550 --> 00:57:35.630
<v Speaker 0>Cron jobs and pending start, new one created

00:57:35.630 --> 00:57:38.030
<v Speaker 0>each minute, jobs never catch up and suddenly

00:57:38.030 --> 00:57:39.870
<v Speaker 0>you've got 1,500 unschedulable

00:57:39.870 --> 00:57:40.830
<v Speaker 0>pods

00:57:40.695 --> 00:57:42.935
<v Speaker 0>because we've had three jobs scheduled every minute

00:57:42.935 --> 00:57:44.295
<v Speaker 0>with three resources.

00:57:45.895 --> 00:57:48.775
<v Speaker 0>Yeah. It sounds like I understand why you're

00:57:48.775 --> 00:57:50.215
<v Speaker 0>running on preemptible nodes, but you may wanna

00:57:50.215 --> 00:57:52.615
<v Speaker 0>run multiple node pools there. You wanna affect

00:57:52.615 --> 00:57:54.295
<v Speaker 0>node capacity pool that can be hot. That

00:57:54.295 --> 00:57:55.975
<v Speaker 0>can be auto scaled when the preemptible system

00:57:55.975 --> 00:57:56.375
<v Speaker 0>there.

00:57:58.500 --> 00:58:00.980
<v Speaker 0>But it's cool. Sounds really interesting some of

00:58:00.980 --> 00:58:02.260
<v Speaker 0>the stuff you're doing. And I think our

00:58:02.260 --> 00:58:04.100
<v Speaker 0>thoughts and dashboards are pretty similar.

00:58:05.620 --> 00:58:07.540
<v Speaker 0>Alright. Let's try and get some more information

00:58:07.540 --> 00:58:08.100
<v Speaker 0>out of this.

00:58:08.895 --> 00:58:11.695
<v Speaker 0>Let's go see this fucker here. I'll

00:58:11.695 --> 00:58:13.375
<v Speaker 0>try and make my language.

00:58:14.815 --> 00:58:16.495
<v Speaker 0>So what do we wanna do? Let's let's

00:58:16.495 --> 00:58:17.615
<v Speaker 0>get some failures.

00:58:18.815 --> 00:58:20.815
<v Speaker 0>Yeah. Let's let's break some stuff. So

00:58:23.530 --> 00:58:25.850
<v Speaker 0>there was a repo shared earlier.

00:58:26.890 --> 00:58:29.210
<v Speaker 0>Iain from container solutions.

00:58:29.450 --> 00:58:31.690
<v Speaker 0>And it's just Kubernetes examples and it's supposed

00:58:31.690 --> 00:58:33.530
<v Speaker 0>to be showing like patterns of how to

00:58:33.530 --> 00:58:35.530
<v Speaker 0>deploy certain things, how to use certain features.

00:58:35.955 --> 00:58:37.635
<v Speaker 0>But what I really liked about the repository

00:58:37.635 --> 00:58:39.795
<v Speaker 0>was just all the broken things on it

00:58:39.795 --> 00:58:41.235
<v Speaker 0>so that you can actually learn how to

00:58:41.235 --> 00:58:43.315
<v Speaker 0>debug this. And I actually wanna deploy a

00:58:43.315 --> 00:58:44.995
<v Speaker 0>few of these broken things and then make

00:58:44.995 --> 00:58:47.795
<v Speaker 0>sure that we have dashboards that put that

00:58:47.795 --> 00:58:49.315
<v Speaker 0>information front and center.

00:58:51.350 --> 00:58:53.270
<v Speaker 0>We're about an hour and just now if

00:58:53.270 --> 00:58:55.590
<v Speaker 0>I'm pretty sure we're gonna be running

00:58:56.550 --> 00:58:58.310
<v Speaker 0>more than one of these sessions.

00:58:59.190 --> 00:59:01.830
<v Speaker 0>But I'll go for a little bit longer.

00:59:01.830 --> 00:59:03.670
<v Speaker 0>I can't remember if I have calls today.

00:59:05.155 --> 00:59:06.355
<v Speaker 0>Oops. If I do.

00:59:06.995 --> 00:59:07.715
<v Speaker 0>Okay.

00:59:08.035 --> 00:59:09.315
<v Speaker 0>Now I've already

00:59:10.195 --> 00:59:11.715
<v Speaker 0>cloned this repository

00:59:11.715 --> 00:59:13.395
<v Speaker 0>because I thought it was really cool.

00:59:14.115 --> 00:59:16.115
<v Speaker 0>So we're gonna go to get hub in

00:59:16.115 --> 00:59:17.395
<v Speaker 0>examples

00:59:18.035 --> 00:59:20.515
<v Speaker 0>and

00:59:18.930 --> 00:59:20.290
<v Speaker 0>let's deploy

00:59:21.650 --> 00:59:24.609
<v Speaker 0>broken in a container and then make sure

00:59:24.609 --> 00:59:25.730
<v Speaker 0>we have enough

00:59:26.849 --> 00:59:27.970
<v Speaker 0>metrics

00:59:29.010 --> 00:59:30.930
<v Speaker 0>to be able to alert on that eventually.

00:59:30.930 --> 00:59:32.315
<v Speaker 0>I don't think we're gonna get around to

00:59:32.315 --> 00:59:33.914
<v Speaker 0>alerting today but definitely if we can get

00:59:33.914 --> 00:59:35.515
<v Speaker 0>a dashboard component done,

00:59:35.755 --> 00:59:37.035
<v Speaker 0>then we have the queries to do the

00:59:37.035 --> 00:59:38.075
<v Speaker 0>alerting. So

00:59:38.954 --> 00:59:40.315
<v Speaker 0>broken in it.

00:59:42.075 --> 00:59:43.595
<v Speaker 0>And just let me throw this out here

00:59:43.595 --> 00:59:45.035
<v Speaker 0>again. I I I don't even know how

00:59:45.035 --> 00:59:46.395
<v Speaker 0>many people are watching but

00:59:47.609 --> 00:59:49.369
<v Speaker 0>if you've got any this is this, this

00:59:49.369 --> 00:59:51.930
<v Speaker 0>was to getting started to Kubernetes monitoring with

00:59:51.930 --> 00:59:52.809
<v Speaker 0>InfluxDB.

00:59:52.809 --> 00:59:54.490
<v Speaker 0>Now I think we've done a fair amount

00:59:54.490 --> 00:59:56.250
<v Speaker 0>of stuff here. We've deployed telegraph as a

00:59:56.250 --> 00:59:58.410
<v Speaker 0>daemon set. We've got another telegraph running for

00:59:58.410 --> 01:00:02.085
<v Speaker 0>some Kubernetes resources stuff. We've got InfluxDB provisioned.

01:00:02.325 --> 01:00:04.165
<v Speaker 0>We have brought in the Kubernetes

01:00:04.165 --> 01:00:06.485
<v Speaker 0>package or community template. I think we can

01:00:06.485 --> 01:00:07.765
<v Speaker 0>make a lot of improvements to that and

01:00:07.765 --> 01:00:10.245
<v Speaker 0>I think we'll have a maybe a a

01:00:10.245 --> 01:00:11.925
<v Speaker 0>two hour session where we just build out

01:00:11.925 --> 01:00:13.605
<v Speaker 0>those dashboards and all our team roles and

01:00:13.605 --> 01:00:15.125
<v Speaker 0>then contribute that back to the repository.

01:00:15.530 --> 01:00:17.770
<v Speaker 0>But if there's anything that hasn't been covered

01:00:18.010 --> 01:00:18.810
<v Speaker 0>today

01:00:18.810 --> 01:00:20.250
<v Speaker 0>that you have in your head that you're

01:00:20.329 --> 01:00:21.690
<v Speaker 0>you want to know how to do, just

01:00:21.690 --> 01:00:23.770
<v Speaker 0>drop me a message now and we'll get

01:00:23.770 --> 01:00:25.450
<v Speaker 0>to it over the next, I don't know,

01:00:25.450 --> 01:00:27.450
<v Speaker 0>fifteen, twenty minutes. See what happens.

01:00:28.685 --> 01:00:29.485
<v Speaker 0>Alright.

01:00:29.645 --> 01:00:32.285
<v Speaker 0>Let's take a look at broken containers then.

01:00:32.285 --> 01:00:32.925
<v Speaker 0>So

01:00:33.165 --> 01:00:35.165
<v Speaker 0>what have we got in this one?

01:00:37.965 --> 01:00:39.165
<v Speaker 0>So it's a straight up pod.

01:00:43.580 --> 01:00:45.740
<v Speaker 0>From a metrics point of view, I don't

01:00:45.740 --> 01:00:46.700
<v Speaker 0>want to

01:00:49.100 --> 01:00:50.300
<v Speaker 0>it would be good to be able to

01:00:50.300 --> 01:00:52.620
<v Speaker 0>highlight the fact there was a deployment

01:00:52.860 --> 01:00:54.060
<v Speaker 0>that was

01:00:54.140 --> 01:00:55.420
<v Speaker 0>missing

01:00:57.075 --> 01:00:58.595
<v Speaker 0>scheduled resources

01:00:58.915 --> 01:01:00.915
<v Speaker 0>even though the pause specifically is broken. So

01:01:00.915 --> 01:01:02.675
<v Speaker 0>I probably convert this.

01:01:05.635 --> 01:01:12.994
<v Speaker 0>And I remember how to do that deployment

01:01:10.040 --> 01:01:11.400
<v Speaker 0>apps v one

01:01:11.480 --> 01:01:12.200
<v Speaker 0>spec

01:01:12.280 --> 01:01:13.400
<v Speaker 0>template

01:01:13.640 --> 01:01:14.440
<v Speaker 0>spec.

01:01:15.880 --> 01:01:17.640
<v Speaker 0>Think that's all it should require. There'll be

01:01:17.640 --> 01:01:18.680
<v Speaker 0>selectors on there.

01:01:25.525 --> 01:01:27.365
<v Speaker 0>What am I missing?

01:01:28.405 --> 01:01:29.285
<v Speaker 0>Replicose

01:01:29.285 --> 01:01:30.245
<v Speaker 0>one.

01:01:36.405 --> 01:01:37.525
<v Speaker 0>Select her

01:01:37.685 --> 01:01:38.725
<v Speaker 0>match labels,

01:01:41.789 --> 01:01:43.790
<v Speaker 0>Which means we need labels.

01:01:43.950 --> 01:01:45.310
<v Speaker 0>Let's call this

01:01:46.109 --> 01:01:47.390
<v Speaker 0>broken app

01:01:47.869 --> 01:01:49.470
<v Speaker 0>in a container.

01:01:50.430 --> 01:01:52.990
<v Speaker 0>Which means if you want a broken app.

01:01:53.309 --> 01:01:54.845
<v Speaker 0>Oh, what's going on?

01:01:56.125 --> 01:01:57.405
<v Speaker 0>And a container.

01:01:58.125 --> 01:01:59.565
<v Speaker 0>What else am I missing?

01:02:02.525 --> 01:02:04.204
<v Speaker 0>We'll just try and apply it and see

01:02:04.204 --> 01:02:05.325
<v Speaker 0>what happens. Okay.

01:02:06.365 --> 01:02:09.325
<v Speaker 0>So this is

01:02:07.980 --> 01:02:10.780
<v Speaker 0>a, an a container busy box

01:02:13.740 --> 01:02:15.820
<v Speaker 0>that is trying to look up a host

01:02:15.820 --> 01:02:17.100
<v Speaker 0>name. It doesn't exist.

01:02:28.525 --> 01:02:30.765
<v Speaker 0>So I guess in order to fix this,

01:02:30.925 --> 01:02:32.525
<v Speaker 0>we would have to deploy

01:02:32.525 --> 01:02:33.245
<v Speaker 0>these

01:02:33.885 --> 01:02:36.970
<v Speaker 0>pods and a container service nonexistent service to

01:02:36.970 --> 01:02:38.170
<v Speaker 0>the namespace

01:02:38.890 --> 01:02:41.210
<v Speaker 0>which would satisfy it from being broken.

01:02:42.250 --> 01:02:44.810
<v Speaker 0>Although I'm not particularly interested in fixing it

01:02:44.810 --> 01:02:45.450
<v Speaker 0>so

01:02:46.970 --> 01:02:49.690
<v Speaker 0>no resource limits. Yes. Versus code. I don't

01:02:49.690 --> 01:02:50.170
<v Speaker 0>care.

01:02:51.915 --> 01:02:52.795
<v Speaker 0>Shush.

01:02:55.435 --> 01:02:57.675
<v Speaker 0>After joining, sleep, sleep, sleep.

01:02:57.995 --> 01:02:59.035
<v Speaker 0>That's what?

01:03:01.195 --> 01:03:02.075
<v Speaker 0>An hour?

01:03:02.875 --> 01:03:05.320
<v Speaker 0>Yeah. Math is the very much strong point.

01:03:06.760 --> 01:03:08.360
<v Speaker 0>Okay. Let's deploy it.

01:03:10.200 --> 01:03:12.680
<v Speaker 0>We'll just spin open. I've had just gonna

01:03:12.680 --> 01:03:14.920
<v Speaker 0>spin up on my location.

01:03:14.920 --> 01:03:15.400
<v Speaker 0>Yeah. Okay.

01:03:16.255 --> 01:03:17.775
<v Speaker 0>Let's apply it from here.

01:03:18.575 --> 01:03:19.935
<v Speaker 0>Apply dash f.

01:03:20.575 --> 01:03:21.295
<v Speaker 0>Go.

01:03:23.455 --> 01:03:26.095
<v Speaker 0>Selector does not match template labels.

01:03:28.390 --> 01:03:30.870
<v Speaker 0>I only I only labeled this.

01:03:33.030 --> 01:03:34.950
<v Speaker 0>So we need

01:03:34.950 --> 01:03:36.150
<v Speaker 0>labels.

01:03:40.070 --> 01:03:41.190
<v Speaker 0>What template

01:03:41.830 --> 01:03:43.715
<v Speaker 0>spec label? No.

01:03:45.795 --> 01:03:46.595
<v Speaker 0>Oh,

01:03:46.995 --> 01:03:48.035
<v Speaker 0>there we go.

01:03:52.035 --> 01:03:52.835
<v Speaker 0>Try again.

01:03:53.075 --> 01:03:55.155
<v Speaker 0>Wait. Okay. So

01:03:57.760 --> 01:03:59.359
<v Speaker 0>if that's gonna stick

01:04:00.480 --> 01:04:02.400
<v Speaker 0>and and at zero one

01:04:05.200 --> 01:04:06.880
<v Speaker 0>until it has crashing

01:04:06.880 --> 01:04:09.119
<v Speaker 0>state. So can

01:04:09.119 --> 01:04:10.160
<v Speaker 0>we

01:04:12.615 --> 01:04:15.095
<v Speaker 0>see that from this dashboard?

01:04:19.335 --> 01:04:20.695
<v Speaker 0>My thoughts are no.

01:04:24.535 --> 01:04:26.215
<v Speaker 0>Can we see this

01:04:27.060 --> 01:04:28.980
<v Speaker 0>by just exploring

01:04:29.940 --> 01:04:31.060
<v Speaker 0>our metrics?

01:04:31.940 --> 01:04:33.620
<v Speaker 0>So we have a deployment.

01:04:35.140 --> 01:04:36.740
<v Speaker 0>Replicates unavailable.

01:04:36.900 --> 01:04:39.060
<v Speaker 0>Let's just break this down to five minutes.

01:04:40.925 --> 01:04:42.685
<v Speaker 0>So it's not unavailable yet.

01:04:42.685 --> 01:04:45.485
<v Speaker 0>Oh no, wait. It is. Cool.

01:04:50.205 --> 01:04:51.405
<v Speaker 0>Just a very

01:04:52.500 --> 01:04:55.620
<v Speaker 0>large graph for two very small values.

01:04:58.260 --> 01:05:00.100
<v Speaker 0>Set a max on this.

01:05:02.420 --> 01:05:04.500
<v Speaker 0>If one remembers how to do that.

01:05:06.935 --> 01:05:08.855
<v Speaker 0>No. I don't wanna say inquiry.

01:05:12.775 --> 01:05:16.135
<v Speaker 0>So I set a max. Wait. What?

01:05:17.575 --> 01:05:17.975
<v Speaker 0>Auto.

01:05:21.540 --> 01:05:23.780
<v Speaker 0>Alright. Okay. I don't know what I changed

01:05:23.780 --> 01:05:24.420
<v Speaker 0>but

01:05:25.060 --> 01:05:26.740
<v Speaker 0>Okay. So now we can see this purple

01:05:26.740 --> 01:05:29.220
<v Speaker 0>line. We do have something unavailable. So we

01:05:29.220 --> 01:05:29.380
<v Speaker 0>do

01:05:30.900 --> 01:05:32.340
<v Speaker 0>we have a way to

01:05:33.005 --> 01:05:35.005
<v Speaker 0>stick something on a dashboard that says

01:05:35.485 --> 01:05:37.645
<v Speaker 0>there's stuff that you need to fix right

01:05:37.645 --> 01:05:38.205
<v Speaker 0>now.

01:05:40.445 --> 01:05:42.765
<v Speaker 0>So best way to visualise this.

01:05:45.965 --> 01:05:47.725
<v Speaker 0>Probably just a single step for now.

01:05:49.140 --> 01:05:50.740
<v Speaker 0>And what we wanna do

01:05:54.660 --> 01:05:55.460
<v Speaker 0>is

01:05:55.460 --> 01:05:56.740
<v Speaker 0>filter

01:06:01.299 --> 01:06:02.500
<v Speaker 0>on the value again.

01:06:03.825 --> 01:06:05.905
<v Speaker 0>And if it's larger than zero,

01:06:07.265 --> 01:06:08.785
<v Speaker 0>let's just take a look at the raw

01:06:08.785 --> 01:06:09.425
<v Speaker 0>data.

01:06:10.705 --> 01:06:13.585
<v Speaker 0>Then we get a table per deployment.

01:06:14.465 --> 01:06:15.345
<v Speaker 0>We

01:06:15.345 --> 01:06:16.625
<v Speaker 0>only

01:06:17.750 --> 01:06:19.750
<v Speaker 0>care about the last value for now. Now

01:06:19.750 --> 01:06:21.270
<v Speaker 0>I don't think that's ideal.

01:06:24.950 --> 01:06:26.150
<v Speaker 0>Probably

01:06:26.150 --> 01:06:27.030
<v Speaker 0>better

01:06:28.550 --> 01:06:29.670
<v Speaker 0>if

01:06:33.430 --> 01:06:34.925
<v Speaker 0>I see how much that value has changed

01:06:34.925 --> 01:06:36.045
<v Speaker 0>over the last

01:06:38.525 --> 01:06:40.125
<v Speaker 0>five minutes.

01:06:42.285 --> 01:06:44.285
<v Speaker 0>But we'll we'll graph that next. Right now,

01:06:44.285 --> 01:06:46.870
<v Speaker 0>just want this one cell that says hey,

01:06:46.870 --> 01:06:49.430
<v Speaker 0>something doesn't something isn't working

01:06:49.750 --> 01:06:51.910
<v Speaker 0>and then if we put a graph next

01:06:51.910 --> 01:06:53.910
<v Speaker 0>to that then we wanna be able to

01:06:53.910 --> 01:06:56.710
<v Speaker 0>see whether the number of unavailable replicas is

01:06:56.710 --> 01:06:57.430
<v Speaker 0>rising,

01:06:57.670 --> 01:06:58.710
<v Speaker 0>staying steady

01:06:59.110 --> 01:07:00.150
<v Speaker 0>or decreasing.

01:07:00.744 --> 01:07:02.665
<v Speaker 0>Because it could be that this thing is

01:07:02.665 --> 01:07:04.665
<v Speaker 0>fixing itself and we just need to be

01:07:04.665 --> 01:07:06.025
<v Speaker 0>a little bit more patient. We should see

01:07:06.025 --> 01:07:07.945
<v Speaker 0>the graph coming down as it goes from

01:07:08.345 --> 01:07:10.745
<v Speaker 0>five unavailable replicas down to zero.

01:07:10.905 --> 01:07:13.785
<v Speaker 0>If it's stagnant at one, three, four, five,

01:07:13.785 --> 01:07:15.640
<v Speaker 0>whatever, then we know there's a consistent problem

01:07:15.640 --> 01:07:17.320
<v Speaker 0>and if it's rising, then, you know, we

01:07:17.320 --> 01:07:19.640
<v Speaker 0>have probably have a cascading problem and those

01:07:19.640 --> 01:07:22.200
<v Speaker 0>are very different situations and scenarios where you

01:07:22.200 --> 01:07:23.880
<v Speaker 0>probably wanna adjust the way that you're gonna

01:07:23.880 --> 01:07:24.920
<v Speaker 0>try and fix that.

01:07:26.120 --> 01:07:27.720
<v Speaker 0>Okay. So if we put the last value

01:07:27.720 --> 01:07:28.680
<v Speaker 0>per table

01:07:28.760 --> 01:07:30.805
<v Speaker 0>and we then wanna flatten it and we

01:07:30.805 --> 01:07:32.805
<v Speaker 0>won't wanna just do a global count.

01:07:38.885 --> 01:07:39.765
<v Speaker 0>Okay.

01:07:40.485 --> 01:07:42.405
<v Speaker 0>Probably better to do a sum here actually.

01:07:42.789 --> 01:07:44.470
<v Speaker 0>So I'm gonna deploy more of these broken

01:07:44.470 --> 01:07:46.230
<v Speaker 0>things. We don't wanna count that there's two

01:07:46.230 --> 01:07:48.390
<v Speaker 0>broken deployments. I actually wanna see how many

01:07:48.390 --> 01:07:49.190
<v Speaker 0>pods

01:07:50.630 --> 01:07:52.950
<v Speaker 0>aren't working. And actually maybe there's maybe there's

01:07:52.950 --> 01:07:54.950
<v Speaker 0>value in seeing both of those. So maybe

01:07:54.950 --> 01:07:56.390
<v Speaker 0>we'll duplicate the cell as well.

01:07:57.645 --> 01:07:58.285
<v Speaker 0>So

01:07:58.925 --> 01:08:00.525
<v Speaker 0>come back to you. We have a dashboard.

01:08:00.525 --> 01:08:02.365
<v Speaker 0>Let's save this to our we have a

01:08:02.365 --> 01:08:04.045
<v Speaker 0>sale. Let's save this to our new dashboard.

01:08:04.045 --> 01:08:05.325
<v Speaker 0>Kubernetes fire.

01:08:05.725 --> 01:08:07.165
<v Speaker 0>We're gonna call this

01:08:09.005 --> 01:08:10.685
<v Speaker 0>so deployment

01:08:10.845 --> 01:08:11.965
<v Speaker 0>replicas

01:08:12.630 --> 01:08:13.830
<v Speaker 0>unavailable.

01:08:23.270 --> 01:08:24.149
<v Speaker 0>Yes, computer.

01:08:32.145 --> 01:08:33.425
<v Speaker 0>I'm on computer.

01:08:38.625 --> 01:08:39.825
<v Speaker 0>I don't know if I should just be

01:08:39.825 --> 01:08:41.345
<v Speaker 0>really like

01:08:42.079 --> 01:08:43.760
<v Speaker 0>not very patient and just

01:08:44.880 --> 01:08:45.999
<v Speaker 0>go away.

01:08:49.199 --> 01:08:50.479
<v Speaker 0>It doesn't even take me to the right

01:08:50.479 --> 01:08:51.199
<v Speaker 0>dashboard.

01:08:52.000 --> 01:08:53.119
<v Speaker 0>Right.

01:08:53.119 --> 01:08:55.519
<v Speaker 0>Okay. Deployment records unavailable. I'm going to clone

01:08:55.519 --> 01:08:55.760
<v Speaker 0>this.

01:08:56.915 --> 01:08:59.635
<v Speaker 0>I also wanna see across how many deployments

01:08:59.635 --> 01:09:00.755
<v Speaker 0>are affected.

01:09:00.835 --> 01:09:01.474
<v Speaker 0>So

01:09:02.835 --> 01:09:03.635
<v Speaker 0>deployments

01:09:06.755 --> 01:09:07.554
<v Speaker 0>affected.

01:09:08.194 --> 01:09:10.675
<v Speaker 0>What we're gonna do is to count instead

01:09:10.675 --> 01:09:11.635
<v Speaker 0>of the sum.

01:09:12.114 --> 01:09:13.609
<v Speaker 0>So while these numbers are the same just

01:09:13.609 --> 01:09:14.250
<v Speaker 0>now,

01:09:15.050 --> 01:09:17.450
<v Speaker 0>they wouldn't, they wouldn't always necessarily be the

01:09:17.450 --> 01:09:18.010
<v Speaker 0>same.

01:09:18.490 --> 01:09:19.050
<v Speaker 0>So

01:09:19.689 --> 01:09:20.489
<v Speaker 0>let's

01:09:23.450 --> 01:09:24.890
<v Speaker 0>let's try and do it like this.

01:09:27.274 --> 01:09:28.394
<v Speaker 0>And because

01:09:30.554 --> 01:09:32.154
<v Speaker 0>I don't like that being blurred because this

01:09:32.154 --> 01:09:32.954
<v Speaker 0>is bad.

01:09:33.515 --> 01:09:35.194
<v Speaker 0>We'll add some thresholds here. So if the

01:09:35.194 --> 01:09:36.715
<v Speaker 0>value is greater than zero,

01:09:37.274 --> 01:09:39.034
<v Speaker 0>I mean, it's just gotta be red.

01:09:44.219 --> 01:09:47.340
<v Speaker 0>Deployments affected seem like I mean, I guess,

01:09:48.859 --> 01:09:50.219
<v Speaker 0>greater than zero

01:09:51.340 --> 01:09:51.899
<v Speaker 0>red

01:09:52.380 --> 01:09:54.460
<v Speaker 0>and we'll have

01:09:53.915 --> 01:09:55.355
<v Speaker 0>green of it zero.

01:09:58.795 --> 01:10:01.035
<v Speaker 0>Let's change both of these green. Where's the

01:10:01.035 --> 01:10:03.675
<v Speaker 0>honeydew I used? I think so. Okay.

01:10:04.715 --> 01:10:06.900
<v Speaker 0>So something's broken. We know that.

01:10:07.620 --> 01:10:09.139
<v Speaker 0>What do we wanna see now?

01:10:16.820 --> 01:10:18.900
<v Speaker 0>So we can see how long it's been

01:10:18.900 --> 01:10:19.380
<v Speaker 0>broken.

01:10:19.905 --> 01:10:22.225
<v Speaker 0>Oh, wait. That's a waiting. Yeah. That's a

01:10:22.225 --> 01:10:23.425
<v Speaker 0>terminated path.

01:10:26.705 --> 01:10:27.824
<v Speaker 0>Yeah. Okay.

01:10:29.425 --> 01:10:31.185
<v Speaker 0>I can't even remember what we're doing there.

01:10:31.185 --> 01:10:32.145
<v Speaker 0>I'm gonna ignore that.

01:10:35.500 --> 01:10:36.780
<v Speaker 0>I can't ignore it.

01:10:38.219 --> 01:10:39.420
<v Speaker 0>State two.

01:10:44.860 --> 01:10:47.260
<v Speaker 0>If I just not change the number here.

01:10:47.500 --> 01:10:48.300
<v Speaker 0>Yeah.

01:10:48.619 --> 01:10:49.260
<v Speaker 0>There we go.

01:10:52.864 --> 01:10:54.945
<v Speaker 0>Okay. Now we can see it better. Okay.

01:10:54.945 --> 01:10:55.585
<v Speaker 0>So now we know

01:10:56.304 --> 01:10:57.184
<v Speaker 0>let's

01:10:57.985 --> 01:10:59.744
<v Speaker 0>ramp this up a little bit. So

01:11:00.465 --> 01:11:02.465
<v Speaker 0>I just wanna make sure we can visualize

01:11:02.465 --> 01:11:05.505
<v Speaker 0>this from the right perspective

01:11:04.960 --> 01:11:07.280
<v Speaker 0>because this is such a contrived scenario right

01:11:07.280 --> 01:11:07.840
<v Speaker 0>now.

01:11:08.320 --> 01:11:10.640
<v Speaker 0>We wanna say scale this up to three

01:11:10.640 --> 01:11:13.440
<v Speaker 0>and I'm just gonna copy and paste this.

01:11:14.480 --> 01:11:16.239
<v Speaker 0>And I'm going to do

01:11:17.760 --> 01:11:18.720
<v Speaker 0>what a two here.

01:11:20.034 --> 01:11:22.994
<v Speaker 0>We'll call this two two two

01:11:23.235 --> 01:11:23.715
<v Speaker 0>two.

01:11:25.395 --> 01:11:27.554
<v Speaker 0>We're gonna apply that fail.

01:11:28.275 --> 01:11:30.354
<v Speaker 0>It gives me two broken deployments.

01:11:31.554 --> 01:11:33.155
<v Speaker 0>I can't remember how many pods I said.

01:11:33.155 --> 01:11:34.994
<v Speaker 0>I think it was five broken pods.

01:11:36.090 --> 01:11:37.929
<v Speaker 0>Let's just turn on this as a five

01:11:37.929 --> 01:11:40.250
<v Speaker 0>second refresh. Hopefully

01:11:40.250 --> 01:11:42.010
<v Speaker 0>within the next five seconds.

01:11:43.850 --> 01:11:46.889
<v Speaker 0>See see something happen as we, you know,

01:11:46.889 --> 01:11:48.810
<v Speaker 0>we're trying to improve our our visibility and

01:11:48.810 --> 01:11:49.850
<v Speaker 0>observability here. Good.

01:11:50.704 --> 01:11:52.385
<v Speaker 0>So five pods

01:11:52.465 --> 01:11:53.505
<v Speaker 0>need action

01:11:53.505 --> 01:11:55.105
<v Speaker 0>to effective deployments

01:11:55.105 --> 01:11:57.504
<v Speaker 0>and five pods unavailable.

01:11:58.145 --> 01:11:58.704
<v Speaker 0>And

01:11:59.585 --> 01:12:01.905
<v Speaker 0>we're not getting anything here.

01:12:06.590 --> 01:12:08.110
<v Speaker 0>Two two two two two.

01:12:08.750 --> 01:12:09.550
<v Speaker 0>So

01:12:09.710 --> 01:12:11.469
<v Speaker 0>the problem layer,

01:12:11.550 --> 01:12:13.469
<v Speaker 0>if we view the raw data,

01:12:14.190 --> 01:12:16.905
<v Speaker 0>this table zero gives us a two to

01:12:16.905 --> 01:12:17.544
<v Speaker 0>two.

01:12:19.065 --> 01:12:20.985
<v Speaker 0>And the value is just a status code.

01:12:20.985 --> 01:12:23.385
<v Speaker 0>Alright. So that's a problem. We actually wanna

01:12:23.385 --> 01:12:24.824
<v Speaker 0>know how many

01:12:27.704 --> 01:12:30.680
<v Speaker 0>pause are to it. So pull in the

01:12:30.680 --> 01:12:31.720
<v Speaker 0>last value,

01:12:31.960 --> 01:12:33.800
<v Speaker 0>let's do a group and

01:12:34.840 --> 01:12:36.200
<v Speaker 0>I don't know if we want a summary

01:12:36.200 --> 01:12:37.480
<v Speaker 0>account just yet.

01:12:37.640 --> 01:12:39.080
<v Speaker 0>10 seems wrong.

01:12:39.560 --> 01:12:40.520
<v Speaker 0>Five seems good.

01:12:42.145 --> 01:12:44.465
<v Speaker 0>Yeah. Some would be a count of the

01:12:44.864 --> 01:12:48.065
<v Speaker 0>summon up to five to the status codes.

01:12:48.145 --> 01:12:49.104
<v Speaker 0>I don't want that.

01:12:51.505 --> 01:12:53.585
<v Speaker 0>Because I'm doing the last, we're not actually

01:12:53.585 --> 01:12:55.970
<v Speaker 0>graphing this data anymore. So actually what we

01:12:55.970 --> 01:12:57.650
<v Speaker 0>want is an aggregate window.

01:13:03.250 --> 01:13:05.490
<v Speaker 0>So what we want is here.

01:13:07.305 --> 01:13:09.945
<v Speaker 0>So do I could go window with a

01:13:09.945 --> 01:13:10.745
<v Speaker 0>count

01:13:12.505 --> 01:13:13.465
<v Speaker 0>over

01:13:14.585 --> 01:13:15.785
<v Speaker 0>period.

01:13:20.745 --> 01:13:22.745
<v Speaker 0>Zero zero zero

01:13:24.559 --> 01:13:25.439
<v Speaker 0>five.

01:13:30.559 --> 01:13:32.320
<v Speaker 0>Let's take a look at five minutes.

01:13:34.239 --> 01:13:35.520
<v Speaker 0>What have I done wrong here?

01:13:40.125 --> 01:13:41.965
<v Speaker 0>Okay. Let's take a look at the

01:13:42.364 --> 01:13:43.565
<v Speaker 0>data again.

01:13:45.485 --> 01:13:47.405
<v Speaker 0>Oh, we've got states to states to states

01:13:47.405 --> 01:13:48.525
<v Speaker 0>to like that.

01:13:49.485 --> 01:13:50.364
<v Speaker 0>That makes sense.

01:14:00.760 --> 01:14:01.640
<v Speaker 0>Should be,

01:14:07.755 --> 01:14:10.315
<v Speaker 0>Let's bring in the last again and we've

01:14:10.315 --> 01:14:11.994
<v Speaker 0>got five tables.

01:14:14.395 --> 01:14:15.034
<v Speaker 0>And

01:14:16.875 --> 01:14:19.675
<v Speaker 0>these are all the pods that are currently

01:14:19.675 --> 01:14:20.155
<v Speaker 0>broken.

01:14:21.120 --> 01:14:23.040
<v Speaker 0>So I can't aggregate when I'm Oh, because

01:14:23.040 --> 01:14:25.200
<v Speaker 0>I'm doing the last. Of course.

01:14:27.360 --> 01:14:28.160
<v Speaker 0>So

01:14:29.840 --> 01:14:31.520
<v Speaker 0>if you just flatten that group and do

01:14:31.520 --> 01:14:33.280
<v Speaker 0>an aggregate window with account.

01:14:35.040 --> 01:14:36.400
<v Speaker 0>Yep. That's what we want.

01:14:38.555 --> 01:14:39.275
<v Speaker 0>Oh.

01:14:41.995 --> 01:14:44.235
<v Speaker 0>Why have I not got tame

01:14:45.515 --> 01:14:47.115
<v Speaker 0>on my x axis?

01:14:49.990 --> 01:14:50.710
<v Speaker 0>Okay.

01:14:52.230 --> 01:14:54.150
<v Speaker 0>Yeah. So that's the one broken pod that

01:14:54.150 --> 01:14:56.710
<v Speaker 0>we had. We created this broken pod here

01:14:56.870 --> 01:14:59.110
<v Speaker 0>and we then spun that up to five.

01:15:00.630 --> 01:15:02.470
<v Speaker 0>I'm not sure why

01:15:03.095 --> 01:15:03.815
<v Speaker 0>I will

01:15:04.375 --> 01:15:06.535
<v Speaker 0>why it's magically fixed itself.

01:15:08.055 --> 01:15:10.455
<v Speaker 0>It has not magically fixed itself.

01:15:11.175 --> 01:15:13.575
<v Speaker 0>It's not five containers.

01:15:14.855 --> 01:15:16.935
<v Speaker 0>Maybe that's just a bug because this window

01:15:16.935 --> 01:15:18.375
<v Speaker 0>is a part window at the moment.

01:15:25.700 --> 01:15:27.060
<v Speaker 0>Try refreshing.

01:15:28.820 --> 01:15:29.780
<v Speaker 0>Okay.

01:15:29.780 --> 01:15:32.260
<v Speaker 0>Yeah. It's definitely drawing on new values up

01:15:32.260 --> 01:15:34.625
<v Speaker 0>here. I don't know why it decides that

01:15:34.625 --> 01:15:36.385
<v Speaker 0>part window should be written

01:15:36.945 --> 01:15:37.824
<v Speaker 0>down there.

01:15:39.345 --> 01:15:40.784
<v Speaker 0>Can look into that later.

01:15:41.745 --> 01:15:43.505
<v Speaker 0>Alright. So now we have a dashboard that

01:15:43.505 --> 01:15:45.905
<v Speaker 0>has a bit more useful information.

01:15:46.305 --> 01:15:47.425
<v Speaker 0>If I broken pods,

01:15:48.150 --> 01:15:50.550
<v Speaker 0>We can see its effects in two deployments

01:15:50.550 --> 01:15:52.390
<v Speaker 0>but what we don't

01:15:52.390 --> 01:15:54.150
<v Speaker 0>have an understanding of is just

01:15:54.550 --> 01:15:55.750
<v Speaker 0>is just why.

01:15:58.710 --> 01:15:59.190
<v Speaker 0>Cool.

01:16:03.784 --> 01:16:04.584
<v Speaker 0>So

01:16:06.264 --> 01:16:08.905
<v Speaker 0>my next steps here would be I want

01:16:08.905 --> 01:16:09.624
<v Speaker 0>to

01:16:11.545 --> 01:16:13.144
<v Speaker 0>somehow display

01:16:14.185 --> 01:16:16.585
<v Speaker 0>if we do get pods.

01:16:18.180 --> 01:16:20.340
<v Speaker 0>Put out one of these broken ones.

01:16:24.580 --> 01:16:26.260
<v Speaker 0>And we have events.

01:16:26.740 --> 01:16:28.820
<v Speaker 0>Maybe I need to run describe

01:16:30.975 --> 01:16:33.135
<v Speaker 0>Describe pod broken

01:16:34.175 --> 01:16:35.135
<v Speaker 0>five

01:16:35.775 --> 01:16:36.335
<v Speaker 0>seven.

01:16:44.910 --> 01:16:47.710
<v Speaker 0>So we're just gonna need logs, aren't we?

01:16:48.830 --> 01:16:50.429
<v Speaker 0>Started container.

01:16:51.630 --> 01:16:53.070
<v Speaker 0>I was hoping there would be a little

01:16:53.070 --> 01:16:54.350
<v Speaker 0>bit more information

01:16:54.350 --> 01:16:54.670
<v Speaker 0>there.

01:17:01.915 --> 01:17:03.915
<v Speaker 0>Let's look at the gap again.

01:17:04.795 --> 01:17:06.395
<v Speaker 0>Because if there's anything I can pull out,

01:17:06.395 --> 01:17:07.755
<v Speaker 0>I'm gonna display it.

01:17:08.315 --> 01:17:08.955
<v Speaker 0>State

01:17:09.195 --> 01:17:09.994
<v Speaker 0>reason.

01:17:10.795 --> 01:17:12.715
<v Speaker 0>Okay. So we want do we have that

01:17:12.715 --> 01:17:15.130
<v Speaker 0>data first? If not, we need to change

01:17:15.130 --> 01:17:16.169
<v Speaker 0>it so we do.

01:17:16.650 --> 01:17:18.570
<v Speaker 0>So I'm gonna come back into explore.

01:17:19.210 --> 01:17:21.449
<v Speaker 0>Let's go back down to this pod

01:17:22.489 --> 01:17:23.369
<v Speaker 0>container.

01:17:25.610 --> 01:17:28.250
<v Speaker 0>We have terminated reason. We don't state reason.

01:17:39.535 --> 01:17:40.255
<v Speaker 0>Complete.

01:17:48.070 --> 01:17:51.190
<v Speaker 0>Alright. So that's a challenge. I really want

01:17:54.150 --> 01:17:55.030
<v Speaker 0>this string.

01:17:58.824 --> 01:18:00.025
<v Speaker 0>I want it.

01:18:01.945 --> 01:18:04.265
<v Speaker 0>This is handy too. It tells me that

01:18:04.265 --> 01:18:06.664
<v Speaker 0>I have a problem in a container. So

01:18:07.065 --> 01:18:08.344
<v Speaker 0>pod initializing

01:18:08.585 --> 01:18:09.705
<v Speaker 0>gets me on the right path.

01:18:10.739 --> 01:18:12.659
<v Speaker 0>This is definitely very useful.

01:18:15.300 --> 01:18:16.659
<v Speaker 0>So it may be that we need to

01:18:16.659 --> 01:18:19.780
<v Speaker 0>start making a few tweaks to the telegraph

01:18:19.860 --> 01:18:20.739
<v Speaker 0>plugin.

01:18:21.300 --> 01:18:21.699
<v Speaker 0>So

01:18:25.765 --> 01:18:27.605
<v Speaker 0>yeah, we don't want the terminated reason. There

01:18:27.605 --> 01:18:29.285
<v Speaker 0>must be something else here we can get

01:18:29.285 --> 01:18:30.165
<v Speaker 0>access to.

01:18:35.525 --> 01:18:37.445
<v Speaker 0>Yeah. And I thought that's really being logged

01:18:37.445 --> 01:18:38.885
<v Speaker 0>right now. So I think

01:18:40.280 --> 01:18:41.559
<v Speaker 0>in the next session,

01:18:41.960 --> 01:18:44.760
<v Speaker 0>we'll maybe try and improve this gather pod

01:18:44.760 --> 01:18:46.280
<v Speaker 0>container stuff.

01:18:47.960 --> 01:18:49.719
<v Speaker 0>Alright. Let's try and

01:18:49.720 --> 01:18:52.760
<v Speaker 0>finish today's stream with something useful. Let's take

01:18:52.760 --> 01:18:54.795
<v Speaker 0>a look at these community templates. So I'm

01:18:54.795 --> 01:18:56.635
<v Speaker 0>gonna save all of this stuff.

01:18:57.515 --> 01:18:58.635
<v Speaker 0>I'm gonna

01:18:59.435 --> 01:19:02.395
<v Speaker 0>obviously persist this. I'll store it on my

01:19:02.395 --> 01:19:03.835
<v Speaker 0>GitLab repository.

01:19:03.915 --> 01:19:05.675
<v Speaker 0>I'm gonna do this specific

01:19:05.675 --> 01:19:07.195
<v Speaker 0>Kubernetes stream

01:19:07.990 --> 01:19:08.950
<v Speaker 0>probably

01:19:08.950 --> 01:19:11.430
<v Speaker 0>twice a week and we're just gonna keep

01:19:11.430 --> 01:19:14.230
<v Speaker 0>improving the situation here and working on these

01:19:14.230 --> 01:19:15.990
<v Speaker 0>dashboards. I think the next thing I wanna

01:19:15.990 --> 01:19:18.150
<v Speaker 0>do is get that extra information from the

01:19:18.150 --> 01:19:19.270
<v Speaker 0>pod. I really

01:19:19.510 --> 01:19:20.310
<v Speaker 0>I

01:19:20.390 --> 01:19:23.455
<v Speaker 0>I really wanna see this somewhere in my

01:19:23.455 --> 01:19:24.815
<v Speaker 0>my event log.

01:19:27.375 --> 01:19:28.975
<v Speaker 0>In fact, I think most of that is

01:19:28.975 --> 01:19:31.215
<v Speaker 0>is useful. So I just wanna see this

01:19:31.215 --> 01:19:32.895
<v Speaker 0>and I wanna make sure that we're getting

01:19:32.895 --> 01:19:34.655
<v Speaker 0>this reason, the state reason

01:19:35.030 --> 01:19:37.510
<v Speaker 0>available as well so that we can have

01:19:37.510 --> 01:19:40.630
<v Speaker 0>a little table here that actually filters

01:19:40.630 --> 01:19:43.510
<v Speaker 0>the state reasons on the broken pods.

01:19:43.590 --> 01:19:45.670
<v Speaker 0>Because when I'm debugging this situation, I see,

01:19:45.670 --> 01:19:47.430
<v Speaker 0>oh shit, I've got two broken deployments that's

01:19:47.430 --> 01:19:48.390
<v Speaker 0>affecting five pods.

01:19:48.875 --> 01:19:50.635
<v Speaker 0>It's been like this for a while. I'm

01:19:50.635 --> 01:19:51.675
<v Speaker 0>gonna fix itself.

01:19:51.995 --> 01:19:53.435
<v Speaker 0>And I I wanna get as much information

01:19:53.435 --> 01:19:54.715
<v Speaker 0>as I can front of the center here

01:19:54.715 --> 01:19:55.915
<v Speaker 0>so I know how to go fix that.

01:19:55.915 --> 01:19:57.675
<v Speaker 0>And then I can just say, oh, well,

01:19:58.075 --> 01:20:00.395
<v Speaker 0>a developer's pushed a broken AI container that's

01:20:00.395 --> 01:20:03.035
<v Speaker 0>never gonna satisfy. So that that's next.

01:20:04.790 --> 01:20:05.590
<v Speaker 0>Today,

01:20:05.990 --> 01:20:09.270
<v Speaker 0>let's pull in this Linux system template

01:20:09.510 --> 01:20:11.349
<v Speaker 0>and see what we have here too.

01:20:12.470 --> 01:20:14.630
<v Speaker 0>Because this this community templates is a really

01:20:14.630 --> 01:20:16.470
<v Speaker 0>big initiative within the company. We have a

01:20:16.470 --> 01:20:18.390
<v Speaker 0>lot of contributors are really helping push these

01:20:18.390 --> 01:20:20.255
<v Speaker 0>templates forward and, you know, it would be

01:20:20.255 --> 01:20:21.775
<v Speaker 0>nice to contribute to that as well.

01:20:22.815 --> 01:20:23.775
<v Speaker 0>So raw

01:20:24.255 --> 01:20:26.014
<v Speaker 0>and I've not had any questions. I was

01:20:26.014 --> 01:20:27.935
<v Speaker 0>hoping someone would have specific questions I could

01:20:27.935 --> 01:20:29.454
<v Speaker 0>answer before I started

01:20:30.255 --> 01:20:32.175
<v Speaker 0>going off on a little tangent.

01:20:32.415 --> 01:20:34.255
<v Speaker 0>So Linux system. YAML.

01:20:34.920 --> 01:20:37.239
<v Speaker 0>I still have an influx package command or

01:20:37.239 --> 01:20:39.000
<v Speaker 0>not because I'm in their own directory.

01:20:40.920 --> 01:20:42.040
<v Speaker 0>Grab that token.

01:20:53.935 --> 01:20:55.775
<v Speaker 0>Alright. And there we go.

01:20:56.415 --> 01:20:59.535
<v Speaker 0>I'm just gonna point it to that repository.

01:20:59.935 --> 01:21:04.655
<v Speaker 0>So code source, get hub, Ian Kubernetes

01:21:05.929 --> 01:21:06.489
<v Speaker 0>And

01:21:07.929 --> 01:21:09.929
<v Speaker 0>probably download it and there

01:21:10.969 --> 01:21:13.050
<v Speaker 0>because of course that's the

01:21:13.449 --> 01:21:14.570
<v Speaker 0>best place to put it.

01:21:18.975 --> 01:21:20.735
<v Speaker 0>Why is that not working?

01:21:33.599 --> 01:21:35.679
<v Speaker 0>Yeah. Logger put in InfluxDB.

01:21:36.159 --> 01:21:38.479
<v Speaker 0>Hell yeah. We're definitely gonna be doing that.

01:21:39.199 --> 01:21:40.559
<v Speaker 0>There is a

01:21:42.559 --> 01:21:44.960
<v Speaker 0>fluent bit plugin

01:21:44.715 --> 01:21:46.475
<v Speaker 0>for InfluxDB two.

01:21:47.915 --> 01:21:49.515
<v Speaker 0>And if you all wanna stay a bit

01:21:49.515 --> 01:21:51.515
<v Speaker 0>longer, I'm happy to get that deployed.

01:22:00.739 --> 01:22:03.219
<v Speaker 0>I mean, the plugin list would be handy.

01:22:03.219 --> 01:22:04.979
<v Speaker 0>Let's go to the docs. Okay.

01:22:10.659 --> 01:22:12.900
<v Speaker 0>So that time where's my port forward?

01:22:18.715 --> 01:22:19.994
<v Speaker 0>Don't know what happened there.

01:22:21.195 --> 01:22:22.074
<v Speaker 0>Alright.

01:22:22.235 --> 01:22:23.034
<v Speaker 0>Plugins.

01:22:31.150 --> 01:22:32.270
<v Speaker 0>So

01:22:34.030 --> 01:22:37.150
<v Speaker 0>there's actually two really there's two

01:22:37.390 --> 01:22:39.710
<v Speaker 0>options we can do for for getting logs

01:22:39.710 --> 01:22:39.950
<v Speaker 0>here.

01:22:42.635 --> 01:22:44.395
<v Speaker 0>One of them is is here.

01:22:45.915 --> 01:22:47.595
<v Speaker 0>Or is that just InfluxDB one? I'm sure

01:22:47.595 --> 01:22:49.755
<v Speaker 0>there was changes for InfluxDB two. I'll find

01:22:49.755 --> 01:22:52.235
<v Speaker 0>it. There's also vector

01:22:52.315 --> 01:22:53.515
<v Speaker 0>dev,

01:22:54.155 --> 01:22:56.315
<v Speaker 0>which someone contributed to plug in for two

01:22:56.315 --> 01:22:58.635
<v Speaker 0>and I've been looking for any excuse to

01:22:58.050 --> 01:23:00.369
<v Speaker 0>start playing with this tool. So maybe that

01:23:00.369 --> 01:23:01.329
<v Speaker 0>would be awesome.

01:23:06.770 --> 01:23:09.570
<v Speaker 0>Don't get too fussy Leo. I'm gonna filter

01:23:09.570 --> 01:23:11.090
<v Speaker 0>the logs for you. That's your job.

01:23:15.415 --> 01:23:16.455
<v Speaker 0>Components

01:23:17.415 --> 01:23:19.255
<v Speaker 0>and flux

01:23:19.655 --> 01:23:20.695
<v Speaker 0>data.

01:23:23.095 --> 01:23:24.055
<v Speaker 0>Perfect.

01:23:25.890 --> 01:23:27.250
<v Speaker 0>And v two.

01:23:28.130 --> 01:23:29.650
<v Speaker 0>So I've been looking for any excuse to

01:23:29.650 --> 01:23:32.449
<v Speaker 0>play with this vector dev log timber tool.

01:23:33.250 --> 01:23:35.010
<v Speaker 0>I think what we'll do is we'll hook

01:23:35.010 --> 01:23:36.210
<v Speaker 0>this up because

01:23:36.450 --> 01:23:38.930
<v Speaker 0>sources Kubernetes as here

01:23:41.685 --> 01:23:42.405
<v Speaker 0>Somewhere.

01:23:43.925 --> 01:23:44.885
<v Speaker 0>Docker.

01:23:49.685 --> 01:23:51.364
<v Speaker 0>There is a Kubernetes button.

01:23:51.765 --> 01:23:54.719
<v Speaker 0>I'll find it. And it also gives you

01:23:56.240 --> 01:23:57.840
<v Speaker 0>I'm not gonna do your work for you.

01:23:57.840 --> 01:23:58.880
<v Speaker 0>I'll help you though.

01:23:59.920 --> 01:24:02.240
<v Speaker 0>It also gives you this really cool middleware

01:24:02.240 --> 01:24:03.840
<v Speaker 0>layer where you could do transformations on the

01:24:03.840 --> 01:24:05.440
<v Speaker 0>data enrichment.

01:24:05.760 --> 01:24:07.600
<v Speaker 0>So definitely on the next session, you know,

01:24:08.725 --> 01:24:09.844
<v Speaker 0>maybe tomorrow

01:24:10.405 --> 01:24:11.284
<v Speaker 0>I'll

01:24:11.285 --> 01:24:11.844
<v Speaker 0>see

01:24:12.165 --> 01:24:13.925
<v Speaker 0>what people are seeing on Twitter, what they

01:24:13.925 --> 01:24:15.125
<v Speaker 0>want me to do but

01:24:15.925 --> 01:24:17.125
<v Speaker 0>I'm here to serve.

01:24:18.405 --> 01:24:20.405
<v Speaker 0>Vector dot dev allows us to get those

01:24:20.405 --> 01:24:22.725
<v Speaker 0>logs, enrich them and store them at Influx.

01:24:22.725 --> 01:24:24.290
<v Speaker 0>So I think that would be a really

01:24:24.290 --> 01:24:25.570
<v Speaker 0>cool session where we sat down and look

01:24:25.570 --> 01:24:27.490
<v Speaker 0>at how we actually use that and then

01:24:27.490 --> 01:24:29.170
<v Speaker 0>get those logs displayed next to it and

01:24:29.170 --> 01:24:31.170
<v Speaker 0>there is a fluent, maybe it was fluent

01:24:31.170 --> 01:24:33.090
<v Speaker 0>D that InfluxDB two plugin was for.

01:24:38.315 --> 01:24:40.155
<v Speaker 0>I'm gonna have to find that as well.

01:24:42.155 --> 01:24:44.955
<v Speaker 0>That's let's do that later. We're now approaching

01:24:44.955 --> 01:24:46.235
<v Speaker 0>an hour and a half and I know

01:24:46.235 --> 01:24:49.195
<v Speaker 0>these sessions can be really tiring and

01:24:50.290 --> 01:24:51.970
<v Speaker 0>a little bit of fatigue kicks in around

01:24:51.970 --> 01:24:53.970
<v Speaker 0>this mark, as you've all got real jobs

01:24:53.970 --> 01:24:55.730
<v Speaker 0>to do as well. And it has to

01:24:55.730 --> 01:24:56.370
<v Speaker 0>die.

01:24:56.930 --> 01:24:59.170
<v Speaker 0>Alright. So let's take a look at this

01:24:59.170 --> 01:25:00.850
<v Speaker 0>Linux system template.

01:25:02.215 --> 01:25:04.535
<v Speaker 0>So we pulled this and on the right

01:25:04.535 --> 01:25:07.015
<v Speaker 0>bucket, we're filtered by our only host. So

01:25:07.015 --> 01:25:08.855
<v Speaker 0>I actually think this is much more valuable

01:25:08.855 --> 01:25:10.375
<v Speaker 0>than what we were getting out of the

01:25:10.375 --> 01:25:11.255
<v Speaker 0>box

01:25:12.855 --> 01:25:15.975
<v Speaker 0>with the Kubernetes node one. This is a

01:25:15.360 --> 01:25:15.920
<v Speaker 0>more

01:25:16.480 --> 01:25:17.600
<v Speaker 0>I mean, this is the kind of view

01:25:17.600 --> 01:25:19.280
<v Speaker 0>I would expect to see from a Linux

01:25:19.280 --> 01:25:20.960
<v Speaker 0>system point of view. Want the memory usage

01:25:20.960 --> 01:25:22.719
<v Speaker 0>front and center. I wanna be able to

01:25:22.719 --> 01:25:24.560
<v Speaker 0>see, you know, the CPU load over time.

01:25:24.560 --> 01:25:25.840
<v Speaker 0>I wanna be able to break that down.

01:25:25.840 --> 01:25:28.400
<v Speaker 0>I've got desk and activity here. This was

01:25:28.400 --> 01:25:29.679
<v Speaker 0>must've been me pulling images.

01:25:30.454 --> 01:25:32.695
<v Speaker 0>You know, we've got some network bandwidth.

01:25:33.014 --> 01:25:34.215
<v Speaker 0>It should have been a bit more flatter

01:25:34.215 --> 01:25:36.534
<v Speaker 0>than that probably, but you know, this is

01:25:36.534 --> 01:25:38.855
<v Speaker 0>a nice look at the Linux system and

01:25:38.855 --> 01:25:40.375
<v Speaker 0>you've got to remember that when you're monitoring

01:25:40.375 --> 01:25:42.670
<v Speaker 0>Kubernetes, right, there's very there are a lot

01:25:42.670 --> 01:25:44.510
<v Speaker 0>of Kubernetes components that you wanna monitor but

01:25:44.510 --> 01:25:47.550
<v Speaker 0>you're monitoring the metal first, the VM first.

01:25:47.789 --> 01:25:50.190
<v Speaker 0>That has to be healthy for your workloads

01:25:50.190 --> 01:25:51.710
<v Speaker 0>to be healthy and then we get into

01:25:51.710 --> 01:25:54.190
<v Speaker 0>the workload stuff. So, you know, we've got

01:25:54.190 --> 01:25:54.909
<v Speaker 0>this template.

01:25:56.335 --> 01:25:58.014
<v Speaker 0>I'm I'm not sure where the value in

01:25:58.014 --> 01:25:59.294
<v Speaker 0>these two as yet,

01:26:00.895 --> 01:26:02.735
<v Speaker 0>but we're gonna continue to work on our

01:26:02.735 --> 01:26:04.254
<v Speaker 0>Kubernetes fire dashboard.

01:26:04.494 --> 01:26:06.655
<v Speaker 0>Hopefully tomorrow and we'll get those logs there

01:26:06.655 --> 01:26:09.534
<v Speaker 0>and we'll understand what is going on here.

01:26:09.534 --> 01:26:11.820
<v Speaker 0>Right now we've got enough to alert for

01:26:11.820 --> 01:26:14.540
<v Speaker 0>sure. If this deployment is affected, there's more

01:26:14.540 --> 01:26:16.860
<v Speaker 0>than zero or the replicas

01:26:16.860 --> 01:26:18.460
<v Speaker 0>are unavailable. It's more than zero for more

01:26:18.460 --> 01:26:19.979
<v Speaker 0>than five minutes, maybe less.

01:26:20.300 --> 01:26:21.820
<v Speaker 0>Definitely wanna send a trigger.

01:26:22.780 --> 01:26:23.659
<v Speaker 0>So next steps.

01:26:24.585 --> 01:26:26.184
<v Speaker 0>Get a lot of data and

01:26:26.585 --> 01:26:28.745
<v Speaker 0>and ratchet with Kubernetes information as much as

01:26:28.745 --> 01:26:31.545
<v Speaker 0>you can and then trigger an alert to

01:26:31.545 --> 01:26:34.105
<v Speaker 0>Slack or some HTTP endpoint.

01:26:34.585 --> 01:26:36.105
<v Speaker 0>And I think we will do this tomorrow.

01:26:36.105 --> 01:26:37.784
<v Speaker 0>I'm keen to continue with this,

01:26:38.745 --> 01:26:40.025
<v Speaker 0>but thank you for joining me.

01:26:41.469 --> 01:26:43.229
<v Speaker 0>This was the getting started

01:26:43.310 --> 01:26:44.030
<v Speaker 0>part

01:26:44.190 --> 01:26:46.989
<v Speaker 0>of monitoring Kubernetes with InfluxDB.

01:26:47.550 --> 01:26:49.710
<v Speaker 0>Like I said, we'll do this session frequently

01:26:49.710 --> 01:26:51.389
<v Speaker 0>and we're just gonna go deeper and deeper

01:26:51.389 --> 01:26:53.405
<v Speaker 0>down the rabbit hole. I do expect us

01:26:53.405 --> 01:26:54.685
<v Speaker 0>to have to write a lot of code.

01:26:54.685 --> 01:26:55.885
<v Speaker 0>I'm gonna have to write a lot of

01:26:55.885 --> 01:26:57.885
<v Speaker 0>code. I do think that our telegraph plugins,

01:26:57.885 --> 01:27:00.125
<v Speaker 0>there are room for improvement. I definitely wanna

01:27:00.125 --> 01:27:02.205
<v Speaker 0>get these statuses on as well. So

01:27:02.765 --> 01:27:05.085
<v Speaker 0>we'll cover that next time. Thank you very

01:27:05.085 --> 01:27:07.165
<v Speaker 0>much. I hope you've enjoyed this and I

01:27:07.165 --> 01:27:08.610
<v Speaker 0>will speak to you soon. Adios.
