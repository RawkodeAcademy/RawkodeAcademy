WEBVTT

NOTE
Transcription provided by Deepgram
Request Id: 0d3cb6d3-b5bc-4145-833d-ce38598b8767
Created: 2025-04-29T17:11:48.458Z
Duration: 5069.3403
Channels: 1

00:00:48.700 --> 00:00:49.420
<v Speaker 0>Hello,

00:00:50.460 --> 00:00:53.740
<v Speaker 0>and welcome back to the Rawkode Academy.

00:00:54.700 --> 00:00:57.340
<v Speaker 0>Today is our first workshop

00:00:57.500 --> 00:01:00.140
<v Speaker 0>on our live course, the complete guide to

00:01:00.140 --> 00:01:00.860
<v Speaker 0>Teleport.

00:01:02.715 --> 00:01:05.354
<v Speaker 0>Oh, it's gonna be fun. I hope.

00:01:07.195 --> 00:01:09.034
<v Speaker 0>Good to see you in the chat. Hey,

00:01:09.034 --> 00:01:10.314
<v Speaker 0>Nuno. Hey, Kevin.

00:01:10.475 --> 00:01:12.155
<v Speaker 0>It's been a while. I have been away

00:01:12.155 --> 00:01:12.795
<v Speaker 0>for

00:01:13.835 --> 00:01:17.915
<v Speaker 0>six weeks, maybe longer on paternity leave. I

00:01:17.170 --> 00:01:18.930
<v Speaker 0>surprised I even remember how to turn this

00:01:18.930 --> 00:01:20.690
<v Speaker 0>thing on, but here I am. I hope

00:01:20.690 --> 00:01:22.450
<v Speaker 0>my audio is okay. Feel free to let

00:01:22.450 --> 00:01:23.570
<v Speaker 0>me know in a chat

00:01:23.890 --> 00:01:25.250
<v Speaker 0>and we'll

00:01:25.250 --> 00:01:27.090
<v Speaker 0>kind of run through what we're going to

00:01:27.090 --> 00:01:28.130
<v Speaker 0>do today.

00:01:29.525 --> 00:01:31.045
<v Speaker 0>So you may have noticed in the Complete

00:01:31.045 --> 00:01:32.645
<v Speaker 0>Guide to Teleport course, we've had a couple

00:01:32.645 --> 00:01:34.645
<v Speaker 0>of tutorials published in the last week. We

00:01:34.645 --> 00:01:36.885
<v Speaker 0>have taken a look at installing and running

00:01:36.885 --> 00:01:37.765
<v Speaker 0>Teleport.

00:01:38.165 --> 00:01:41.205
<v Speaker 0>We looked at installing through package managers on

00:01:41.205 --> 00:01:44.085
<v Speaker 0>Red Hat and Debian or Debian derivatives as

00:01:44.085 --> 00:01:44.245
<v Speaker 0>well.

00:01:45.369 --> 00:01:48.090
<v Speaker 0>We took a look at installing it through

00:01:48.409 --> 00:01:51.530
<v Speaker 0>DNF or Yum on Red Hat systems.

00:01:51.770 --> 00:01:53.530
<v Speaker 0>And we take a look at

00:01:53.930 --> 00:01:56.570
<v Speaker 0>installing it through using curl, right, for any

00:01:56.570 --> 00:01:58.970
<v Speaker 0>other Linux distribution where using a package manager

00:01:58.970 --> 00:02:01.555
<v Speaker 0>is not really an option. So it's pretty

00:02:01.555 --> 00:02:03.715
<v Speaker 0>simple. The videos are there. Please feel free

00:02:03.715 --> 00:02:05.075
<v Speaker 0>to go and check them out.

00:02:06.275 --> 00:02:08.595
<v Speaker 0>The second tutorial, we take a look at,

00:02:08.595 --> 00:02:10.275
<v Speaker 0>well, what if we want to run Teleport

00:02:10.275 --> 00:02:12.675
<v Speaker 0>using containers and with Docker? And what if

00:02:12.675 --> 00:02:13.715
<v Speaker 0>we want to do this locally?

00:02:14.340 --> 00:02:17.380
<v Speaker 0>There are a few gotchas that the tutorial

00:02:17.460 --> 00:02:18.420
<v Speaker 0>covers,

00:02:18.420 --> 00:02:20.420
<v Speaker 0>making sure that you persist your state, you

00:02:20.420 --> 00:02:22.420
<v Speaker 0>handle configuration appropriately,

00:02:22.820 --> 00:02:24.500
<v Speaker 0>and we even take a look at using

00:02:24.500 --> 00:02:27.300
<v Speaker 0>Docker Compose for a lab like environment with

00:02:27.300 --> 00:02:29.300
<v Speaker 0>multiple nodes within your Teleport cluster.

00:02:30.955 --> 00:02:33.035
<v Speaker 0>So we're following on from that today. Our

00:02:33.035 --> 00:02:35.435
<v Speaker 0>first workshop is going to be anywhere between,

00:02:35.915 --> 00:02:37.915
<v Speaker 0>I think, sixty to ninety minutes. It's hard

00:02:37.915 --> 00:02:39.195
<v Speaker 0>to tell these things.

00:02:39.515 --> 00:02:41.675
<v Speaker 0>I don't run through the workshops in advance

00:02:41.675 --> 00:02:43.515
<v Speaker 0>as with all things on my channel.

00:02:44.080 --> 00:02:45.599
<v Speaker 0>I come up with a concept and then

00:02:45.599 --> 00:02:47.599
<v Speaker 0>we do it live. So I've come up

00:02:47.599 --> 00:02:48.880
<v Speaker 0>with, let me share.

00:02:49.840 --> 00:02:52.160
<v Speaker 0>Hey, Carlos, thank you for joining us today.

00:02:52.959 --> 00:02:54.400
<v Speaker 0>So let's pop over here.

00:02:56.105 --> 00:02:58.424
<v Speaker 0>You can go to the Rawkode Academy GitHub

00:02:58.424 --> 00:03:01.705
<v Speaker 0>page that is github.com/rockwoodacademy.

00:03:01.944 --> 00:03:04.424
<v Speaker 0>From there, you will see a courses repository

00:03:04.424 --> 00:03:07.064
<v Speaker 0>and we have a directory for the Teleport

00:03:07.064 --> 00:03:08.105
<v Speaker 0>Complete Guide.

00:03:08.745 --> 00:03:10.665
<v Speaker 0>Instead of here, we have part five, which

00:03:10.665 --> 00:03:11.385
<v Speaker 0>is this workshop

00:03:11.820 --> 00:03:13.260
<v Speaker 0>where we are gonna take a look at

00:03:13.260 --> 00:03:15.020
<v Speaker 0>server access and all the cool things that

00:03:15.020 --> 00:03:16.620
<v Speaker 0>Teleport brings to the table.

00:03:17.500 --> 00:03:19.420
<v Speaker 0>I've set myself 15 tasks.

00:03:19.500 --> 00:03:22.140
<v Speaker 0>These are tasks that I was wrapping

00:03:22.140 --> 00:03:24.140
<v Speaker 0>my brain around, right? If we want people

00:03:24.435 --> 00:03:24.995
<v Speaker 0>to

00:03:25.475 --> 00:03:28.275
<v Speaker 0>play with Teleport, get excited by Teleport, love

00:03:28.275 --> 00:03:29.955
<v Speaker 0>Teleport enough to deploy it to all of

00:03:29.955 --> 00:03:32.595
<v Speaker 0>their infrastructures, which I think everyone should do,

00:03:33.075 --> 00:03:34.595
<v Speaker 0>then we have to walk them through a

00:03:34.595 --> 00:03:36.435
<v Speaker 0>series of steps to show them the value

00:03:36.435 --> 00:03:37.475
<v Speaker 0>add to Teleport brings.

00:03:38.140 --> 00:03:40.620
<v Speaker 0>And each of these questions hopefully allow you

00:03:40.620 --> 00:03:42.220
<v Speaker 0>to learn the primitives and the basics of

00:03:42.220 --> 00:03:44.300
<v Speaker 0>working with Teleport and lead you down that

00:03:44.300 --> 00:03:46.060
<v Speaker 0>path of the holy shit, this is really

00:03:46.060 --> 00:03:46.540
<v Speaker 0>cool.

00:03:48.300 --> 00:03:49.580
<v Speaker 0>I haven't run through it, like I said

00:03:49.580 --> 00:03:50.860
<v Speaker 0>myself, we're gonna do it all together.

00:03:52.345 --> 00:03:54.584
<v Speaker 0>Everything on my channel is about live. I

00:03:54.584 --> 00:03:56.425
<v Speaker 0>like it this way. We're going to leverage

00:03:56.425 --> 00:03:58.584
<v Speaker 0>the documentation as much as possible. The Teleport

00:03:58.584 --> 00:03:59.705
<v Speaker 0>docs are great

00:04:00.025 --> 00:04:01.864
<v Speaker 0>and we're going to use that whenever we

00:04:01.864 --> 00:04:03.785
<v Speaker 0>get stuck and hopefully have a little bit

00:04:03.785 --> 00:04:04.105
<v Speaker 0>of fun.

00:04:04.900 --> 00:04:07.380
<v Speaker 0>Feel free to chat away in the chat,

00:04:07.380 --> 00:04:09.940
<v Speaker 0>ask questions, please. Any questions you have along

00:04:09.940 --> 00:04:11.860
<v Speaker 0>the way, drop them in. I'll do my

00:04:11.860 --> 00:04:12.980
<v Speaker 0>best to answer them.

00:04:13.300 --> 00:04:14.980
<v Speaker 0>And we're really just going to get started

00:04:14.980 --> 00:04:15.620
<v Speaker 0>with this thing.

00:04:17.794 --> 00:04:19.154
<v Speaker 0>What have I done upfront?

00:04:19.315 --> 00:04:22.115
<v Speaker 0>Well, I created in this directory,

00:04:22.115 --> 00:04:23.475
<v Speaker 0>we have a

00:04:23.875 --> 00:04:24.595
<v Speaker 0>small

00:04:24.915 --> 00:04:25.795
<v Speaker 0>Pulumi

00:04:27.794 --> 00:04:28.354
<v Speaker 0>project

00:04:29.810 --> 00:04:32.450
<v Speaker 0>that just runs a couple of Linodes,

00:04:32.530 --> 00:04:33.650
<v Speaker 0>Y Linode.

00:04:34.530 --> 00:04:37.010
<v Speaker 0>It's pretty cheap. I just need small VMs.

00:04:37.170 --> 00:04:38.770
<v Speaker 0>So we're going with that today.

00:04:39.890 --> 00:04:41.650
<v Speaker 0>I've already spun them up, we don't need

00:04:41.650 --> 00:04:43.010
<v Speaker 0>to wait for that to run. You will

00:04:43.010 --> 00:04:44.610
<v Speaker 0>see that I have a Teleport server,

00:04:46.555 --> 00:04:48.715
<v Speaker 0>three working nodes. There's nothing installed on these.

00:04:48.715 --> 00:04:50.635
<v Speaker 0>We're going to do all of this together.

00:04:51.995 --> 00:04:54.155
<v Speaker 0>So hopefully if you want to try this

00:04:54.155 --> 00:04:55.755
<v Speaker 0>out, you can use the Pulumi, but of

00:04:55.755 --> 00:04:57.115
<v Speaker 0>course, if you just want to spin up

00:04:57.115 --> 00:04:59.600
<v Speaker 0>some AWS instances, you want to use containers

00:04:59.600 --> 00:05:02.160
<v Speaker 0>using the lab environment from the previous tutorial,

00:05:02.240 --> 00:05:04.240
<v Speaker 0>feel free to do that. It's entirely up

00:05:04.240 --> 00:05:06.000
<v Speaker 0>to you. If you have Bit Metal, hell,

00:05:06.000 --> 00:05:07.040
<v Speaker 0>go have some fun.

00:05:08.639 --> 00:05:10.880
<v Speaker 0>Okay. So exercise one is that we want

00:05:10.880 --> 00:05:12.320
<v Speaker 0>to create the Teleport server.

00:05:12.914 --> 00:05:15.235
<v Speaker 0>We need a single node in our cluster

00:05:15.235 --> 00:05:17.474
<v Speaker 0>that is going to act as the central

00:05:17.474 --> 00:05:19.715
<v Speaker 0>point for authentication and proxying,

00:05:19.715 --> 00:05:20.595
<v Speaker 0>and we need to be able to get

00:05:20.595 --> 00:05:21.635
<v Speaker 0>that up and running.

00:05:22.675 --> 00:05:24.595
<v Speaker 0>Exercise one just says that we want to

00:05:24.595 --> 00:05:26.354
<v Speaker 0>use one of our servers to install and

00:05:26.354 --> 00:05:28.194
<v Speaker 0>create a Teleport server

00:05:28.580 --> 00:05:30.340
<v Speaker 0>with a static authentication

00:05:30.340 --> 00:05:31.140
<v Speaker 0>token

00:05:31.380 --> 00:05:32.580
<v Speaker 0>for agents

00:05:34.500 --> 00:05:37.220
<v Speaker 0>to join the cluster at our next exercise.

00:05:38.260 --> 00:05:38.980
<v Speaker 0>Cool.

00:05:39.620 --> 00:05:41.700
<v Speaker 0>Well, let's get the documentation up, which I

00:05:41.700 --> 00:05:42.900
<v Speaker 0>should have done in advance.

00:05:43.525 --> 00:05:45.365
<v Speaker 0>You can go to goteleport.com,

00:05:45.365 --> 00:05:46.565
<v Speaker 0>click on doc docs,

00:05:48.405 --> 00:05:50.164
<v Speaker 0>and we can just use the, get started

00:05:50.164 --> 00:05:52.485
<v Speaker 0>guide, click on Linux. And this has pretty

00:05:52.485 --> 00:05:54.164
<v Speaker 0>much everything that we need. I'm going to

00:05:54.164 --> 00:05:56.005
<v Speaker 0>use the curl approach, which is here.

00:05:57.960 --> 00:06:00.840
<v Speaker 0>We've got our first question already from Carlos.

00:06:04.280 --> 00:06:05.000
<v Speaker 0>So

00:06:05.160 --> 00:06:07.080
<v Speaker 0>Carlos says, is this a single point of

00:06:07.080 --> 00:06:08.520
<v Speaker 0>failure and how do you handle that?

00:06:11.405 --> 00:06:12.445
<v Speaker 0>Excuse me.

00:06:14.044 --> 00:06:17.005
<v Speaker 0>You know, I'm pretty confident that it's all

00:06:17.005 --> 00:06:18.205
<v Speaker 0>behind enterprise.

00:06:18.285 --> 00:06:21.165
<v Speaker 0>If you need a highly available Teleport control

00:06:21.165 --> 00:06:23.405
<v Speaker 0>plane, I believe enterprise is the option.

00:06:24.020 --> 00:06:26.020
<v Speaker 0>I am not aware of any ability to

00:06:26.020 --> 00:06:28.500
<v Speaker 0>do that through the open source product. However,

00:06:28.500 --> 00:06:30.420
<v Speaker 0>I could be wrong. And so I will

00:06:30.420 --> 00:06:31.620
<v Speaker 0>post a follow-up

00:06:32.180 --> 00:06:33.700
<v Speaker 0>and we'll do a tutorial on that, but

00:06:33.700 --> 00:06:35.940
<v Speaker 0>I'm pretty sure it is behind enterprise.

00:06:36.875 --> 00:06:39.035
<v Speaker 0>What I would recommend is if you are

00:06:39.035 --> 00:06:40.555
<v Speaker 0>worried about high availability,

00:06:40.635 --> 00:06:42.635
<v Speaker 0>there is Teleport Cloud. You can check out

00:06:42.635 --> 00:06:44.795
<v Speaker 0>that and maybe you can just I'm not

00:06:44.795 --> 00:06:47.435
<v Speaker 0>entirely familiar with what the costs are, but

00:06:47.435 --> 00:06:49.115
<v Speaker 0>maybe you could just use their cloud SaaS

00:06:49.115 --> 00:06:49.675
<v Speaker 0>offering

00:06:50.360 --> 00:06:51.960
<v Speaker 0>and then you would get enterprise

00:06:51.960 --> 00:06:55.240
<v Speaker 0>level, highly available control plan without any risk.

00:07:06.445 --> 00:07:07.805
<v Speaker 0>User two chatty.

00:07:08.285 --> 00:07:10.125
<v Speaker 0>Kevin is then there saying you can run

00:07:10.125 --> 00:07:11.645
<v Speaker 0>it in HE with the open source version,

00:07:11.645 --> 00:07:12.925
<v Speaker 0>but you have to do it by hand.

00:07:14.045 --> 00:07:15.565
<v Speaker 0>There you go. I mean, I guess if

00:07:15.565 --> 00:07:17.965
<v Speaker 0>you can so there's multiple ways to configure

00:07:17.965 --> 00:07:20.180
<v Speaker 0>the control plane. I guess if you're doing

00:07:20.180 --> 00:07:22.660
<v Speaker 0>it through X509 certificate authentication,

00:07:23.380 --> 00:07:24.980
<v Speaker 0>you know, if you can configure the same

00:07:24.980 --> 00:07:26.980
<v Speaker 0>search and you have state that can be

00:07:26.980 --> 00:07:28.500
<v Speaker 0>synced across the machines, then I guess that

00:07:28.500 --> 00:07:29.460
<v Speaker 0>would work that way.

00:07:30.260 --> 00:07:31.860
<v Speaker 0>We'll dive into that maybe later in the

00:07:31.860 --> 00:07:33.060
<v Speaker 0>course, I'll see if I can squeeze that

00:07:33.060 --> 00:07:33.300
<v Speaker 0>in.

00:07:35.825 --> 00:07:37.025
<v Speaker 0>Okay. Let's get

00:07:37.585 --> 00:07:38.785
<v Speaker 0>on the source machine.

00:07:39.025 --> 00:07:40.785
<v Speaker 0>So here is my IP address

00:07:41.825 --> 00:07:43.585
<v Speaker 0>for my Teleport server.

00:07:45.825 --> 00:07:47.425
<v Speaker 0>I've got a BSSH.

00:07:47.585 --> 00:07:48.865
<v Speaker 0>I've forgotten how to computer.

00:07:50.280 --> 00:07:53.000
<v Speaker 0>My password

00:07:58.280 --> 00:08:00.120
<v Speaker 0>is not sole secret.

00:08:01.480 --> 00:08:03.240
<v Speaker 0>But this does get me onto the machine.

00:08:03.634 --> 00:08:05.795
<v Speaker 0>I do not have T control,

00:08:06.514 --> 00:08:07.395
<v Speaker 0>TSH

00:08:07.395 --> 00:08:08.595
<v Speaker 0>or Teleport.

00:08:08.995 --> 00:08:11.315
<v Speaker 0>So there's nothing available on this machine.

00:08:20.020 --> 00:08:21.940
<v Speaker 0>Let us download

00:08:27.940 --> 00:08:28.340
<v Speaker 0>the

00:08:30.419 --> 00:08:31.940
<v Speaker 0>Extract the tarball.

00:08:37.434 --> 00:08:39.914
<v Speaker 0>And it just wants us to do sudo

00:08:39.914 --> 00:08:42.075
<v Speaker 0>install inside of this directory.

00:08:42.315 --> 00:08:43.914
<v Speaker 0>I'm root, so I don't need to worry

00:08:43.914 --> 00:08:44.635
<v Speaker 0>about that.

00:08:45.835 --> 00:08:49.995
<v Speaker 0>And it will tell us that

00:08:48.420 --> 00:08:51.140
<v Speaker 0>we have installed Teleport and

00:08:52.339 --> 00:08:54.019
<v Speaker 0>we now have TCTL,

00:08:54.019 --> 00:08:55.060
<v Speaker 0>TSH

00:08:55.540 --> 00:08:57.220
<v Speaker 0>and a Teleport command.

00:08:57.860 --> 00:08:59.700
<v Speaker 0>So that is our several, at least we've

00:08:59.700 --> 00:09:02.339
<v Speaker 0>got the binaries available on our server machine.

00:09:03.965 --> 00:09:04.525
<v Speaker 0>So

00:09:05.005 --> 00:09:06.285
<v Speaker 0>one of the things we covered in our

00:09:06.285 --> 00:09:08.845
<v Speaker 0>previous tutorial was that Teleport ships with a

00:09:08.845 --> 00:09:10.685
<v Speaker 0>Teleport configure command that is going to give

00:09:10.685 --> 00:09:12.365
<v Speaker 0>us a base config to allow us to

00:09:12.365 --> 00:09:13.805
<v Speaker 0>get started pretty quickly.

00:09:14.445 --> 00:09:16.765
<v Speaker 0>We can jump into ETC.

00:09:16.845 --> 00:09:18.125
<v Speaker 0>We can make a Teleport

00:09:19.220 --> 00:09:21.940
<v Speaker 0>and we can run teleport configure,

00:09:23.620 --> 00:09:24.500
<v Speaker 0>teleport.

00:09:24.660 --> 00:09:25.540
<v Speaker 0>Yaml.

00:09:26.980 --> 00:09:28.420
<v Speaker 0>And if we want to start making changes

00:09:28.420 --> 00:09:30.339
<v Speaker 0>to this, we have the configuration here.

00:09:31.765 --> 00:09:33.365
<v Speaker 0>One of the things you'll notice I did

00:09:33.365 --> 00:09:35.205
<v Speaker 0>in the tutorials was throw away the node

00:09:35.205 --> 00:09:37.205
<v Speaker 0>name, we allow the Teleport runtime to infer

00:09:37.205 --> 00:09:39.045
<v Speaker 0>this from the host name of the machine,

00:09:39.925 --> 00:09:42.085
<v Speaker 0>but one of the tasks on

00:09:42.565 --> 00:09:44.885
<v Speaker 0>our workshop exercise one is that we need

00:09:44.885 --> 00:09:47.365
<v Speaker 0>static authentication token for the agents.

00:09:48.460 --> 00:09:51.340
<v Speaker 0>So what does that mean? Well, let's see.

00:09:55.820 --> 00:09:56.940
<v Speaker 0>When we

00:09:57.900 --> 00:09:59.820
<v Speaker 0>Sorry, trying to keep up with the chat

00:09:59.820 --> 00:10:00.060
<v Speaker 0>here.

00:10:03.875 --> 00:10:06.675
<v Speaker 0>These are still talking about highly available control

00:10:06.675 --> 00:10:10.115
<v Speaker 0>plans. Carlos is asking about Kubernetes deployments.

00:10:10.355 --> 00:10:12.115
<v Speaker 0>There is a Kubernetes workshop

00:10:12.770 --> 00:10:14.530
<v Speaker 0>either next week or the following week where

00:10:14.530 --> 00:10:15.250
<v Speaker 0>we take

00:10:15.490 --> 00:10:17.250
<v Speaker 0>a look at the different deployment scenarios on

00:10:17.250 --> 00:10:18.050
<v Speaker 0>Kubernetes.

00:10:18.050 --> 00:10:19.730
<v Speaker 0>So join us for that for sure.

00:10:21.730 --> 00:10:23.570
<v Speaker 0>Nuno saying, you thought I was going to

00:10:23.570 --> 00:10:24.770
<v Speaker 0>use TCSH?

00:10:26.015 --> 00:10:26.895
<v Speaker 0>And

00:10:29.615 --> 00:10:31.775
<v Speaker 0>then more chat about AG. All right, cool.

00:10:31.935 --> 00:10:33.935
<v Speaker 0>So when we talk about authentication,

00:10:33.935 --> 00:10:36.015
<v Speaker 0>the way that the Teleport model works is

00:10:36.015 --> 00:10:37.215
<v Speaker 0>that we have the server

00:10:37.695 --> 00:10:39.695
<v Speaker 0>and then we deploy Teleport

00:10:41.100 --> 00:10:42.860
<v Speaker 0>server to the other machines, but we only

00:10:42.860 --> 00:10:44.139
<v Speaker 0>run them in agent mode,

00:10:44.380 --> 00:10:45.819
<v Speaker 0>which just means that they have like the

00:10:45.819 --> 00:10:48.860
<v Speaker 0>authentication service disabled, the proxy service disabled.

00:10:48.940 --> 00:10:50.940
<v Speaker 0>They're really just connecting best to the server

00:10:50.940 --> 00:10:52.540
<v Speaker 0>to be able to join the cluster.

00:10:53.100 --> 00:10:55.019
<v Speaker 0>The way that these work is that you

00:10:55.019 --> 00:10:57.625
<v Speaker 0>can either create tokens

00:10:57.865 --> 00:10:58.665
<v Speaker 0>to do,

00:11:00.585 --> 00:11:02.585
<v Speaker 0>you can generate femoral tokens that you pass

00:11:02.585 --> 00:11:04.105
<v Speaker 0>to the agents that register and then those

00:11:04.105 --> 00:11:05.945
<v Speaker 0>tokens can expire, but the nodes not remembers

00:11:05.945 --> 00:11:08.345
<v Speaker 0>the cluster, or you can define a static

00:11:08.345 --> 00:11:10.425
<v Speaker 0>token that works for as

00:11:10.425 --> 00:11:11.785
<v Speaker 0>long as the server is configured with that

00:11:11.785 --> 00:11:14.160
<v Speaker 0>token, at least. There's lots of ways to

00:11:14.160 --> 00:11:15.600
<v Speaker 0>secure it down and we'll be looking at

00:11:15.600 --> 00:11:18.560
<v Speaker 0>production best practices and security of your Teleport

00:11:18.560 --> 00:11:19.759
<v Speaker 0>control plane

00:11:19.920 --> 00:11:22.639
<v Speaker 0>and tutorials, follow into the course, but we're

00:11:22.639 --> 00:11:23.680
<v Speaker 0>not going to talk about that today, but

00:11:23.680 --> 00:11:26.000
<v Speaker 0>there's cool things like CA pending to make

00:11:26.000 --> 00:11:27.360
<v Speaker 0>sure that we get the right search back

00:11:27.360 --> 00:11:30.045
<v Speaker 0>and such. But today we're just going with

00:11:30.045 --> 00:11:31.885
<v Speaker 0>a static join token, which means we just

00:11:31.885 --> 00:11:34.525
<v Speaker 0>need to configure our off service with an

00:11:34.525 --> 00:11:37.485
<v Speaker 0>arbitrary string. And if any of the

00:11:37.805 --> 00:11:40.285
<v Speaker 0>agents have that string, they will be allowed

00:11:40.285 --> 00:11:42.525
<v Speaker 0>to join as an agent of the cluster.

00:11:43.800 --> 00:11:45.880
<v Speaker 0>Carlos in the chat is asking which language

00:11:45.880 --> 00:11:47.480
<v Speaker 0>is Teleport written in?

00:11:48.519 --> 00:11:51.080
<v Speaker 0>Almost exclusively in Go with the front end

00:11:51.080 --> 00:11:52.839
<v Speaker 0>and TypeScript and React,

00:11:53.240 --> 00:11:53.800
<v Speaker 0>I believe.

00:11:56.644 --> 00:11:57.365
<v Speaker 0>Okay.

00:12:00.084 --> 00:12:04.084
<v Speaker 0>So we already have off service and enabled

00:12:05.685 --> 00:12:06.485
<v Speaker 0>here.

00:12:07.925 --> 00:12:10.030
<v Speaker 0>So we need to add tokens

00:12:10.030 --> 00:12:11.710
<v Speaker 0>followed by this

00:12:11.790 --> 00:12:12.510
<v Speaker 0>string.

00:12:14.510 --> 00:12:15.630
<v Speaker 0>So we want to say that we want

00:12:15.630 --> 00:12:17.230
<v Speaker 0>to enable token authentication,

00:12:22.125 --> 00:12:24.045
<v Speaker 0>and we won't use their string.

00:12:26.765 --> 00:12:28.445
<v Speaker 0>We'll see Rawkode

00:12:30.125 --> 00:12:30.605
<v Speaker 0>Academy.

00:12:33.160 --> 00:12:35.560
<v Speaker 0>So we can save that. And now

00:12:36.280 --> 00:12:40.040
<v Speaker 0>if we run a systemd teleport

00:12:40.040 --> 00:12:40.840
<v Speaker 0>start,

00:12:40.840 --> 00:12:42.920
<v Speaker 0>I'm pretty sure there's a service available.

00:12:44.760 --> 00:12:46.120
<v Speaker 0>Start teleport.

00:12:48.415 --> 00:12:49.215
<v Speaker 0>No.

00:12:52.415 --> 00:12:54.415
<v Speaker 0>I thought there was. Maybe not with the

00:12:54.415 --> 00:12:55.214
<v Speaker 0>curl installation.

00:13:01.770 --> 00:13:03.770
<v Speaker 0>Yeah. Computer said no. So what we're going

00:13:03.770 --> 00:13:05.450
<v Speaker 0>to do is a Teleport

00:13:06.089 --> 00:13:06.890
<v Speaker 0>start.

00:13:07.610 --> 00:13:09.450
<v Speaker 0>I'm pretty sure I've got my config in

00:13:09.450 --> 00:13:10.250
<v Speaker 0>the right location.

00:13:20.725 --> 00:13:22.085
<v Speaker 0>I think so. If not, I can make

00:13:22.085 --> 00:13:23.845
<v Speaker 0>it explicit. Let's just make it explicit. Let's

00:13:23.845 --> 00:13:25.365
<v Speaker 0>remove any room for error.

00:13:25.765 --> 00:13:26.885
<v Speaker 0>I don't trust myself.

00:13:28.500 --> 00:13:29.940
<v Speaker 0>So we're gonna start out like that. We

00:13:29.940 --> 00:13:31.700
<v Speaker 0>can just pass the dash C, which tells

00:13:31.700 --> 00:13:34.500
<v Speaker 0>us to load an explicit config and relatively

00:13:35.220 --> 00:13:37.060
<v Speaker 0>confident this is the correct path and it

00:13:37.060 --> 00:13:39.300
<v Speaker 0>was configured this way anyway, but it's fine.

00:13:40.815 --> 00:13:41.615
<v Speaker 0>Cool.

00:13:42.015 --> 00:13:44.015
<v Speaker 0>Now we can check that this works

00:13:44.895 --> 00:13:48.015
<v Speaker 0>by browsing to the public IPv4 address of

00:13:48.015 --> 00:13:49.375
<v Speaker 0>our Teleport server,

00:13:49.695 --> 00:13:51.535
<v Speaker 0>and we should be presented with the login

00:13:51.535 --> 00:13:52.015
<v Speaker 0>screen.

00:13:58.490 --> 00:14:00.170
<v Speaker 0>Nope. HTTPS

00:14:00.170 --> 00:14:01.370
<v Speaker 0>is what I wanted.

00:14:01.690 --> 00:14:03.290
<v Speaker 0>Now I haven't configured

00:14:03.450 --> 00:14:05.850
<v Speaker 0>any x five zero nine certificates.

00:14:05.850 --> 00:14:07.770
<v Speaker 0>So as Teleport does it itself,

00:14:08.735 --> 00:14:10.895
<v Speaker 0>It does have built in

00:14:11.695 --> 00:14:13.055
<v Speaker 0>ACMELetsEncrypt

00:14:13.055 --> 00:14:14.895
<v Speaker 0>support. So if I were to go and

00:14:14.895 --> 00:14:16.655
<v Speaker 0>create a DNS record for

00:14:17.295 --> 00:14:19.535
<v Speaker 0>this IP address, we could go into the

00:14:19.535 --> 00:14:21.775
<v Speaker 0>config and enable that. When we look at

00:14:21.775 --> 00:14:22.495
<v Speaker 0>best practices,

00:14:23.010 --> 00:14:25.170
<v Speaker 0>we will be covering certificates

00:14:25.170 --> 00:14:27.410
<v Speaker 0>in much more detail there. So that'll be

00:14:27.410 --> 00:14:28.290
<v Speaker 0>in a week or two.

00:14:29.330 --> 00:14:31.010
<v Speaker 0>We don't have a user yet, so we're

00:14:31.010 --> 00:14:32.850
<v Speaker 0>going to quickly create one for that.

00:14:33.970 --> 00:14:35.170
<v Speaker 0>And we can do that. I may as

00:14:35.170 --> 00:14:37.735
<v Speaker 0>well have to split this. We get SSH

00:14:37.815 --> 00:14:39.575
<v Speaker 0>should be the same, nope.

00:14:40.855 --> 00:14:42.135
<v Speaker 0>IP address.

00:14:46.215 --> 00:14:46.935
<v Speaker 0>My

00:14:47.255 --> 00:14:48.535
<v Speaker 0>super secret password,

00:14:51.910 --> 00:14:54.310
<v Speaker 0>Really should have enabled key authentication.

00:14:56.230 --> 00:14:58.390
<v Speaker 0>Alright. And now we can create a user.

00:14:58.390 --> 00:14:59.830
<v Speaker 0>So to create a user, we're going to

00:14:59.830 --> 00:15:01.510
<v Speaker 0>do t control,

00:15:02.390 --> 00:15:04.150
<v Speaker 0>users add Rawkode.

00:15:04.975 --> 00:15:06.735
<v Speaker 0>Don't worry about rules or anything like that

00:15:06.735 --> 00:15:08.815
<v Speaker 0>now, we're going to cover that shortly.

00:15:12.095 --> 00:15:14.015
<v Speaker 0>This gets me a link here,

00:15:16.495 --> 00:15:18.095
<v Speaker 0>which I just have to replace with my

00:15:18.095 --> 00:15:18.815
<v Speaker 0>IP address.

00:15:27.910 --> 00:15:30.550
<v Speaker 0>And I can actually change the configuration with

00:15:30.550 --> 00:15:33.190
<v Speaker 0>a bit more information. In fact, the node

00:15:33.190 --> 00:15:34.790
<v Speaker 0>name probably set to this would have tabbed

00:15:34.790 --> 00:15:35.269
<v Speaker 0>that up.

00:15:36.675 --> 00:15:38.755
<v Speaker 0>We're going to generate a password.

00:15:42.115 --> 00:15:43.075
<v Speaker 0>Teleport

00:15:44.035 --> 00:15:45.235
<v Speaker 0>workshop.

00:15:47.075 --> 00:15:48.834
<v Speaker 0>And I'll just need to copy that again.

00:15:48.834 --> 00:15:50.035
<v Speaker 0>I don't know why it doesn't put it

00:15:50.035 --> 00:15:52.430
<v Speaker 0>in both. We have one password bug.

00:15:52.990 --> 00:15:55.550
<v Speaker 0>And my favorite feature in one password is

00:15:55.550 --> 00:15:56.510
<v Speaker 0>scanning

00:15:56.510 --> 00:15:58.029
<v Speaker 0>the QR code.

00:15:59.389 --> 00:16:00.510
<v Speaker 0>There we go.

00:16:03.149 --> 00:16:03.630
<v Speaker 0>Sweet.

00:16:07.285 --> 00:16:09.205
<v Speaker 0>Okay, let's jump back to this. So we

00:16:09.205 --> 00:16:11.125
<v Speaker 0>have created a Teleport server

00:16:11.765 --> 00:16:14.725
<v Speaker 0>with a static authentication token for agents.

00:16:15.125 --> 00:16:17.365
<v Speaker 0>The part two is we want to wash

00:16:17.365 --> 00:16:18.805
<v Speaker 0>our system and repeat. We want to actually

00:16:18.805 --> 00:16:21.365
<v Speaker 0>add these other nodes to our system.

00:16:23.520 --> 00:16:26.320
<v Speaker 0>Let's grab this IP address. I'm going to

00:16:26.320 --> 00:16:28.800
<v Speaker 0>really regret copying and pasting this password now.

00:16:37.464 --> 00:16:39.865
<v Speaker 0>Let's just keep the splits coming. So I

00:16:39.865 --> 00:16:41.785
<v Speaker 0>need my next IP address.

00:16:43.384 --> 00:16:44.985
<v Speaker 0>And I need my password.

00:16:48.105 --> 00:16:49.225
<v Speaker 0>And one more.

00:16:53.770 --> 00:16:56.010
<v Speaker 0>Last time for the password, I hope.

00:16:58.170 --> 00:16:59.690
<v Speaker 0>And then we're going to

00:17:00.089 --> 00:17:01.370
<v Speaker 0>Not cheat,

00:17:01.529 --> 00:17:03.450
<v Speaker 0>but we're going to use iTerms

00:17:03.450 --> 00:17:04.809
<v Speaker 0>session

00:17:05.294 --> 00:17:06.654
<v Speaker 0>copy thingy.

00:17:07.774 --> 00:17:08.974
<v Speaker 0>Where is it?

00:17:12.575 --> 00:17:13.374
<v Speaker 0>Broadcast

00:17:14.734 --> 00:17:15.694
<v Speaker 0>current tab.

00:17:18.089 --> 00:17:18.809
<v Speaker 0>Yes.

00:17:20.089 --> 00:17:21.770
<v Speaker 0>Perfect. Okay. And now we can do the

00:17:21.770 --> 00:17:23.529
<v Speaker 0>installation all at the same time.

00:17:24.490 --> 00:17:26.730
<v Speaker 0>We'll jump back over to our

00:17:26.970 --> 00:17:28.089
<v Speaker 0>documentation.

00:17:28.089 --> 00:17:30.490
<v Speaker 0>I'm pretty sure we still have Linux here.

00:17:33.195 --> 00:17:34.315
<v Speaker 0>Copy this.

00:17:35.595 --> 00:17:37.835
<v Speaker 0>Now these are all different operating systems. I

00:17:37.835 --> 00:17:39.514
<v Speaker 0>could use package managers,

00:17:39.914 --> 00:17:41.434
<v Speaker 0>but let's just go with the binary because

00:17:41.434 --> 00:17:42.954
<v Speaker 0>I can copy and paste everything.

00:17:45.115 --> 00:17:47.434
<v Speaker 0>So the first machine I think is that

00:17:47.434 --> 00:17:48.634
<v Speaker 0>we'll test in a second.

00:17:51.480 --> 00:17:53.159
<v Speaker 0>Not

00:17:55.640 --> 00:17:57.799
<v Speaker 0>all of them have it, you name Dashie.

00:17:58.120 --> 00:17:59.639
<v Speaker 0>We have Debian,

00:17:59.960 --> 00:18:00.360
<v Speaker 0>Arch.

00:18:03.255 --> 00:18:05.015
<v Speaker 0>This one should be Red Hat. Let's see,

00:18:05.015 --> 00:18:06.615
<v Speaker 0>DNF. Yeah, cool.

00:18:09.175 --> 00:18:10.935
<v Speaker 0>Okay, so extract,

00:18:11.495 --> 00:18:12.455
<v Speaker 0>Teleport,

00:18:14.775 --> 00:18:15.975
<v Speaker 0>CD Teleport.

00:18:18.830 --> 00:18:20.910
<v Speaker 0>Oh, the first one's not finished yet.

00:18:28.030 --> 00:18:28.910
<v Speaker 0>It's

00:18:28.910 --> 00:18:29.390
<v Speaker 0>gonna work.

00:18:30.045 --> 00:18:31.405
<v Speaker 0>They're a little bit of a sync, but

00:18:31.405 --> 00:18:32.285
<v Speaker 0>we're getting there.

00:18:32.765 --> 00:18:33.405
<v Speaker 0>Cool.

00:18:35.645 --> 00:18:37.005
<v Speaker 0>TCPL.

00:18:39.005 --> 00:18:41.245
<v Speaker 0>Yeah, our first debug machine is lagging a

00:18:41.245 --> 00:18:43.310
<v Speaker 0>little bit, but we get over it. We

00:18:43.310 --> 00:18:45.070
<v Speaker 0>now have Teleport installed all of these now.

00:18:45.070 --> 00:18:46.909
<v Speaker 0>So we can do Teleport.

00:18:47.550 --> 00:18:49.309
<v Speaker 0>We can do Mictur

00:18:49.870 --> 00:18:50.830
<v Speaker 0>Teleport,

00:18:51.230 --> 00:18:52.750
<v Speaker 0>Teleport configure

00:18:53.150 --> 00:18:54.510
<v Speaker 0>to Teleport.

00:18:55.630 --> 00:18:56.430
<v Speaker 0>YAML.

00:18:57.805 --> 00:18:59.085
<v Speaker 0>And this is where I'm really going to

00:18:59.085 --> 00:19:00.605
<v Speaker 0>need them all to be in sync.

00:19:08.445 --> 00:19:09.485
<v Speaker 0>Oh, look at that.

00:19:12.410 --> 00:19:14.009
<v Speaker 0>How does that seg fault?

00:19:20.010 --> 00:19:20.410
<v Speaker 0>What?

00:19:25.195 --> 00:19:25.995
<v Speaker 0>They're all

00:19:26.715 --> 00:19:28.315
<v Speaker 0>X8664.

00:19:30.635 --> 00:19:32.555
<v Speaker 0>I think that Damien machine is going to

00:19:32.555 --> 00:19:33.115
<v Speaker 0>disappear.

00:19:43.130 --> 00:19:45.770
<v Speaker 0>I'm curious about this four nineteen kernel.

00:19:46.170 --> 00:19:47.690
<v Speaker 0>So we're just gonna kill

00:19:47.930 --> 00:19:48.730
<v Speaker 0>Debian one.

00:19:49.684 --> 00:19:51.684
<v Speaker 0>Can I close this without closing them all?

00:19:51.765 --> 00:19:54.085
<v Speaker 0>Yeah, cool. All right, we're going with a

00:19:54.085 --> 00:19:56.485
<v Speaker 0>two node cluster plus the control plane.

00:20:00.325 --> 00:20:01.205
<v Speaker 0>Okay,

00:20:01.205 --> 00:20:03.605
<v Speaker 0>so we are going to remove node names,

00:20:07.080 --> 00:20:08.440
<v Speaker 0>off service,

00:20:12.200 --> 00:20:12.840
<v Speaker 0>no.

00:20:15.720 --> 00:20:17.160
<v Speaker 0>Proxy service,

00:20:18.920 --> 00:20:19.160
<v Speaker 0>no.

00:20:21.565 --> 00:20:23.005
<v Speaker 0>And actually,

00:20:27.805 --> 00:20:29.245
<v Speaker 0>if we come to

00:20:30.525 --> 00:20:31.485
<v Speaker 0>set up,

00:20:33.165 --> 00:20:34.125
<v Speaker 0>and then guides.

00:20:57.565 --> 00:20:58.765
<v Speaker 0>Where's

00:20:58.765 --> 00:20:59.245
<v Speaker 0>the

00:21:08.610 --> 00:21:10.289
<v Speaker 0>I'm going to have to just remember.

00:21:12.850 --> 00:21:14.529
<v Speaker 0>No, it must be an against our ticket.

00:21:14.529 --> 00:21:16.535
<v Speaker 0>So what we're doing next is now that

00:21:16.535 --> 00:21:18.215
<v Speaker 0>we have a conflict where the service is

00:21:18.215 --> 00:21:19.895
<v Speaker 0>disabled that we need is we need to

00:21:19.895 --> 00:21:22.534
<v Speaker 0>then tell Teleport where the off server is.

00:21:25.095 --> 00:21:26.695
<v Speaker 0>It's just something like,

00:21:27.495 --> 00:21:28.695
<v Speaker 0>what's the IP address?

00:21:31.850 --> 00:21:32.570
<v Speaker 0>This

00:21:33.690 --> 00:21:35.130
<v Speaker 0>and a

00:21:35.130 --> 00:21:35.610
<v Speaker 0>token.

00:21:41.145 --> 00:21:43.865
<v Speaker 0>But that tutorial was recorded a couple of

00:21:43.865 --> 00:21:45.865
<v Speaker 0>weeks ago and I don't remember exactly the

00:21:45.865 --> 00:21:47.544
<v Speaker 0>sentence. So let's find it.

00:21:48.425 --> 00:21:49.705
<v Speaker 0>We come here.

00:21:51.305 --> 00:21:53.225
<v Speaker 0>Pretty sure it's in against the Arctic Gate.

00:22:09.745 --> 00:22:11.424
<v Speaker 0>I didn't know if that's the one.

00:22:12.225 --> 00:22:14.705
<v Speaker 0>All right. So we've got a static token.

00:22:17.184 --> 00:22:19.184
<v Speaker 0>Where's the YAML version?

00:22:20.705 --> 00:22:22.545
<v Speaker 0>Off server, okay. So we got that and

00:22:22.545 --> 00:22:24.225
<v Speaker 0>token. Okay, I think I got this right.

00:22:31.930 --> 00:22:33.610
<v Speaker 0>So we've done the server,

00:22:35.530 --> 00:22:37.930
<v Speaker 0>Okay, there we go. Teleport off servers.

00:22:38.265 --> 00:22:41.304
<v Speaker 0>Okay. Close. It's not off server, it's multiples.

00:22:44.105 --> 00:22:45.544
<v Speaker 0>And it's a list.

00:22:47.065 --> 00:22:48.505
<v Speaker 0>And the token

00:22:48.665 --> 00:22:49.784
<v Speaker 0>off token.

00:22:49.785 --> 00:22:51.545
<v Speaker 0>Okay. That was pretty close.

00:22:58.390 --> 00:22:59.830
<v Speaker 0>We can save

00:22:59.990 --> 00:23:00.789
<v Speaker 0>this

00:23:01.750 --> 00:23:04.309
<v Speaker 0>and run Teleport start

00:23:06.070 --> 00:23:07.430
<v Speaker 0>pointing it to our configuration.

00:23:09.235 --> 00:23:10.274
<v Speaker 0>And

00:23:19.395 --> 00:23:19.955
<v Speaker 0>okay.

00:23:22.980 --> 00:23:24.340
<v Speaker 0>So what happened here

00:23:25.060 --> 00:23:25.860
<v Speaker 0>is

00:23:26.100 --> 00:23:29.220
<v Speaker 0>that the X519 certificate that we configured

00:23:29.700 --> 00:23:31.940
<v Speaker 0>on the other site is only for our

00:23:31.940 --> 00:23:33.300
<v Speaker 0>local host. So we need to make one

00:23:33.300 --> 00:23:33.860
<v Speaker 0>more change.

00:23:34.934 --> 00:23:37.254
<v Speaker 0>If we come into our Teleport

00:23:39.335 --> 00:23:40.134
<v Speaker 0>on,

00:23:41.495 --> 00:23:42.774
<v Speaker 0>oh, it's got a

00:23:44.135 --> 00:23:44.774
<v Speaker 0>proxy

00:23:45.895 --> 00:23:47.894
<v Speaker 0>service, the listen address,

00:23:48.054 --> 00:23:50.695
<v Speaker 0>as we can add a web

00:23:50.140 --> 00:23:51.019
<v Speaker 0>listen

00:23:51.820 --> 00:23:52.620
<v Speaker 0>ADR

00:23:53.420 --> 00:23:55.179
<v Speaker 0>and add our

00:23:56.620 --> 00:23:57.659
<v Speaker 0>IP address.

00:23:59.500 --> 00:24:01.260
<v Speaker 0>And I'm going to confirm that that is

00:24:01.260 --> 00:24:02.299
<v Speaker 0>correct

00:24:02.460 --> 00:24:04.220
<v Speaker 0>because I'm sure I'll get that wrong too.

00:24:06.674 --> 00:24:09.315
<v Speaker 0>Web lesson ADR, we've got an example.

00:24:09.554 --> 00:24:10.195
<v Speaker 0>No,

00:24:10.515 --> 00:24:12.515
<v Speaker 0>I can't remember if it includes the port.

00:24:20.830 --> 00:24:21.629
<v Speaker 0>Web

00:24:21.710 --> 00:24:22.669
<v Speaker 0>listen.

00:24:30.830 --> 00:24:31.710
<v Speaker 0>Reference,

00:24:32.945 --> 00:24:34.144
<v Speaker 0>config fail.

00:24:34.465 --> 00:24:36.544
<v Speaker 0>This is my favorite page in the docs.

00:24:36.545 --> 00:24:37.424
<v Speaker 0>There we go.

00:24:37.905 --> 00:24:38.865
<v Speaker 0>So

00:24:38.865 --> 00:24:40.705
<v Speaker 0>if you're ever trying to work at what

00:24:40.705 --> 00:24:42.225
<v Speaker 0>you can and cannot configure,

00:24:42.865 --> 00:24:45.905
<v Speaker 0>what I normally do is

00:24:44.920 --> 00:24:47.400
<v Speaker 0>go to set up reference config file, and

00:24:47.400 --> 00:24:49.880
<v Speaker 0>this is everything the config file accepts with

00:24:49.880 --> 00:24:51.399
<v Speaker 0>some documentation on it.

00:24:52.680 --> 00:24:54.440
<v Speaker 0>You, roughly, I was looking for the web

00:24:54.440 --> 00:24:55.799
<v Speaker 0>lesson ADDR,

00:24:55.800 --> 00:24:58.120
<v Speaker 0>couldn't remember what the thing was here.

00:24:59.305 --> 00:25:00.184
<v Speaker 0>And also

00:25:00.425 --> 00:25:02.745
<v Speaker 0>as a nice reminder, actually there's a public

00:25:02.745 --> 00:25:04.745
<v Speaker 0>address for putting the IP address or a

00:25:04.745 --> 00:25:06.265
<v Speaker 0>host name. So we're actually going to use

00:25:06.265 --> 00:25:08.345
<v Speaker 0>that and not change the web listing address.

00:25:08.825 --> 00:25:09.465
<v Speaker 0>So

00:25:10.425 --> 00:25:11.465
<v Speaker 0>public ADDR,

00:25:16.390 --> 00:25:18.470
<v Speaker 0>We want our IP address, don't need to

00:25:18.470 --> 00:25:19.429
<v Speaker 0>port, I do.

00:25:20.150 --> 00:25:20.789
<v Speaker 0>So

00:25:21.430 --> 00:25:23.190
<v Speaker 0>if we save that configuration,

00:25:23.750 --> 00:25:25.190
<v Speaker 0>we'll restart this process.

00:25:26.125 --> 00:25:27.804
<v Speaker 0>May have to nuke the certs, we're going

00:25:27.804 --> 00:25:30.445
<v Speaker 0>to find out. Where's my terminal gone?

00:25:34.365 --> 00:25:35.245
<v Speaker 0>This one's all right.

00:25:45.470 --> 00:25:48.190
<v Speaker 0>So this is just crashed on me.

00:25:50.590 --> 00:25:52.590
<v Speaker 0>I did not build time into this workshop

00:25:52.590 --> 00:25:53.870
<v Speaker 0>for things to crash on me.

00:26:02.625 --> 00:26:04.385
<v Speaker 0>Have our Teleport.

00:26:06.710 --> 00:26:08.550
<v Speaker 0>Yeah, so there's our PAMs.

00:26:08.550 --> 00:26:09.990
<v Speaker 0>I'm gonna nuke.

00:26:10.070 --> 00:26:10.789
<v Speaker 0>Then

00:26:11.030 --> 00:26:12.549
<v Speaker 0>I'll need to regain my user.

00:26:13.910 --> 00:26:16.070
<v Speaker 0>We're about to start breaking Teleport and see

00:26:16.070 --> 00:26:17.990
<v Speaker 0>what happens. I'm gonna remove the web proxy

00:26:17.990 --> 00:26:19.845
<v Speaker 0>key inserts to see if it will regenerate

00:26:19.845 --> 00:26:21.445
<v Speaker 0>them for me. And I'm going to run

00:26:21.445 --> 00:26:22.565
<v Speaker 0>a Teleport star.

00:26:23.765 --> 00:26:25.765
<v Speaker 0>I'm sure anyone from Teleport watching this is

00:26:25.765 --> 00:26:27.365
<v Speaker 0>like, what the hell are you doing?

00:26:29.525 --> 00:26:32.405
<v Speaker 0>No TLS, keys provided, using self safe. Perfect.

00:26:32.700 --> 00:26:34.299
<v Speaker 0>They're generating new keys.

00:26:38.860 --> 00:26:39.580
<v Speaker 0>Carlos,

00:26:40.059 --> 00:26:42.059
<v Speaker 0>why am I using Vim? Humans can't use

00:26:42.059 --> 00:26:44.139
<v Speaker 0>Vim. Sorry, man. Pico,

00:26:45.179 --> 00:26:46.539
<v Speaker 0>that's a bit old school.

00:26:47.019 --> 00:26:47.740
<v Speaker 0>Okay.

00:26:48.235 --> 00:26:50.315
<v Speaker 0>We've got Teleport running once more. So let's

00:26:50.315 --> 00:26:50.955
<v Speaker 0>try

00:26:51.914 --> 00:26:53.595
<v Speaker 0>starting our agents again.

00:27:02.650 --> 00:27:03.370
<v Speaker 0>What?

00:27:11.690 --> 00:27:14.650
<v Speaker 0>Okay. Why is that not working? Just updated

00:27:14.650 --> 00:27:14.970
<v Speaker 0>that.

00:27:23.455 --> 00:27:25.055
<v Speaker 0>Let's take a look at the cert.

00:27:26.575 --> 00:27:28.415
<v Speaker 0>So we're gonna do v

00:27:28.575 --> 00:27:29.775
<v Speaker 0>https.

00:27:30.175 --> 00:27:32.095
<v Speaker 0>Oh no, v is telling me here, bad

00:27:32.095 --> 00:27:32.495
<v Speaker 0>cert.

00:27:35.299 --> 00:27:36.739
<v Speaker 0>Oh, what have I done?

00:27:40.340 --> 00:27:41.779
<v Speaker 0>Four thirty, eighty.

00:27:44.259 --> 00:27:45.860
<v Speaker 0>It should show me this cert, please.

00:28:05.470 --> 00:28:07.309
<v Speaker 0>Kevin, if you want to write the playbook,

00:28:07.309 --> 00:28:08.510
<v Speaker 0>in fact, I think there is an Ansible

00:28:08.510 --> 00:28:10.510
<v Speaker 0>integration in the documentation that I came across

00:28:10.510 --> 00:28:12.909
<v Speaker 0>at some point, but probably already a thing.

00:28:13.630 --> 00:28:15.309
<v Speaker 0>So here's my server certificate.

00:28:18.325 --> 00:28:20.325
<v Speaker 0>Which just says localhost.

00:28:25.125 --> 00:28:26.885
<v Speaker 0>I haven't had this problem before.

00:28:31.010 --> 00:28:33.730
<v Speaker 0>I'm gonna delete those PAMs again. What have

00:28:33.730 --> 00:28:34.610
<v Speaker 0>I forgotten?

00:28:35.490 --> 00:28:37.090
<v Speaker 0>If it's that node name, I'm going be

00:28:37.090 --> 00:28:38.130
<v Speaker 0>really annoyed with myself.

00:28:42.975 --> 00:28:44.654
<v Speaker 0>Let's use our reference.

00:28:46.815 --> 00:28:48.014
<v Speaker 0>Let's think.

00:28:50.335 --> 00:28:51.295
<v Speaker 0>Serps.

00:29:18.045 --> 00:29:18.445
<v Speaker 0>Okay.

00:29:32.900 --> 00:29:34.820
<v Speaker 0>Let's see what we have.

00:29:44.615 --> 00:29:46.294
<v Speaker 0>We have a listener address and we have

00:29:46.294 --> 00:29:47.494
<v Speaker 0>a public address.

00:29:48.054 --> 00:29:49.735
<v Speaker 0>Oh, wait, that's on the off surface, that's

00:29:49.735 --> 00:29:51.255
<v Speaker 0>not on the

00:29:57.720 --> 00:29:59.559
<v Speaker 0>The proxy. I might have just been a

00:29:59.559 --> 00:30:00.759
<v Speaker 0>complete idiot.

00:30:03.000 --> 00:30:04.919
<v Speaker 0>No. I did it on the proxy service.

00:30:07.135 --> 00:30:08.254
<v Speaker 0>WebListen,

00:30:08.255 --> 00:30:10.655
<v Speaker 0>we don't need because we're doing everything. Public

00:30:10.655 --> 00:30:11.455
<v Speaker 0>address.

00:30:19.535 --> 00:30:20.575
<v Speaker 0>Hey, that looks fine.

00:30:29.159 --> 00:30:30.999
<v Speaker 0>That looks fine.

00:30:33.320 --> 00:30:34.120
<v Speaker 0>Public address.

00:30:45.995 --> 00:30:47.914
<v Speaker 0>Well, it can take a public IP address

00:30:47.914 --> 00:30:49.034
<v Speaker 0>or a DNS name.

00:30:50.770 --> 00:30:52.210
<v Speaker 0>I'm gonna take the hat and re gen

00:30:52.210 --> 00:30:55.090
<v Speaker 0>my user and hope that maybe this is

00:30:55.090 --> 00:30:55.730
<v Speaker 0>just

00:30:57.170 --> 00:30:59.970
<v Speaker 0>something weird and state directory.

00:31:00.930 --> 00:31:03.170
<v Speaker 0>And I am gonna run a Teleport start

00:31:05.144 --> 00:31:06.664
<v Speaker 0>with my config.

00:31:11.465 --> 00:31:13.705
<v Speaker 0>And when I confirm my config flag before

00:31:13.705 --> 00:31:15.544
<v Speaker 0>I mess that up to

00:31:20.000 --> 00:31:21.360
<v Speaker 0>dash c.

00:31:22.320 --> 00:31:24.560
<v Speaker 0>And the default path is etcteleport.

00:31:24.560 --> 00:31:29.200
<v Speaker 0>Yaml. I got that longer anyway. Teleport,

00:31:29.200 --> 00:31:29.840
<v Speaker 0>teleport.

00:31:34.845 --> 00:31:36.445
<v Speaker 0>Generating the search.

00:31:40.925 --> 00:31:42.764
<v Speaker 0>My IP address there is.

00:31:44.205 --> 00:31:46.205
<v Speaker 0>Okay. So my IP address is definitely here.

00:31:47.070 --> 00:31:47.950
<v Speaker 0>Let's try this.

00:32:02.005 --> 00:32:03.445
<v Speaker 0>It's a good thing I like these kinds

00:32:03.445 --> 00:32:05.445
<v Speaker 0>of things. Alright. Carol,

00:32:06.485 --> 00:32:07.445
<v Speaker 0>kv,

00:32:07.685 --> 00:32:08.645
<v Speaker 0>hps,

00:32:11.605 --> 00:32:12.405
<v Speaker 0>p address.

00:32:19.000 --> 00:32:21.159
<v Speaker 0>Done here, 3080.

00:32:23.720 --> 00:32:25.320
<v Speaker 0>So it just says local host.

00:32:29.905 --> 00:32:31.905
<v Speaker 0>But we did see the cert here.

00:32:33.505 --> 00:32:33.905
<v Speaker 0>Ah,

00:32:39.985 --> 00:32:41.585
<v Speaker 0>nice tip there, no no.

00:32:43.230 --> 00:32:44.350
<v Speaker 0>Perhaps the

00:32:44.510 --> 00:32:46.590
<v Speaker 0>servers are cached on the agents.

00:32:53.710 --> 00:32:54.030
<v Speaker 0>No.

00:33:00.525 --> 00:33:02.364
<v Speaker 0>Maybe I should read the error message.

00:33:04.924 --> 00:33:06.525
<v Speaker 0>Okay. I don't wanna see a pen and

00:33:06.525 --> 00:33:08.205
<v Speaker 0>we'll do that in another episode.

00:33:08.605 --> 00:33:10.684
<v Speaker 0>Not sure to establish connection to the cluster.

00:33:15.720 --> 00:33:18.679
<v Speaker 0>If 509 certificate is valid for blah, blah,

00:33:18.679 --> 00:33:19.240
<v Speaker 0>blah, blah, blah, blah.

00:33:24.525 --> 00:33:26.685
<v Speaker 0>So this could, I think I am just

00:33:26.685 --> 00:33:28.525
<v Speaker 0>being really silly here actually.

00:33:30.205 --> 00:33:33.325
<v Speaker 0>Then we changed the public address on the

00:33:33.325 --> 00:33:36.205
<v Speaker 0>proxy service, but the agents connect over the

00:33:36.205 --> 00:33:37.085
<v Speaker 0>off service,

00:33:43.190 --> 00:33:45.909
<v Speaker 0>Not on port 38125.

00:33:52.710 --> 00:33:54.150
<v Speaker 0>Let's just keep deleting stuff.

00:34:12.910 --> 00:34:14.270
<v Speaker 0>Just in case.

00:34:17.310 --> 00:34:20.190
<v Speaker 0>Now this has gone through the 3080 service.

00:34:21.070 --> 00:34:22.670
<v Speaker 0>You know what? I'm going to just tell

00:34:22.670 --> 00:34:24.205
<v Speaker 0>it that I don't care.

00:34:24.445 --> 00:34:27.485
<v Speaker 0>I'm pretty sure there is a teleport

00:34:27.804 --> 00:34:28.765
<v Speaker 0>start

00:34:28.925 --> 00:34:29.804
<v Speaker 0>parameter

00:34:29.804 --> 00:34:30.925
<v Speaker 0>to ignore

00:34:32.125 --> 00:34:33.165
<v Speaker 0>key checks

00:34:33.885 --> 00:34:34.764
<v Speaker 0>and secure.

00:34:39.619 --> 00:34:41.300
<v Speaker 0>Will that get me past it?

00:34:46.900 --> 00:34:47.219
<v Speaker 0>No.

00:35:07.269 --> 00:35:09.349
<v Speaker 0>Okay. That actually did get us past it.

00:35:09.509 --> 00:35:11.910
<v Speaker 0>This is a different error mode saying that

00:35:13.029 --> 00:35:14.150
<v Speaker 0>this node

00:35:15.829 --> 00:35:17.750
<v Speaker 0>cannot join the cluster because the token doesn't

00:35:17.750 --> 00:35:18.710
<v Speaker 0>allow the node role.

00:35:22.484 --> 00:35:23.285
<v Speaker 0>Yep.

00:35:28.164 --> 00:35:30.565
<v Speaker 0>That's because of this string here, which tells

00:35:30.565 --> 00:35:31.205
<v Speaker 0>us

00:35:32.005 --> 00:35:32.724
<v Speaker 0>which

00:35:33.525 --> 00:35:34.404
<v Speaker 0>capabilities

00:35:34.404 --> 00:35:34.964
<v Speaker 0>we have.

00:35:36.609 --> 00:35:37.970
<v Speaker 0>And I think

00:35:37.970 --> 00:35:39.730
<v Speaker 0>if I do node

00:35:48.474 --> 00:35:49.275
<v Speaker 0>Connection.

00:35:49.355 --> 00:35:50.714
<v Speaker 0>Yeah. I'm not gonna tell if we're started.

00:36:01.820 --> 00:36:02.620
<v Speaker 0>Cool.

00:36:04.060 --> 00:36:07.020
<v Speaker 0>So let's talk about what went wrong there

00:36:07.260 --> 00:36:08.940
<v Speaker 0>and why.

00:36:11.820 --> 00:36:14.300
<v Speaker 0>So when we define a static token as

00:36:14.300 --> 00:36:15.580
<v Speaker 0>this in the documentation,

00:36:15.580 --> 00:36:15.820
<v Speaker 0>so

00:36:16.835 --> 00:36:18.195
<v Speaker 0>that would be a bit

00:36:18.674 --> 00:36:22.115
<v Speaker 0>better to reference it instead of here.

00:36:29.474 --> 00:36:31.234
<v Speaker 0>It has different rules.

00:36:35.500 --> 00:36:36.460
<v Speaker 0>Node,

00:36:36.619 --> 00:36:38.540
<v Speaker 0>that's too generic a term.

00:36:38.780 --> 00:36:40.380
<v Speaker 0>It doesn't matter. So

00:36:41.020 --> 00:36:43.099
<v Speaker 0>when you're defining a static token and your

00:36:43.099 --> 00:36:43.980
<v Speaker 0>Teleport

00:36:44.060 --> 00:36:46.380
<v Speaker 0>configuration on the server side, which is this

00:36:46.380 --> 00:36:46.859
<v Speaker 0>one here,

00:36:51.395 --> 00:36:53.475
<v Speaker 0>You put the capabilities

00:36:53.475 --> 00:36:54.995
<v Speaker 0>on the left hand side and then the

00:36:54.995 --> 00:36:56.675
<v Speaker 0>static token on the right hand side. So

00:36:56.675 --> 00:36:58.195
<v Speaker 0>you can have multiple static tokens that give

00:36:58.195 --> 00:37:00.195
<v Speaker 0>different capabilities. One could be to just join

00:37:00.195 --> 00:37:01.395
<v Speaker 0>another cluster,

00:37:01.475 --> 00:37:03.890
<v Speaker 0>one could be trusted cluster, there's proxy, there's

00:37:03.890 --> 00:37:05.410
<v Speaker 0>access for applications,

00:37:05.490 --> 00:37:07.089
<v Speaker 0>etcetera, right? So all these nodes will have

00:37:07.089 --> 00:37:09.330
<v Speaker 0>different capabilities within the Teleport system.

00:37:09.569 --> 00:37:11.970
<v Speaker 0>What I forgot to do was add node.

00:37:11.970 --> 00:37:14.609
<v Speaker 0>So this couldn't join to the cluster and

00:37:14.609 --> 00:37:16.450
<v Speaker 0>join as a node because we never get

00:37:16.450 --> 00:37:18.265
<v Speaker 0>the trusted token that capability.

00:37:19.545 --> 00:37:22.105
<v Speaker 0>So when we restarted it and did it,

00:37:22.105 --> 00:37:24.985
<v Speaker 0>we now have a Teleport cluster. Unfortunately, I

00:37:24.985 --> 00:37:26.985
<v Speaker 0>do now need to recreate my user.

00:37:28.425 --> 00:37:32.025
<v Speaker 0>That's the role, equals admin login, equals root.

00:37:34.250 --> 00:37:35.290
<v Speaker 0>Users.

00:37:40.570 --> 00:37:43.690
<v Speaker 0>Because we set the public address, we no

00:37:43.690 --> 00:37:45.210
<v Speaker 0>longer have to change anything here.

00:37:48.894 --> 00:37:49.695
<v Speaker 0>And

00:37:50.494 --> 00:37:51.695
<v Speaker 0>accept

00:37:51.934 --> 00:37:53.934
<v Speaker 0>provided I just kind of edit the one

00:37:53.934 --> 00:37:56.734
<v Speaker 0>I set up and remove the two FA.

00:37:56.734 --> 00:37:57.934
<v Speaker 0>We can just reuse that.

00:38:03.640 --> 00:38:04.360
<v Speaker 0>So,

00:38:04.760 --> 00:38:06.680
<v Speaker 0>all right, I'm doing that bit off screen.

00:38:07.160 --> 00:38:09.560
<v Speaker 0>That's just where one password popped up. So

00:38:09.560 --> 00:38:11.560
<v Speaker 0>I'm just going to say reuse the password.

00:38:13.080 --> 00:38:14.360
<v Speaker 0>Copy the password.

00:38:16.585 --> 00:38:18.905
<v Speaker 0>While I'm here, I'll tell it to scan.

00:38:22.425 --> 00:38:24.185
<v Speaker 0>Let's copy the code when I did that

00:38:24.185 --> 00:38:26.185
<v Speaker 0>too. Copy password.

00:38:27.625 --> 00:38:27.945
<v Speaker 0>And,

00:38:29.960 --> 00:38:31.160
<v Speaker 0>there we go.

00:38:33.880 --> 00:38:35.320
<v Speaker 0>Okay.

00:38:36.599 --> 00:38:37.720
<v Speaker 0>That was fun.

00:38:39.319 --> 00:38:41.799
<v Speaker 0>So now you'll see that we have our

00:38:41.799 --> 00:38:43.079
<v Speaker 0>total cluster

00:38:43.305 --> 00:38:45.145
<v Speaker 0>with our three nodes available.

00:38:45.145 --> 00:38:46.825
<v Speaker 0>Our host names are about all over the

00:38:46.825 --> 00:38:47.385
<v Speaker 0>shop

00:38:48.025 --> 00:38:50.105
<v Speaker 0>because I thought those were configured by Pulumi

00:38:50.105 --> 00:38:52.585
<v Speaker 0>for me. Clearly I've messed that up, but

00:38:52.585 --> 00:38:53.385
<v Speaker 0>that's okay.

00:38:53.944 --> 00:38:55.944
<v Speaker 0>We have the addresses and we have the

00:38:55.944 --> 00:38:56.265
<v Speaker 0>labels.

00:38:57.020 --> 00:38:59.020
<v Speaker 0>So if we come back to our workshop,

00:38:59.180 --> 00:39:02.460
<v Speaker 0>exercise two after thirty seven minutes is complete.

00:39:04.300 --> 00:39:06.859
<v Speaker 0>So now we are going to add some

00:39:06.859 --> 00:39:09.819
<v Speaker 0>static labels to the Teleport nodes. Labels allow

00:39:09.819 --> 00:39:11.020
<v Speaker 0>us to query

00:39:11.355 --> 00:39:13.755
<v Speaker 0>our infrastructure using the labels. So if we're

00:39:13.755 --> 00:39:16.075
<v Speaker 0>just looking for certain environments and in fact,

00:39:16.075 --> 00:39:18.475
<v Speaker 0>the exercise to hear is like, hey, we're

00:39:18.475 --> 00:39:20.155
<v Speaker 0>actually going to use the same Teleport cluster

00:39:20.155 --> 00:39:23.115
<v Speaker 0>for our staging or QA pre prod testing

00:39:23.115 --> 00:39:23.515
<v Speaker 0>environments.

00:39:24.180 --> 00:39:25.540
<v Speaker 0>So we need labels to be able to

00:39:25.540 --> 00:39:28.020
<v Speaker 0>target and isolate the machines for the things

00:39:28.020 --> 00:39:29.140
<v Speaker 0>that we wish to do.

00:39:32.180 --> 00:39:33.940
<v Speaker 0>So again, we're just going to use the

00:39:33.940 --> 00:39:35.540
<v Speaker 0>documentation whenever possible,

00:39:36.099 --> 00:39:36.820
<v Speaker 0>add labels,

00:39:37.585 --> 00:39:39.745
<v Speaker 0>it's really easy, especially static labels. We're just

00:39:39.745 --> 00:39:40.865
<v Speaker 0>gonna add them to the

00:39:42.465 --> 00:39:44.705
<v Speaker 0>Teleport. Yaml configuration file.

00:39:44.865 --> 00:39:46.305
<v Speaker 0>The syntax for this,

00:39:47.985 --> 00:39:48.465
<v Speaker 0>it's here.

00:39:50.570 --> 00:39:52.330
<v Speaker 0>You can add labels and we can use

00:39:52.330 --> 00:39:53.930
<v Speaker 0>any key values

00:39:53.930 --> 00:39:55.450
<v Speaker 0>that we wish.

00:39:58.090 --> 00:39:59.450
<v Speaker 0>Nice and simple.

00:40:01.130 --> 00:40:03.770
<v Speaker 0>So let's jump over here. The exercise wants

00:40:03.770 --> 00:40:06.455
<v Speaker 0>us to add an environment stage and labels

00:40:06.455 --> 00:40:07.815
<v Speaker 0>to the nodes.

00:40:10.295 --> 00:40:12.375
<v Speaker 0>Carlos is asking what's the trick to type

00:40:12.375 --> 00:40:14.375
<v Speaker 0>on two servers at the same time. So

00:40:14.375 --> 00:40:16.375
<v Speaker 0>this is using iTerm2.

00:40:16.855 --> 00:40:18.375
<v Speaker 0>That just means that I can come to

00:40:18.375 --> 00:40:20.135
<v Speaker 0>Shell

00:40:19.340 --> 00:40:22.620
<v Speaker 0>Broadcast Input and I'm using the Broadcast Input

00:40:22.620 --> 00:40:24.460
<v Speaker 0>to All Panes in the current tab.

00:40:25.100 --> 00:40:28.140
<v Speaker 0>Let's pop open our Teleport configuration.

00:40:30.220 --> 00:40:32.860
<v Speaker 0>We'll use the SSH service. We've already got

00:40:32.860 --> 00:40:34.220
<v Speaker 0>our example label in here.

00:40:35.715 --> 00:40:37.475
<v Speaker 0>We're going to take that off,

00:40:37.795 --> 00:40:38.515
<v Speaker 0>environment

00:40:39.955 --> 00:40:40.755
<v Speaker 0>staging.

00:40:42.515 --> 00:40:45.235
<v Speaker 0>And if we run our Teleport start command

00:40:46.995 --> 00:40:49.235
<v Speaker 0>and jump back over to our web interface,

00:40:53.290 --> 00:40:55.290
<v Speaker 0>You can see we now have environment station

00:40:55.290 --> 00:40:58.330
<v Speaker 0>on each of our agent nodes.

00:41:00.250 --> 00:41:02.650
<v Speaker 0>Okay. Exercise four is going to guide us

00:41:02.650 --> 00:41:04.855
<v Speaker 0>through, not guide us. It wants us to

00:41:04.855 --> 00:41:06.215
<v Speaker 0>do something and hopefully we're gonna do the

00:41:06.215 --> 00:41:09.015
<v Speaker 0>guiding. Going well so far. By exercise four

00:41:09.015 --> 00:41:10.615
<v Speaker 0>is we want to have dynamic labels. And

00:41:10.615 --> 00:41:12.215
<v Speaker 0>this is one of my favorite features in

00:41:12.215 --> 00:41:15.335
<v Speaker 0>Teleport is that you can actually have Teleport

00:41:15.335 --> 00:41:17.255
<v Speaker 0>on a periodic interval

00:41:17.930 --> 00:41:18.730
<v Speaker 0>or

00:41:18.810 --> 00:41:20.810
<v Speaker 0>periodically or on an interval,

00:41:21.370 --> 00:41:23.930
<v Speaker 0>run a command and then use that output

00:41:23.930 --> 00:41:25.690
<v Speaker 0>to work out what the labels should be

00:41:25.690 --> 00:41:27.130
<v Speaker 0>on some of your machines.

00:41:27.290 --> 00:41:28.810
<v Speaker 0>So what we're going to try and do

00:41:28.810 --> 00:41:29.770
<v Speaker 0>with this

00:41:30.170 --> 00:41:30.570
<v Speaker 0>is,

00:41:33.205 --> 00:41:34.405
<v Speaker 0>yeah,

00:41:34.405 --> 00:41:36.165
<v Speaker 0>see you Waleed, catch you next time. And

00:41:36.165 --> 00:41:37.205
<v Speaker 0>what we're going to do with this is

00:41:37.205 --> 00:41:39.045
<v Speaker 0>see if we can add an app NGINX

00:41:39.045 --> 00:41:40.645
<v Speaker 0>when NGINX is running. So we're going to

00:41:40.645 --> 00:41:43.205
<v Speaker 0>actually install NGINX onto one of our agents.

00:41:43.685 --> 00:41:45.710
<v Speaker 0>Another one is to see, well, we actually

00:41:45.710 --> 00:41:47.869
<v Speaker 0>get a counter with the number of users

00:41:47.869 --> 00:41:50.750
<v Speaker 0>that are on the machine presently as a

00:41:50.750 --> 00:41:52.190
<v Speaker 0>label? So we may want to be able

00:41:52.190 --> 00:41:53.869
<v Speaker 0>to try and target machines that have more

00:41:53.869 --> 00:41:55.150
<v Speaker 0>than one active user.

00:41:58.615 --> 00:42:01.255
<v Speaker 0>All right. So dynamic labels are also just

00:42:01.255 --> 00:42:02.535
<v Speaker 0>covered here.

00:42:05.735 --> 00:42:07.495
<v Speaker 0>Think they are labels.

00:42:09.495 --> 00:42:10.775
<v Speaker 0>It's just the one page.

00:42:12.890 --> 00:42:14.010
<v Speaker 0>Here we go.

00:42:14.410 --> 00:42:15.770
<v Speaker 0>Where we can say, okay,

00:42:16.250 --> 00:42:18.090
<v Speaker 0>run these commands.

00:42:18.810 --> 00:42:21.450
<v Speaker 0>Let's copy and paste that as an example.

00:42:23.450 --> 00:42:24.970
<v Speaker 0>Jump over to here. I'm going to turn

00:42:24.970 --> 00:42:25.850
<v Speaker 0>off my broadcast.

00:42:28.405 --> 00:42:29.765
<v Speaker 0>In fact, no, we'll add

00:42:30.405 --> 00:42:32.485
<v Speaker 0>the user counter first. In fact, we'll add

00:42:32.485 --> 00:42:33.685
<v Speaker 0>plus that. We're going to add all the

00:42:33.685 --> 00:42:34.405
<v Speaker 0>labels.

00:42:34.565 --> 00:42:35.685
<v Speaker 0>That's what we're doing.

00:42:36.405 --> 00:42:38.325
<v Speaker 0>There's something to here. We're going to go

00:42:38.325 --> 00:42:40.085
<v Speaker 0>to SSH. You can see we've already got

00:42:40.085 --> 00:42:41.525
<v Speaker 0>a host name one here anyway.

00:42:43.040 --> 00:42:44.480
<v Speaker 0>So we'll say name,

00:42:45.040 --> 00:42:46.000
<v Speaker 0>nginx.

00:42:47.440 --> 00:42:49.120
<v Speaker 0>The command is,

00:42:49.760 --> 00:42:51.680
<v Speaker 0>well, we don't know what that is yet.

00:42:52.400 --> 00:42:53.599
<v Speaker 0>We've got a period.

00:42:56.255 --> 00:42:59.135
<v Speaker 0>So for NGINX, we actually specify in the

00:42:59.135 --> 00:43:01.375
<v Speaker 0>workshop that we want this updated every fifteen

00:43:01.375 --> 00:43:02.095
<v Speaker 0>minutes.

00:43:02.735 --> 00:43:05.455
<v Speaker 0>We don't really expect NGINX to disappear,

00:43:05.535 --> 00:43:06.655
<v Speaker 0>so we don't have to run it as

00:43:06.655 --> 00:43:07.055
<v Speaker 0>frequently.

00:43:09.470 --> 00:43:10.990
<v Speaker 0>What we're going to do here

00:43:11.230 --> 00:43:12.990
<v Speaker 0>is check for

00:43:16.030 --> 00:43:17.790
<v Speaker 0>ES, AUX,

00:43:18.270 --> 00:43:19.230
<v Speaker 0>grep,

00:43:20.510 --> 00:43:21.310
<v Speaker 0>NGINX.

00:43:22.265 --> 00:43:24.025
<v Speaker 0>That's always gonna return.

00:43:24.185 --> 00:43:25.705
<v Speaker 0>See, I came up with these challenges and

00:43:25.705 --> 00:43:26.905
<v Speaker 0>didn't actually think about how I was gonna

00:43:26.905 --> 00:43:27.785
<v Speaker 0>complete them.

00:43:28.905 --> 00:43:29.945
<v Speaker 0>We can do

00:43:32.985 --> 00:43:34.745
<v Speaker 0>p grep nginx.

00:43:34.985 --> 00:43:36.265
<v Speaker 0>That should work, right?

00:43:36.745 --> 00:43:39.630
<v Speaker 0>Let's test it. P grep nginx,

00:43:39.630 --> 00:43:40.670
<v Speaker 0>not running.

00:43:40.990 --> 00:43:42.270
<v Speaker 0>And so for one,

00:43:42.510 --> 00:43:44.030
<v Speaker 0>p grep, p grep.

00:43:46.190 --> 00:43:47.710
<v Speaker 0>Oh, maybe it didn't find it because I'm

00:43:47.710 --> 00:43:49.950
<v Speaker 0>in the process. P grep Teleport.

00:43:51.995 --> 00:43:53.195
<v Speaker 0>There we go. Perfect.

00:43:54.635 --> 00:43:56.395
<v Speaker 0>So let's do it what we want.

00:43:57.995 --> 00:43:59.275
<v Speaker 0>And now we need one more.

00:44:09.460 --> 00:44:11.859
<v Speaker 0>This is our user

00:44:12.740 --> 00:44:13.700
<v Speaker 0>account.

00:44:15.059 --> 00:44:16.900
<v Speaker 0>Let's run this every,

00:44:17.220 --> 00:44:18.579
<v Speaker 0>what does the workshop say?

00:44:19.235 --> 00:44:20.515
<v Speaker 0>Thirty seconds.

00:44:23.155 --> 00:44:24.595
<v Speaker 0>We want to execute.

00:44:27.155 --> 00:44:29.875
<v Speaker 0>Okay. User account. So we could do who,

00:44:30.835 --> 00:44:31.955
<v Speaker 0>wc dash l.

00:44:34.090 --> 00:44:35.530
<v Speaker 0>So who

00:44:36.010 --> 00:44:36.810
<v Speaker 0>wc

00:44:36.810 --> 00:44:38.170
<v Speaker 0>l.

00:44:38.410 --> 00:44:39.530
<v Speaker 0>Excuse me.

00:44:41.290 --> 00:44:44.330
<v Speaker 0>Let's save that from Teleport start.

00:44:45.744 --> 00:44:49.105
<v Speaker 0>Broke it. Oh, and the syntax is

00:44:55.665 --> 00:44:57.025
<v Speaker 0>Good point, but I'll even be able to

00:44:57.025 --> 00:44:57.665
<v Speaker 0>do a tape.

00:45:05.930 --> 00:45:06.890
<v Speaker 0>Let's try.

00:45:10.970 --> 00:45:11.849
<v Speaker 0>That's one.

00:45:14.735 --> 00:45:16.975
<v Speaker 0>So that's definitely gonna fix the PGRAPH.

00:45:16.975 --> 00:45:18.575
<v Speaker 0>I'm not sure if the Who is gonna

00:45:18.575 --> 00:45:19.295
<v Speaker 0>work.

00:45:24.895 --> 00:45:25.935
<v Speaker 0>Yeah. Okay.

00:45:30.550 --> 00:45:32.790
<v Speaker 0>Okay. How can we do that without piping?

00:45:37.830 --> 00:45:40.310
<v Speaker 0>Does wc take a command parameter?

00:45:45.964 --> 00:45:48.125
<v Speaker 0>No. Okay. So we could always try and

00:45:48.125 --> 00:45:49.964
<v Speaker 0>cheat. Thought, see, I don't really know how

00:45:49.964 --> 00:45:52.684
<v Speaker 0>Teleport does

00:45:52.684 --> 00:45:55.405
<v Speaker 0>this. So what we could do

00:45:57.290 --> 00:45:59.850
<v Speaker 0>is WC does work with standard input.

00:46:01.690 --> 00:46:03.050
<v Speaker 0>And I'm curious,

00:46:03.690 --> 00:46:04.570
<v Speaker 0>like if we do,

00:46:12.885 --> 00:46:15.365
<v Speaker 0>So it takes a fail doesn't it? Okay.

00:46:19.365 --> 00:46:20.484
<v Speaker 0>User can.

00:46:24.539 --> 00:46:25.740
<v Speaker 0>And that's the way I know how to

00:46:25.740 --> 00:46:26.380
<v Speaker 0>do it.

00:46:31.260 --> 00:46:32.220
<v Speaker 0>Oh, there we go.

00:46:36.845 --> 00:46:37.805
<v Speaker 0>And

00:46:37.805 --> 00:46:39.805
<v Speaker 0>we've got users equals two.

00:46:41.805 --> 00:46:43.325
<v Speaker 0>Short version.

00:46:44.765 --> 00:46:46.285
<v Speaker 0>That doesn't add anything.

00:46:54.220 --> 00:46:55.740
<v Speaker 0>Let's just go with it.

00:46:58.940 --> 00:47:00.540
<v Speaker 0>Who does queue.

00:47:04.220 --> 00:47:06.220
<v Speaker 0>Oh, and I got this syntax wrong again.

00:47:08.995 --> 00:47:10.115
<v Speaker 0>Little better.

00:47:13.315 --> 00:47:15.235
<v Speaker 0>Okay. So we're still getting something about an

00:47:15.235 --> 00:47:17.395
<v Speaker 0>up label field to update, but let's just

00:47:17.395 --> 00:47:18.995
<v Speaker 0>ignore that for now and see what we've

00:47:18.995 --> 00:47:19.155
<v Speaker 0>got.

00:47:21.990 --> 00:47:23.510
<v Speaker 0>Hey, look at that. We do have a

00:47:23.510 --> 00:47:25.270
<v Speaker 0>user account, which is cool.

00:47:25.830 --> 00:47:28.950
<v Speaker 0>However, we can exit status one on NGINX.

00:47:29.190 --> 00:47:30.870
<v Speaker 0>Yeah, that's failing because

00:47:30.950 --> 00:47:32.310
<v Speaker 0>NGINX isn't running.

00:47:34.615 --> 00:47:35.495
<v Speaker 0>Okay,

00:47:35.495 --> 00:47:37.175
<v Speaker 0>so we're going to install NGINX on one

00:47:37.175 --> 00:47:38.295
<v Speaker 0>of these machines.

00:47:40.375 --> 00:47:42.535
<v Speaker 0>So now I do need to disable

00:47:42.535 --> 00:47:43.335
<v Speaker 0>broadcast.

00:47:48.130 --> 00:47:49.650
<v Speaker 0>And this is, I think this is the

00:47:49.650 --> 00:47:50.370
<v Speaker 0>red hot one.

00:48:04.445 --> 00:48:05.245
<v Speaker 0>Cool.

00:48:06.285 --> 00:48:08.365
<v Speaker 0>So I'm going to rebroadcast

00:48:12.240 --> 00:48:13.280
<v Speaker 0>and

00:48:13.360 --> 00:48:14.160
<v Speaker 0>start.

00:48:16.080 --> 00:48:17.760
<v Speaker 0>Oh, it didn't run it here. We don't

00:48:17.760 --> 00:48:19.520
<v Speaker 0>really need to do it that often anyway,

00:48:19.520 --> 00:48:19.680
<v Speaker 0>so

00:48:23.120 --> 00:48:23.920
<v Speaker 0>and

00:48:26.955 --> 00:48:27.995
<v Speaker 0>there we go.

00:48:28.875 --> 00:48:30.235
<v Speaker 0>It's a bit hacky,

00:48:31.115 --> 00:48:33.275
<v Speaker 0>but we do have the user account on

00:48:33.435 --> 00:48:34.555
<v Speaker 0>both of these

00:48:35.195 --> 00:48:36.795
<v Speaker 0>machines as labels.

00:48:37.195 --> 00:48:38.875
<v Speaker 0>We see it NGINX is running here and

00:48:38.875 --> 00:48:40.235
<v Speaker 0>we have a PET, we have an error

00:48:40.235 --> 00:48:40.555
<v Speaker 0>here.

00:48:42.110 --> 00:48:44.190
<v Speaker 0>So I could always just tell pcrep not

00:48:44.190 --> 00:48:45.230
<v Speaker 0>to care

00:48:49.230 --> 00:48:49.950
<v Speaker 0>about

00:48:51.630 --> 00:48:52.910
<v Speaker 0>the exit code.

00:49:07.895 --> 00:49:09.175
<v Speaker 0>Or maybe you can't.

00:49:14.300 --> 00:49:15.340
<v Speaker 0>Not important.

00:49:16.700 --> 00:49:18.620
<v Speaker 0>Oh, my broadcast is working again.

00:49:21.340 --> 00:49:23.900
<v Speaker 0>Okay. What about pgrep dash cam internet?

00:49:24.585 --> 00:49:26.025
<v Speaker 0>Here we go. It's either one or two

00:49:26.025 --> 00:49:27.785
<v Speaker 0>there. That's a bit nicer. So let's do

00:49:27.785 --> 00:49:28.345
<v Speaker 0>that.

00:49:29.385 --> 00:49:30.505
<v Speaker 0>And then we'll move on to the next

00:49:30.505 --> 00:49:32.905
<v Speaker 0>exercise because this is not terribly important. I'm

00:49:32.905 --> 00:49:33.465
<v Speaker 0>just

00:49:34.265 --> 00:49:35.065
<v Speaker 0>having fun.

00:49:46.390 --> 00:49:49.030
<v Speaker 0>There we go. So we got NGINX with

00:49:49.030 --> 00:49:50.470
<v Speaker 0>an output of zero. We still get an

00:49:50.470 --> 00:49:51.030
<v Speaker 0>exit code.

00:49:52.035 --> 00:49:53.954
<v Speaker 0>I'm sure I can silence that somehow. And

00:49:53.954 --> 00:49:55.555
<v Speaker 0>we got our user account over here and

00:49:55.555 --> 00:49:57.315
<v Speaker 0>we've got two NGINX processes here.

00:49:57.795 --> 00:49:59.475
<v Speaker 0>So the whole point of the exercise

00:50:00.035 --> 00:50:02.035
<v Speaker 0>is to show how you can run arbitrary

00:50:02.035 --> 00:50:04.755
<v Speaker 0>commands on an interval, pull them onto your

00:50:04.755 --> 00:50:06.480
<v Speaker 0>labels. And then as we move through the

00:50:06.480 --> 00:50:08.160
<v Speaker 0>other exercises, we'll see how we can use

00:50:08.160 --> 00:50:10.640
<v Speaker 0>that as part of our QWERTY and command

00:50:10.640 --> 00:50:12.400
<v Speaker 0>execution criteria.

00:50:15.040 --> 00:50:16.800
<v Speaker 0>All right, exercise five is we're going to

00:50:16.800 --> 00:50:18.400
<v Speaker 0>sprinkle some eBPF dust.

00:50:18.965 --> 00:50:20.565
<v Speaker 0>So I'm kind of glad we kicked out

00:50:20.565 --> 00:50:22.805
<v Speaker 0>that debugging machine running the four nineteen kernel.

00:50:22.805 --> 00:50:24.085
<v Speaker 0>I'm not sure how that would have fared

00:50:24.085 --> 00:50:24.645
<v Speaker 0>here,

00:50:25.045 --> 00:50:27.525
<v Speaker 0>but we can enable enhanced recording on our

00:50:27.525 --> 00:50:28.245
<v Speaker 0>notes

00:50:28.565 --> 00:50:30.165
<v Speaker 0>and check out some of the cool things

00:50:30.165 --> 00:50:31.525
<v Speaker 0>that that does. So

00:50:32.700 --> 00:50:35.260
<v Speaker 0>again, we want to jump over. I'm just

00:50:35.260 --> 00:50:36.540
<v Speaker 0>going to do this on agents. We're not

00:50:36.540 --> 00:50:38.220
<v Speaker 0>too fussed about the server.

00:50:38.620 --> 00:50:40.540
<v Speaker 0>We're gonna make a change to our Teleport

00:50:40.540 --> 00:50:41.500
<v Speaker 0>configuration.

00:50:42.220 --> 00:50:43.660
<v Speaker 0>We're gonna rely on the docs to do

00:50:43.660 --> 00:50:46.300
<v Speaker 0>that, of course. So we search for enhanced

00:50:47.225 --> 00:50:48.505
<v Speaker 0>session recording,

00:50:49.065 --> 00:50:51.705
<v Speaker 0>this changes the way that Teleport does session

00:50:51.705 --> 00:50:52.985
<v Speaker 0>recording. And we'll take a look at what

00:50:52.985 --> 00:50:54.905
<v Speaker 0>that actually is, but let's get the enhancements

00:50:54.905 --> 00:50:55.865
<v Speaker 0>on first.

00:50:56.665 --> 00:50:58.345
<v Speaker 0>And that means we can actually see all

00:50:58.345 --> 00:51:01.065
<v Speaker 0>of the commands executed on logged and auditable

00:51:01.065 --> 00:51:02.505
<v Speaker 0>sessions that Teleport provides.

00:51:04.000 --> 00:51:05.680
<v Speaker 0>In order to turn this on, if we

00:51:05.680 --> 00:51:06.800
<v Speaker 0>go to here

00:51:07.279 --> 00:51:10.480
<v Speaker 0>and we add enhanced recording enabled true to

00:51:10.480 --> 00:51:11.920
<v Speaker 0>our SSH service.

00:51:13.359 --> 00:51:15.359
<v Speaker 0>SSH,

00:51:17.345 --> 00:51:18.305
<v Speaker 0>Let me see.

00:51:19.744 --> 00:51:20.464
<v Speaker 0>Enhanced

00:51:21.025 --> 00:51:21.984
<v Speaker 0>recording.

00:51:24.464 --> 00:51:25.025
<v Speaker 0>Yes.

00:51:27.184 --> 00:51:28.545
<v Speaker 0>Oh, not enabled.

00:51:30.704 --> 00:51:31.265
<v Speaker 0>Enabled,

00:51:32.020 --> 00:51:32.660
<v Speaker 0>yes.

00:51:33.700 --> 00:51:35.620
<v Speaker 0>And then if we restart Teleport,

00:51:35.700 --> 00:51:36.420
<v Speaker 0>oh.

00:51:41.700 --> 00:51:42.820
<v Speaker 0>No BPF.

00:51:47.195 --> 00:51:48.075
<v Speaker 0>Darn it.

00:51:54.475 --> 00:51:55.355
<v Speaker 0>514,

00:51:55.355 --> 00:51:56.075
<v Speaker 0>5 13.

00:51:59.590 --> 00:52:01.030
<v Speaker 0>That should be all right.

00:52:03.350 --> 00:52:04.310
<v Speaker 0>58.

00:52:10.710 --> 00:52:12.550
<v Speaker 0>Now this I have tested before.

00:52:13.845 --> 00:52:15.765
<v Speaker 0>So that's very disappointing.

00:52:22.244 --> 00:52:23.845
<v Speaker 0>We do have secret V2.

00:52:29.230 --> 00:52:30.510
<v Speaker 0>That should have worked.

00:52:33.069 --> 00:52:35.869
<v Speaker 0>Kevin saying enabling BPF on Red Hat could

00:52:35.869 --> 00:52:37.230
<v Speaker 0>be a bit annoying.

00:52:37.789 --> 00:52:39.549
<v Speaker 0>Yeah, I'm not entirely sure. I mean, one

00:52:39.549 --> 00:52:40.589
<v Speaker 0>of these machines is Arch.

00:52:41.015 --> 00:52:43.575
<v Speaker 0>So I actually think that's maybe something

00:52:43.735 --> 00:52:46.135
<v Speaker 0>that Linode are doing with our kernels on

00:52:46.135 --> 00:52:47.415
<v Speaker 0>the VM images

00:52:51.655 --> 00:52:54.375
<v Speaker 0>rather than operating system specific,

00:52:55.650 --> 00:52:58.130
<v Speaker 0>But definitely as in field to load BPF

00:52:58.130 --> 00:52:58.690
<v Speaker 0>object.

00:53:17.815 --> 00:53:19.655
<v Speaker 0>Let's see what this I mean, I'm not

00:53:19.655 --> 00:53:20.375
<v Speaker 0>really

00:53:22.470 --> 00:53:23.830
<v Speaker 0>I still have to spend a few minutes

00:53:23.830 --> 00:53:25.430
<v Speaker 0>looking to see what the problem is.

00:53:35.234 --> 00:53:36.035
<v Speaker 0>This is just

00:53:56.819 --> 00:53:58.420
<v Speaker 0>Okay, I'm trying to do just like this

00:53:58.420 --> 00:54:00.420
<v Speaker 0>is a little old kernel thing. And I

00:54:00.420 --> 00:54:01.380
<v Speaker 0>don't know

00:54:04.095 --> 00:54:05.855
<v Speaker 0>if I wanna try and fix this.

00:54:16.950 --> 00:54:18.470
<v Speaker 0>So that's unfortunate.

00:54:20.470 --> 00:54:22.150
<v Speaker 0>They have not had this working on Delta

00:54:22.150 --> 00:54:22.470
<v Speaker 0>Evolution.

00:54:36.005 --> 00:54:37.845
<v Speaker 0>Let's just try adding the secret path just

00:54:37.845 --> 00:54:40.325
<v Speaker 0>in case. But the default value is

00:54:41.605 --> 00:54:42.085
<v Speaker 0>correct.

00:54:44.540 --> 00:54:45.340
<v Speaker 0>Darn it.

00:54:48.619 --> 00:54:49.820
<v Speaker 0>Okay.

00:54:50.140 --> 00:54:51.980
<v Speaker 0>We're gonna skip this one. I'll do another

00:54:51.980 --> 00:54:54.620
<v Speaker 0>tutorial on this with machines that I know

00:54:54.700 --> 00:54:56.460
<v Speaker 0>have BPF enabled in the kernel.

00:54:56.780 --> 00:54:59.580
<v Speaker 0>However, what this does is actually uses BPF

00:54:59.580 --> 00:55:00.140
<v Speaker 0>probes

00:55:01.475 --> 00:55:03.555
<v Speaker 0>to record the sessions, which means you actually

00:55:03.555 --> 00:55:05.155
<v Speaker 0>see the system calls, the commands that are

00:55:05.155 --> 00:55:07.315
<v Speaker 0>being executed, parameters have been passed to them,

00:55:07.315 --> 00:55:09.715
<v Speaker 0>the observability and visibility into what's happening on

00:55:09.715 --> 00:55:11.795
<v Speaker 0>your server is much greater than what you

00:55:11.795 --> 00:55:12.835
<v Speaker 0>get by default.

00:55:12.915 --> 00:55:12.995
<v Speaker 0>So,

00:55:14.230 --> 00:55:17.190
<v Speaker 0>okay. So exercise six is managing users. We

00:55:17.190 --> 00:55:19.110
<v Speaker 0>want to create a new user called Leet

00:55:19.110 --> 00:55:19.750
<v Speaker 0>with

00:55:19.910 --> 00:55:21.910
<v Speaker 0>the admin role, which has access to all

00:55:21.910 --> 00:55:22.310
<v Speaker 0>nodes.

00:55:27.415 --> 00:55:29.494
<v Speaker 0>We've kind of seen this already because I

00:55:29.494 --> 00:55:31.015
<v Speaker 0>had to create my root user. So we

00:55:31.015 --> 00:55:32.455
<v Speaker 0>can do a TCL tool,

00:55:33.015 --> 00:55:33.815
<v Speaker 0>TCCL

00:55:33.815 --> 00:55:34.935
<v Speaker 0>users add.

00:55:36.695 --> 00:55:38.135
<v Speaker 0>This takes a whole bunch of parameters.

00:55:39.160 --> 00:55:39.960
<v Speaker 0>Now,

00:55:40.520 --> 00:55:43.480
<v Speaker 0>I'm only going to cover roles and logins

00:55:43.480 --> 00:55:45.640
<v Speaker 0>a little bit in this workshop. We have

00:55:45.640 --> 00:55:47.560
<v Speaker 0>an entire workshop dedicated to a deep dive

00:55:47.560 --> 00:55:48.520
<v Speaker 0>on roles.

00:55:49.240 --> 00:55:51.720
<v Speaker 0>Essentially, there are some preset roles that come

00:55:51.720 --> 00:55:52.760
<v Speaker 0>with Web Teleport.

00:55:54.265 --> 00:55:56.265
<v Speaker 0>Admin gives you access to everything.

00:55:56.505 --> 00:55:57.865
<v Speaker 0>There's also editor,

00:55:58.425 --> 00:55:59.225
<v Speaker 0>auditor

00:55:59.945 --> 00:56:01.305
<v Speaker 0>and access.

00:56:01.385 --> 00:56:03.385
<v Speaker 0>Access would just give you the ability to

00:56:03.385 --> 00:56:05.545
<v Speaker 0>kind of SSH across the nodes. Auditor gives

00:56:05.545 --> 00:56:08.345
<v Speaker 0>you the ability to

00:56:07.230 --> 00:56:08.990
<v Speaker 0>audit stuff for the UI

00:56:09.310 --> 00:56:11.310
<v Speaker 0>and then just edit an admin, which exposes

00:56:11.310 --> 00:56:14.670
<v Speaker 0>more ability to create users, manage users, etcetera.

00:56:15.310 --> 00:56:16.830
<v Speaker 0>So for now, we're just going to do

00:56:16.830 --> 00:56:17.870
<v Speaker 0>roles admin,

00:56:17.950 --> 00:56:18.990
<v Speaker 0>logins is

00:56:19.704 --> 00:56:22.665
<v Speaker 0>which logins we want to allow access to

00:56:22.665 --> 00:56:23.785
<v Speaker 0>on the machines.

00:56:27.464 --> 00:56:30.265
<v Speaker 0>So I'm not, again, I'm using Linode because

00:56:31.569 --> 00:56:34.210
<v Speaker 0>it's fast and cheap, but I'm not sure

00:56:34.369 --> 00:56:36.450
<v Speaker 0>how their emojis are configured.

00:56:36.609 --> 00:56:38.049
<v Speaker 0>I'm very quickly going to take a look

00:56:38.049 --> 00:56:39.089
<v Speaker 0>at the shadow file.

00:56:45.355 --> 00:56:47.755
<v Speaker 0>I think we only get on the Red

00:56:47.755 --> 00:56:49.515
<v Speaker 0>Hat image. I don't see

00:56:50.714 --> 00:56:53.194
<v Speaker 0>another one on Arch. We don't really get

00:56:53.194 --> 00:56:54.954
<v Speaker 0>any other users either. Okay. So we're only

00:56:54.954 --> 00:56:57.070
<v Speaker 0>actually getting I was expecting to see like

00:56:57.070 --> 00:56:58.750
<v Speaker 0>a boon to, or maybe we see

00:56:59.630 --> 00:57:01.950
<v Speaker 0>CentOS or to see Red Hat or some

00:57:01.950 --> 00:57:04.750
<v Speaker 0>non privileged user. Again, this is just image

00:57:04.750 --> 00:57:06.829
<v Speaker 0>configuration. So we'll just get root access right

00:57:06.829 --> 00:57:07.310
<v Speaker 0>now.

00:57:08.589 --> 00:57:10.190
<v Speaker 0>There and we can provide the name, which

00:57:10.190 --> 00:57:12.275
<v Speaker 0>we said we want to delete and like

00:57:12.275 --> 00:57:14.675
<v Speaker 0>so. We have now created a new user.

00:57:16.435 --> 00:57:18.355
<v Speaker 0>Now we can delete the user. So we

00:57:18.355 --> 00:57:20.595
<v Speaker 0>want to just show that command. So we'll

00:57:20.595 --> 00:57:21.795
<v Speaker 0>just do users

00:57:21.795 --> 00:57:23.395
<v Speaker 0>and you can just get all the subcommand

00:57:23.395 --> 00:57:25.610
<v Speaker 0>help by running dash help

00:57:26.090 --> 00:57:28.170
<v Speaker 0>and we can delete like so.

00:57:29.850 --> 00:57:33.530
<v Speaker 0>Next, create a new access user called PON.

00:57:33.530 --> 00:57:36.490
<v Speaker 0>This time we're going to modify the TTL

00:57:36.490 --> 00:57:37.450
<v Speaker 0>of forty eight hours.

00:57:38.214 --> 00:57:39.815
<v Speaker 0>And I'll talk about that in a minute

00:57:39.815 --> 00:57:41.655
<v Speaker 0>as I kind of explain what the invitations

00:57:41.655 --> 00:57:42.615
<v Speaker 0>actually do.

00:57:42.855 --> 00:57:45.095
<v Speaker 0>And then I said standard users with all

00:57:45.095 --> 00:57:46.935
<v Speaker 0>nodes, obviously me just looking to use Ubuntu

00:57:46.935 --> 00:57:48.855
<v Speaker 0>or that non root username,

00:57:48.935 --> 00:57:50.375
<v Speaker 0>which we don't have on these images.

00:57:51.050 --> 00:57:53.770
<v Speaker 0>So we're going to do pawn

00:57:53.850 --> 00:57:55.770
<v Speaker 0>TTL and I'll talk about that in a

00:57:55.770 --> 00:57:56.330
<v Speaker 0>moment.

00:57:56.890 --> 00:57:59.050
<v Speaker 0>And we want roles,

00:57:59.050 --> 00:57:59.770
<v Speaker 0>access,

00:58:00.170 --> 00:58:01.930
<v Speaker 0>logins, and I'm just going to do root

00:58:01.930 --> 00:58:02.970
<v Speaker 0>for today's workshop.

00:58:04.865 --> 00:58:07.105
<v Speaker 0>Okay, so what does the TTL mean? Well,

00:58:07.105 --> 00:58:09.585
<v Speaker 0>when you create an invite and you distribute

00:58:09.585 --> 00:58:11.345
<v Speaker 0>this link to someone, it's only gonna be

00:58:11.345 --> 00:58:12.945
<v Speaker 0>valid for a short period of time. By

00:58:12.945 --> 00:58:14.385
<v Speaker 0>default, I think it was one or two

00:58:14.385 --> 00:58:16.305
<v Speaker 0>hours. In fact, if we scroll up to

00:58:16.305 --> 00:58:17.185
<v Speaker 0>delete user,

00:58:22.390 --> 00:58:23.190
<v Speaker 0>whatever.

00:58:24.230 --> 00:58:25.670
<v Speaker 0>But that may not be long enough, you

00:58:25.670 --> 00:58:26.950
<v Speaker 0>don't know when the person's going to get

00:58:26.950 --> 00:58:28.630
<v Speaker 0>to it. The highest you can set it

00:58:28.630 --> 00:58:30.550
<v Speaker 0>to is forty eight hours, which is that

00:58:30.550 --> 00:58:32.775
<v Speaker 0>as an example, but it just means that

00:58:32.775 --> 00:58:35.095
<v Speaker 0>user has forty hours to accept this invitation,

00:58:35.095 --> 00:58:37.015
<v Speaker 0>create their account and have access to the

00:58:37.015 --> 00:58:37.655
<v Speaker 0>system.

00:58:38.775 --> 00:58:40.375
<v Speaker 0>Because this one is

00:58:40.615 --> 00:58:42.615
<v Speaker 0>access roles, the UI will be a little

00:58:42.615 --> 00:58:44.694
<v Speaker 0>bit different for them. So I'm actually going

00:58:44.694 --> 00:58:46.375
<v Speaker 0>to sign up as this user.

00:58:53.910 --> 00:58:55.910
<v Speaker 0>And we'll accept this again.

00:58:59.030 --> 00:59:00.869
<v Speaker 0>Let me reuse my password because I'm a

00:59:00.869 --> 00:59:01.750
<v Speaker 0>terrible human being.

00:59:04.145 --> 00:59:06.305
<v Speaker 0>Very weird thing to call myself actually.

00:59:09.105 --> 00:59:11.105
<v Speaker 0>And we're going to add our second to

00:59:11.105 --> 00:59:12.705
<v Speaker 0>FAQ this time.

00:59:14.305 --> 00:59:16.065
<v Speaker 0>Let's do edit first and rename the first

00:59:16.065 --> 00:59:16.305
<v Speaker 0>one.

00:59:22.080 --> 00:59:24.560
<v Speaker 0>Okay, so this is Rawkode

00:59:28.160 --> 00:59:29.920
<v Speaker 0>So I did that all screen, but when

00:59:29.920 --> 00:59:31.200
<v Speaker 0>I click this again, you'll see that I

00:59:31.200 --> 00:59:32.160
<v Speaker 0>just renamed

00:59:32.535 --> 00:59:35.335
<v Speaker 0>this Rawkode 2FE so that when I scan,

00:59:35.895 --> 00:59:38.214
<v Speaker 0>we're going to get Pawn 2FE. Well, it

00:59:38.214 --> 00:59:39.255
<v Speaker 0>won't be called that,

00:59:40.694 --> 00:59:42.295
<v Speaker 0>there we go. We get the other one

00:59:42.295 --> 00:59:42.775
<v Speaker 0>here.

00:59:43.255 --> 00:59:45.180
<v Speaker 0>So we can drop that in. We now

00:59:45.180 --> 00:59:47.020
<v Speaker 0>have a pawn user,

00:59:47.180 --> 00:59:48.780
<v Speaker 0>which has limited

00:59:48.780 --> 00:59:49.740
<v Speaker 0>access.

00:59:53.900 --> 00:59:55.900
<v Speaker 0>Oh, I don't expect the auto tool. What

00:59:55.900 --> 00:59:56.380
<v Speaker 0>did I do?

01:00:00.875 --> 01:00:02.475
<v Speaker 0>Alright, back to the moment.

01:00:02.715 --> 01:00:04.395
<v Speaker 0>So now we created that user.

01:00:05.035 --> 01:00:06.715
<v Speaker 0>Where are we? Oh, we're in our end.

01:00:06.715 --> 01:00:07.675
<v Speaker 0>Crap, okay.

01:00:08.555 --> 01:00:10.555
<v Speaker 0>So we want to use the SSH via

01:00:10.555 --> 01:00:12.635
<v Speaker 0>the user. Basically, just want to run who

01:00:12.635 --> 01:00:14.235
<v Speaker 0>am I who and last on

01:00:14.760 --> 01:00:17.000
<v Speaker 0>one or each of the nodes. So we'll

01:00:17.000 --> 01:00:18.040
<v Speaker 0>refresh this,

01:00:19.320 --> 01:00:21.480
<v Speaker 0>bring up those Teleport starts again.

01:00:25.960 --> 01:00:27.000
<v Speaker 0>Oh, that's the server.

01:00:34.744 --> 01:00:36.745
<v Speaker 0>There

01:00:39.225 --> 01:00:39.625
<v Speaker 0>we go.

01:00:42.780 --> 01:00:44.220
<v Speaker 0>Okay, so we got our knowns back. So

01:00:44.220 --> 01:00:46.300
<v Speaker 0>let's join the control plan.

01:00:46.940 --> 01:00:48.300
<v Speaker 0>We run am I?

01:00:50.860 --> 01:00:52.780
<v Speaker 0>And we see them, and I asked that

01:00:52.780 --> 01:00:54.220
<v Speaker 0>we run each of these commands on a

01:00:54.220 --> 01:00:55.980
<v Speaker 0>different machine. So we got Who am I

01:00:55.980 --> 01:00:56.220
<v Speaker 0>there.

01:00:57.105 --> 01:00:58.945
<v Speaker 0>We've got who here, we can see it's

01:00:58.945 --> 01:00:59.665
<v Speaker 0>connected.

01:01:00.545 --> 01:01:02.225
<v Speaker 0>And then on the last one, we'll run

01:01:02.225 --> 01:01:04.145
<v Speaker 0>last, which will show us the auto log

01:01:04.145 --> 01:01:05.905
<v Speaker 0>for the machine. And we can see who

01:01:05.905 --> 01:01:07.265
<v Speaker 0>is here, etcetera.

01:01:07.825 --> 01:01:10.465
<v Speaker 0>So the web UI provides a really great

01:01:10.465 --> 01:01:12.950
<v Speaker 0>way to be able to understand

01:01:13.190 --> 01:01:15.750
<v Speaker 0>the machines that we have on our infrastructure,

01:01:15.750 --> 01:01:18.070
<v Speaker 0>connect to them, run commands,

01:01:18.070 --> 01:01:19.350
<v Speaker 0>very, very cool.

01:01:19.589 --> 01:01:22.070
<v Speaker 0>I'm a huge fan of this user interface.

01:01:24.085 --> 01:01:25.685
<v Speaker 0>All right, so now we want to join

01:01:25.685 --> 01:01:27.445
<v Speaker 0>an active session. So

01:01:28.165 --> 01:01:30.325
<v Speaker 0>we can't create a standard user because of

01:01:30.325 --> 01:01:32.565
<v Speaker 0>the emojis, which is unfortunate. So we're just

01:01:32.565 --> 01:01:34.245
<v Speaker 0>going to use root and I want to

01:01:34.245 --> 01:01:35.925
<v Speaker 0>execute cat shadow.

01:01:36.579 --> 01:01:39.140
<v Speaker 0>Okay. So I'm going to join our Arch

01:01:39.140 --> 01:01:39.940
<v Speaker 0>machine,

01:01:40.900 --> 01:01:42.180
<v Speaker 0>run cat,

01:01:42.260 --> 01:01:43.140
<v Speaker 0>etcetera,

01:01:44.099 --> 01:01:44.740
<v Speaker 0>shadow.

01:01:45.540 --> 01:01:48.339
<v Speaker 0>And this is our shadow password file on

01:01:48.339 --> 01:01:48.819
<v Speaker 0>Linux.

01:01:51.515 --> 01:01:52.555
<v Speaker 0>Then it says

01:01:53.195 --> 01:01:56.395
<v Speaker 0>open password file on VIM. Okay. As it

01:01:56.395 --> 01:01:57.035
<v Speaker 0>says,

01:01:59.275 --> 01:02:00.555
<v Speaker 0>and we have this,

01:02:01.755 --> 01:02:03.355
<v Speaker 0>and then it wants us to use the

01:02:03.355 --> 01:02:05.595
<v Speaker 0>PON user to have sessions side by side.

01:02:05.670 --> 01:02:06.950
<v Speaker 0>So let's do that.

01:02:08.390 --> 01:02:10.150
<v Speaker 0>There is this tab.

01:02:11.190 --> 01:02:12.869
<v Speaker 0>I'll pop up in this one.

01:02:14.069 --> 01:02:15.430
<v Speaker 0>Really, I shouldn't be back in.

01:02:20.724 --> 01:02:22.485
<v Speaker 0>Let's just log in.

01:02:29.525 --> 01:02:30.085
<v Speaker 0>Accept.

01:02:33.809 --> 01:02:35.569
<v Speaker 0>So that should just work. Although I need

01:02:35.569 --> 01:02:37.809
<v Speaker 0>to change the off to FA to be

01:02:37.809 --> 01:02:39.170
<v Speaker 0>my Pawn user.

01:02:40.690 --> 01:02:41.329
<v Speaker 0>Pawn.

01:02:44.835 --> 01:02:45.875
<v Speaker 0>We're

01:02:45.875 --> 01:02:48.515
<v Speaker 0>going to go to activity and active sessions.

01:02:48.915 --> 01:02:50.595
<v Speaker 0>This is one of my, this is one

01:02:50.595 --> 01:02:52.115
<v Speaker 0>of Teleport's superpowers.

01:02:52.115 --> 01:02:54.435
<v Speaker 0>I absolutely love this feature and that we

01:02:54.435 --> 01:02:56.835
<v Speaker 0>can see active sessions and not only that,

01:02:56.835 --> 01:02:57.955
<v Speaker 0>but we can join

01:02:58.195 --> 01:03:00.435
<v Speaker 0>and you'll see that I'm dropped in

01:03:00.789 --> 01:03:02.230
<v Speaker 0>to the session.

01:03:03.269 --> 01:03:04.789
<v Speaker 0>And in fact, if I move the cursor

01:03:04.789 --> 01:03:06.950
<v Speaker 0>on one side, it moves

01:03:07.510 --> 01:03:08.550
<v Speaker 0>and the other.

01:03:09.109 --> 01:03:10.550
<v Speaker 0>So I'm not super cool.

01:03:11.349 --> 01:03:12.309
<v Speaker 0>So if I type,

01:03:15.474 --> 01:03:18.595
<v Speaker 0>immediately replicated to our other user, really great

01:03:18.595 --> 01:03:21.474
<v Speaker 0>for our pure programming scenarios or debugging and

01:03:21.474 --> 01:03:23.395
<v Speaker 0>production outages where you just need an extra

01:03:23.395 --> 01:03:24.595
<v Speaker 0>set of eyes to make sure that you're

01:03:24.595 --> 01:03:26.835
<v Speaker 0>not doing anything too catastrophic.

01:03:27.234 --> 01:03:28.275
<v Speaker 0>Very, very cool feature.

01:03:30.039 --> 01:03:32.119
<v Speaker 0>And then quite fine without saving, we shouldn't

01:03:32.119 --> 01:03:33.160
<v Speaker 0>have been able to save, but I'm sure

01:03:33.160 --> 01:03:34.599
<v Speaker 0>it's actually would have been able to save,

01:03:34.599 --> 01:03:36.200
<v Speaker 0>but I didn't. So we're all good.

01:03:36.599 --> 01:03:38.440
<v Speaker 0>Okay. So we're going to close this. I

01:03:38.440 --> 01:03:40.359
<v Speaker 0>don't think we need our join session anymore.

01:03:42.755 --> 01:03:45.315
<v Speaker 0>Exercise nine is to show off session replay.

01:03:45.315 --> 01:03:47.875
<v Speaker 0>So let's actually watch the recording of the

01:03:47.875 --> 01:03:49.475
<v Speaker 0>previous exercise.

01:03:50.915 --> 01:03:52.915
<v Speaker 0>So if we jump over to here and

01:03:52.915 --> 01:03:55.395
<v Speaker 0>go to activity and session recordings, you'll see

01:03:55.395 --> 01:03:56.755
<v Speaker 0>that each of the sessions that I have

01:03:56.755 --> 01:03:57.395
<v Speaker 0>opened

01:03:57.860 --> 01:04:00.260
<v Speaker 0>on one of our Teleport agents

01:04:00.260 --> 01:04:02.660
<v Speaker 0>is available here for us to play.

01:04:03.380 --> 01:04:04.980
<v Speaker 0>So that should be the first one.

01:04:05.300 --> 01:04:06.500
<v Speaker 0>There's a who am I, but I got

01:04:06.500 --> 01:04:07.300
<v Speaker 0>that wrong.

01:04:09.540 --> 01:04:11.860
<v Speaker 0>Which one's this? Is this the who? Yep.

01:04:15.244 --> 01:04:16.525
<v Speaker 0>And the last.

01:04:22.285 --> 01:04:23.165
<v Speaker 0>Where's

01:04:24.380 --> 01:04:25.660
<v Speaker 0>why is it still open?

01:04:26.460 --> 01:04:27.500
<v Speaker 0>Exit.

01:04:32.460 --> 01:04:33.980
<v Speaker 0>Okay, there we go.

01:04:34.300 --> 01:04:36.700
<v Speaker 0>So now we can actually see

01:04:36.395 --> 01:04:39.435
<v Speaker 0>we have the recording for that previous session,

01:04:39.435 --> 01:04:40.795
<v Speaker 0>which I hadn't closed, but we can see

01:04:40.795 --> 01:04:43.035
<v Speaker 0>the users that were involved in the session,

01:04:43.035 --> 01:04:44.474
<v Speaker 0>how long it was opened, when it was

01:04:44.474 --> 01:04:45.115
<v Speaker 0>created

01:04:45.435 --> 01:04:47.275
<v Speaker 0>and the session ID so we can actually

01:04:47.275 --> 01:04:48.875
<v Speaker 0>replay it. Let me take a look at

01:04:48.875 --> 01:04:50.635
<v Speaker 0>the command line very shortly where we'll see

01:04:50.635 --> 01:04:51.275
<v Speaker 0>that in action.

01:04:51.819 --> 01:04:53.660
<v Speaker 0>But we can come into here and we

01:04:53.660 --> 01:04:55.340
<v Speaker 0>can replay this.

01:04:56.460 --> 01:04:57.420
<v Speaker 0>Let's

01:04:57.819 --> 01:05:00.460
<v Speaker 0>see what our next task is.

01:05:01.420 --> 01:05:03.500
<v Speaker 0>So it wants us to copy the hash

01:05:03.500 --> 01:05:05.420
<v Speaker 0>password of the Aventura user, which I cannot

01:05:05.420 --> 01:05:07.180
<v Speaker 0>do because of the images. However,

01:05:07.795 --> 01:05:09.475
<v Speaker 0>I just want to demonstrate

01:05:10.115 --> 01:05:12.915
<v Speaker 0>how special the replay is. Like it kind

01:05:12.915 --> 01:05:14.755
<v Speaker 0>of, they make it look like a video

01:05:14.835 --> 01:05:16.355
<v Speaker 0>and that you can kind of drag and

01:05:16.355 --> 01:05:18.515
<v Speaker 0>drop, but it's not by any means a

01:05:18.515 --> 01:05:18.755
<v Speaker 0>video.

01:05:19.780 --> 01:05:22.100
<v Speaker 0>And in fact, you can copy and paste.

01:05:23.140 --> 01:05:25.300
<v Speaker 0>Oh, this is a Firefox thing.

01:05:28.660 --> 01:05:29.860
<v Speaker 0>Am I going to have to join in

01:05:29.860 --> 01:05:30.580
<v Speaker 0>Chrome?

01:05:32.980 --> 01:05:33.780
<v Speaker 0>Oh, damn you.

01:05:37.994 --> 01:05:40.715
<v Speaker 0>I don't know why Firefox is not letting

01:05:40.715 --> 01:05:42.635
<v Speaker 0>me copy and paste.

01:05:43.835 --> 01:05:46.234
<v Speaker 0>So I'm gonna bring over a Chrome window.

01:05:51.070 --> 01:05:52.350
<v Speaker 0>Oh, wait. There

01:05:55.150 --> 01:05:55.870
<v Speaker 0>we go.

01:06:03.630 --> 01:06:04.190
<v Speaker 0>Log in.

01:06:06.485 --> 01:06:08.325
<v Speaker 0>So if we pause this,

01:06:09.525 --> 01:06:11.605
<v Speaker 0>you can see we can copy and paste.

01:06:11.605 --> 01:06:13.445
<v Speaker 0>I thought it might Firefox, I've never seen

01:06:13.445 --> 01:06:14.165
<v Speaker 0>that before,

01:06:14.805 --> 01:06:16.645
<v Speaker 0>but these are not videos. So, you know,

01:06:16.645 --> 01:06:18.085
<v Speaker 0>if there was a piece of information that

01:06:18.085 --> 01:06:19.765
<v Speaker 0>you had to get, you can copy,

01:06:20.610 --> 01:06:22.530
<v Speaker 0>you you can paste that anywhere.

01:06:22.930 --> 01:06:25.090
<v Speaker 0>You can pick and choose part

01:06:25.810 --> 01:06:28.130
<v Speaker 0>of the replay that's important to you and

01:06:28.130 --> 01:06:29.650
<v Speaker 0>get what you need out of it.

01:06:31.410 --> 01:06:32.610
<v Speaker 0>Thank you Chrome.

01:06:33.490 --> 01:06:33.970
<v Speaker 0>Firefox.

01:06:36.965 --> 01:06:38.405
<v Speaker 0>I really just need to give up on

01:06:38.405 --> 01:06:39.285
<v Speaker 0>you, I think.

01:06:42.085 --> 01:06:44.645
<v Speaker 0>Well, replays very, very cool. I

01:06:45.845 --> 01:06:46.565
<v Speaker 0>like that a lot.

01:06:53.020 --> 01:06:56.060
<v Speaker 0>Okay. We are on good twenty five minutes,

01:06:56.060 --> 01:06:57.180
<v Speaker 0>exercise 10.

01:06:57.420 --> 01:07:00.140
<v Speaker 0>Find the join event and teleport auto log.

01:07:00.940 --> 01:07:04.380
<v Speaker 0>From here, we can see auto log

01:07:04.615 --> 01:07:06.695
<v Speaker 0>and we can just filter this down. So

01:07:06.695 --> 01:07:08.775
<v Speaker 0>if you're looking for a specific event or

01:07:08.775 --> 01:07:10.055
<v Speaker 0>you want to know, or you're looking to

01:07:10.055 --> 01:07:12.935
<v Speaker 0>see activity of a specific user even,

01:07:13.415 --> 01:07:16.055
<v Speaker 0>I can search for Rawkode,

01:07:16.055 --> 01:07:17.575
<v Speaker 0>but we are looking for the join event,

01:07:17.575 --> 01:07:19.340
<v Speaker 0>so I can search for join. And we

01:07:19.340 --> 01:07:21.660
<v Speaker 0>can see that the user Pawn joined this

01:07:21.660 --> 01:07:23.660
<v Speaker 0>session and we can click on details to

01:07:23.660 --> 01:07:24.540
<v Speaker 0>get more of it.

01:07:25.340 --> 01:07:27.500
<v Speaker 0>And if we were able to enable the

01:07:27.500 --> 01:07:30.140
<v Speaker 0>eBPF enhanced recording for the sessions,

01:07:30.540 --> 01:07:31.820
<v Speaker 0>we'd have been able to do some cool

01:07:31.820 --> 01:07:33.740
<v Speaker 0>stuff. In fact, one of the next exercises

01:07:33.740 --> 01:07:34.940
<v Speaker 0>would have been doing that.

01:07:35.555 --> 01:07:36.915
<v Speaker 0>You can actually put out a list of

01:07:36.915 --> 01:07:38.515
<v Speaker 0>all of the commands that were executed, the

01:07:38.515 --> 01:07:40.835
<v Speaker 0>parameters and stuff like that. So

01:07:41.395 --> 01:07:42.435
<v Speaker 0>I'm

01:07:42.435 --> 01:07:44.515
<v Speaker 0>just going to throw in an extra tutorial

01:07:44.515 --> 01:07:45.715
<v Speaker 0>on this course, and we're going to take

01:07:45.715 --> 01:07:47.155
<v Speaker 0>a look at the BPS stuff because that

01:07:47.155 --> 01:07:48.275
<v Speaker 0>is super cool.

01:07:48.755 --> 01:07:49.955
<v Speaker 0>But we've got the audit log.

01:07:50.670 --> 01:07:52.349
<v Speaker 0>There are different ways that you can interact

01:07:52.349 --> 01:07:54.589
<v Speaker 0>with that. I'm pretty sure we have a

01:07:54.589 --> 01:07:56.270
<v Speaker 0>small tutorial towards the end of the course

01:07:56.270 --> 01:07:57.790
<v Speaker 0>where we look at getting that information into

01:07:57.790 --> 01:07:59.790
<v Speaker 0>a time series database that's storing it in

01:07:59.790 --> 01:08:00.670
<v Speaker 0>Influx,

01:08:01.150 --> 01:08:03.150
<v Speaker 0>Prometheus, and it's like that. So you can

01:08:03.150 --> 01:08:05.785
<v Speaker 0>have very good visibility into what's happening in

01:08:05.785 --> 01:08:06.745
<v Speaker 0>your infrastructure.

01:08:09.785 --> 01:08:10.585
<v Speaker 0>Okay,

01:08:10.905 --> 01:08:11.385
<v Speaker 0>next.

01:08:11.865 --> 01:08:12.345
<v Speaker 0>So

01:08:12.665 --> 01:08:14.105
<v Speaker 0>for the final part

01:08:14.425 --> 01:08:16.345
<v Speaker 0>of this workshop, we want to, you know,

01:08:16.345 --> 01:08:18.899
<v Speaker 0>we've focused heavily so far on the user

01:08:18.899 --> 01:08:22.099
<v Speaker 0>interface and the user interface is obviously great.

01:08:22.420 --> 01:08:24.180
<v Speaker 0>But a lot of you, a lot of

01:08:24.180 --> 01:08:25.140
<v Speaker 0>people that are going to be coming to

01:08:25.140 --> 01:08:26.099
<v Speaker 0>watch this course

01:08:26.899 --> 01:08:29.540
<v Speaker 0>are going to be CLI junkies, right? You

01:08:29.540 --> 01:08:32.244
<v Speaker 0>work in your terminal all day and

01:08:32.404 --> 01:08:35.045
<v Speaker 0>interacting with your infrastructure should be no exception,

01:08:35.205 --> 01:08:37.524
<v Speaker 0>especially, or even when we bring Teleport into

01:08:37.524 --> 01:08:39.765
<v Speaker 0>the equation. So we want to take a

01:08:39.765 --> 01:08:41.765
<v Speaker 0>look at, well, can we use the Teleport

01:08:41.765 --> 01:08:44.564
<v Speaker 0>CLI tooling to do most of the same

01:08:44.564 --> 01:08:46.325
<v Speaker 0>stuff that we have already covered thus far?

01:08:47.500 --> 01:08:50.060
<v Speaker 0>So exercise 11 is just, hey,

01:08:50.620 --> 01:08:53.180
<v Speaker 0>let's get TSH working and be able to

01:08:53.180 --> 01:08:54.779
<v Speaker 0>interact with this cluster.

01:08:55.180 --> 01:08:56.939
<v Speaker 0>The one thing I just need is our

01:08:56.939 --> 01:08:58.859
<v Speaker 0>public IP address and the port.

01:08:59.660 --> 01:09:01.580
<v Speaker 0>Actually, I don't need the protocol.

01:09:03.215 --> 01:09:04.494
<v Speaker 0>We just need this.

01:09:04.895 --> 01:09:07.375
<v Speaker 0>And if we jump over to my, this

01:09:07.375 --> 01:09:09.215
<v Speaker 0>is my host machine. I'll just jump into

01:09:09.215 --> 01:09:10.414
<v Speaker 0>a temporary directory,

01:09:11.215 --> 01:09:14.014
<v Speaker 0>but we have access to the TSH command

01:09:15.240 --> 01:09:16.680
<v Speaker 0>and you can see that we have the

01:09:16.680 --> 01:09:19.800
<v Speaker 0>ability to, you know, SSH and execute commands.

01:09:19.800 --> 01:09:21.640
<v Speaker 0>We can list applications. We're going to be

01:09:21.640 --> 01:09:23.640
<v Speaker 0>looking at application proxy and

01:09:24.120 --> 01:09:26.200
<v Speaker 0>other workshop leaders. We'll come back for that,

01:09:26.200 --> 01:09:28.040
<v Speaker 0>as well as database access, which I think

01:09:28.040 --> 01:09:29.400
<v Speaker 0>we're going be doing our first one next

01:09:29.400 --> 01:09:29.560
<v Speaker 0>week.

01:09:30.205 --> 01:09:32.445
<v Speaker 0>We can join sessions. We can replay the

01:09:32.445 --> 01:09:35.005
<v Speaker 0>sessions locally too. We can copy files, list

01:09:35.005 --> 01:09:35.805
<v Speaker 0>machines,

01:09:35.965 --> 01:09:38.765
<v Speaker 0>work with multiple clusters, etcetera, etcetera. So there's

01:09:38.765 --> 01:09:39.885
<v Speaker 0>lots of stuff here.

01:09:41.325 --> 01:09:43.590
<v Speaker 0>The request stuff, I'm really excited to be

01:09:43.590 --> 01:09:45.510
<v Speaker 0>doing a tutorial on the soon, but we'll

01:09:45.510 --> 01:09:47.350
<v Speaker 0>look at how you can elevate your privilege.

01:09:47.510 --> 01:09:49.910
<v Speaker 0>So having your Teleport configured in a way

01:09:49.910 --> 01:09:51.750
<v Speaker 0>that people only have the bare minimum that

01:09:51.750 --> 01:09:53.189
<v Speaker 0>they need to do their job. And then

01:09:53.189 --> 01:09:55.590
<v Speaker 0>anything that they need above and beyond that,

01:09:55.590 --> 01:09:55.750
<v Speaker 0>maybe

01:09:56.495 --> 01:09:58.975
<v Speaker 0>they need access to a database server. Maybe

01:09:58.975 --> 01:10:00.735
<v Speaker 0>they need root on a database server or

01:10:00.735 --> 01:10:02.815
<v Speaker 0>root on a server that they typically only

01:10:02.815 --> 01:10:04.975
<v Speaker 0>have the Bindu access to. Well, we can

01:10:04.975 --> 01:10:07.455
<v Speaker 0>allow them to submit requests for elevated privilege

01:10:07.455 --> 01:10:09.215
<v Speaker 0>and be able to audit that in Proxy

01:10:09.215 --> 01:10:09.695
<v Speaker 0>as well.

01:10:12.360 --> 01:10:15.080
<v Speaker 0>And of course the Kubernetes and, you know,

01:10:15.080 --> 01:10:17.400
<v Speaker 0>there'll be a tutorial on hardware tokens as

01:10:17.400 --> 01:10:19.719
<v Speaker 0>well. There's just so much to love about

01:10:19.719 --> 01:10:20.519
<v Speaker 0>Teleport.

01:10:20.920 --> 01:10:23.719
<v Speaker 0>Okay. So let's do Teleport login and we

01:10:23.719 --> 01:10:25.965
<v Speaker 0>have to provide a proxy path, which is

01:10:25.965 --> 01:10:27.724
<v Speaker 0>gonna be our IP address and port.

01:10:29.324 --> 01:10:31.405
<v Speaker 0>I'm gonna need to unsecure again,

01:10:31.725 --> 01:10:33.565
<v Speaker 0>the next time I'm configuring

01:10:33.565 --> 01:10:34.925
<v Speaker 0>a DNS name.

01:10:36.525 --> 01:10:38.125
<v Speaker 0>So this is one to our password for

01:10:38.125 --> 01:10:39.244
<v Speaker 0>our Teleport user

01:10:39.820 --> 01:10:41.260
<v Speaker 0>that we can grab.

01:10:43.420 --> 01:10:44.380
<v Speaker 0>Teleport

01:10:44.380 --> 01:10:45.580
<v Speaker 0>workshop.

01:10:47.420 --> 01:10:48.780
<v Speaker 0>Copy password.

01:10:50.860 --> 01:10:51.820
<v Speaker 0>My token.

01:10:53.585 --> 01:10:55.265
<v Speaker 0>I get the Rawkode one.

01:11:04.625 --> 01:11:05.825
<v Speaker 0>Enter password

01:11:05.825 --> 01:11:06.705
<v Speaker 0>for Rawkode.

01:11:09.090 --> 01:11:09.810
<v Speaker 0>Yeah.

01:11:15.010 --> 01:11:15.650
<v Speaker 0>Token.

01:11:19.330 --> 01:11:20.290
<v Speaker 0>No

01:11:21.410 --> 01:11:23.585
<v Speaker 0>idea what happened there. As you can actually

01:11:23.585 --> 01:11:25.505
<v Speaker 0>see, I have a fair number of Teleport

01:11:25.505 --> 01:11:28.304
<v Speaker 0>clusters because I use Teleport every single week

01:11:28.304 --> 01:11:29.344
<v Speaker 0>for cluster.

01:11:29.824 --> 01:11:32.304
<v Speaker 0>So I'm always, I've always got access to

01:11:32.304 --> 01:11:32.625
<v Speaker 0>stuff.

01:11:34.800 --> 01:11:36.960
<v Speaker 0>We can actually clean that up.

01:11:39.920 --> 01:11:40.960
<v Speaker 0>Config.

01:11:44.160 --> 01:11:45.280
<v Speaker 0>Where does it live again?

01:11:55.284 --> 01:11:56.804
<v Speaker 0>Why is my brain not working?

01:12:05.070 --> 01:12:06.750
<v Speaker 0>There we go. There they are out there.

01:12:06.750 --> 01:12:07.310
<v Speaker 0>Okay.

01:12:10.270 --> 01:12:11.390
<v Speaker 0>Let's clean

01:12:11.710 --> 01:12:14.350
<v Speaker 0>FHAT star cluster.

01:12:14.910 --> 01:12:16.835
<v Speaker 0>I probably remove all of those.

01:12:18.915 --> 01:12:19.955
<v Speaker 0>TSH.

01:12:20.915 --> 01:12:22.355
<v Speaker 0>Yeah, that works.

01:12:22.835 --> 01:12:24.515
<v Speaker 0>So if I do TSH

01:12:24.515 --> 01:12:25.395
<v Speaker 0>clusters,

01:12:26.915 --> 01:12:29.155
<v Speaker 0>much better. So we've tidied that up.

01:12:30.679 --> 01:12:32.920
<v Speaker 0>Each of your Teleport cluster is left to

01:12:32.920 --> 01:12:33.960
<v Speaker 0>this one file. You can

01:12:34.840 --> 01:12:36.360
<v Speaker 0>current one that you're working with is literally

01:12:36.360 --> 01:12:38.920
<v Speaker 0>just stored the name instead of current profile.

01:12:39.159 --> 01:12:40.039
<v Speaker 0>That's it.

01:12:40.840 --> 01:12:42.760
<v Speaker 0>And that just matches the file name of

01:12:42.760 --> 01:12:44.360
<v Speaker 0>the YAML for the cluster that we're working

01:12:44.360 --> 01:12:44.520
<v Speaker 0>with.

01:12:45.595 --> 01:12:47.515
<v Speaker 0>Okay. So we got TSH

01:12:47.515 --> 01:12:50.155
<v Speaker 0>configured, which was our mission there. Let's jump

01:12:50.155 --> 01:12:50.715
<v Speaker 0>back.

01:12:53.275 --> 01:12:55.115
<v Speaker 0>So create a session on one of our

01:12:55.115 --> 01:12:56.875
<v Speaker 0>nodes through the UI and then we're going

01:12:56.875 --> 01:12:58.875
<v Speaker 0>to join it using TSH.

01:12:59.670 --> 01:13:01.510
<v Speaker 0>So let's pop open.

01:13:04.390 --> 01:13:06.389
<v Speaker 0>Let's just pick one of these ones.

01:13:07.750 --> 01:13:09.749
<v Speaker 0>So now we have a session.

01:13:13.510 --> 01:13:15.110
<v Speaker 0>Unless this has changed,

01:13:16.975 --> 01:13:19.935
<v Speaker 0>there's one caveat to this exercise.

01:13:19.935 --> 01:13:21.215
<v Speaker 0>And I don't think it has, I don't

01:13:21.215 --> 01:13:23.295
<v Speaker 0>think it has changed is that you can't

01:13:23.295 --> 01:13:24.095
<v Speaker 0>list

01:13:24.495 --> 01:13:25.775
<v Speaker 0>the sessions

01:13:25.775 --> 01:13:27.695
<v Speaker 0>from the CLI, unfortunately.

01:13:28.175 --> 01:13:29.855
<v Speaker 0>So in order for us to join

01:13:30.420 --> 01:13:32.660
<v Speaker 0>using the join command here,

01:13:33.380 --> 01:13:35.700
<v Speaker 0>we have to grab the ID from either

01:13:35.700 --> 01:13:37.540
<v Speaker 0>the URL of the session, or if you

01:13:37.540 --> 01:13:40.100
<v Speaker 0>don't have that from active sessions here, where

01:13:40.100 --> 01:13:41.700
<v Speaker 0>you can get the session ID.

01:13:42.580 --> 01:13:43.460
<v Speaker 0>That's the caveat.

01:13:43.895 --> 01:13:45.415
<v Speaker 0>I'm sure that will improve

01:13:45.655 --> 01:13:46.375
<v Speaker 0>soon.

01:13:46.615 --> 01:13:49.255
<v Speaker 0>From here, we can run a TSH join

01:13:49.255 --> 01:13:51.335
<v Speaker 0>and we just want to provide the session

01:13:51.335 --> 01:13:51.895
<v Speaker 0>ID.

01:13:57.450 --> 01:13:59.050
<v Speaker 0>Yeah, we need a

01:14:03.130 --> 01:14:04.970
<v Speaker 0>108 session ID. So I have to provide

01:14:04.970 --> 01:14:06.090
<v Speaker 0>a user separately.

01:14:06.890 --> 01:14:08.410
<v Speaker 0>So that was going to be

01:14:09.450 --> 01:14:09.850
<v Speaker 0>rich.

01:14:12.264 --> 01:14:14.184
<v Speaker 0>And from here, I can run the PSE

01:14:14.184 --> 01:14:16.025
<v Speaker 0>UX like the workshop wants me to, and

01:14:16.025 --> 01:14:18.184
<v Speaker 0>I would jump over to the web here.

01:14:18.905 --> 01:14:20.344
<v Speaker 0>We've got the same here.

01:14:21.784 --> 01:14:22.425
<v Speaker 0>So,

01:14:22.985 --> 01:14:23.784
<v Speaker 0>you don't

01:14:24.580 --> 01:14:28.180
<v Speaker 0>lose any functionality by wanting or opting for

01:14:28.180 --> 01:14:29.620
<v Speaker 0>using the CLI.

01:14:30.020 --> 01:14:31.620
<v Speaker 0>And in fact, I actually find the CLI

01:14:31.620 --> 01:14:33.140
<v Speaker 0>experience a little bit nicer,

01:14:33.380 --> 01:14:35.220
<v Speaker 0>except for that really annoying caveat about finding

01:14:35.220 --> 01:14:36.420
<v Speaker 0>the session ID.

01:14:36.740 --> 01:14:38.020
<v Speaker 0>So let's drop out of that.

01:14:39.735 --> 01:14:41.335
<v Speaker 0>Session was closed.

01:14:43.975 --> 01:14:46.535
<v Speaker 0>Okay. We're almost there and we may just

01:14:46.535 --> 01:14:48.135
<v Speaker 0>sneak in on time because I'm not sure

01:14:48.135 --> 01:14:50.295
<v Speaker 0>we can do all the following exercises because

01:14:50.295 --> 01:14:50.935
<v Speaker 0>of that

01:14:51.175 --> 01:14:53.095
<v Speaker 0>annoying BPF thing. However,

01:14:55.659 --> 01:14:57.500
<v Speaker 0>we want to create a file on all

01:14:57.500 --> 01:14:59.099
<v Speaker 0>staging nodes. So now we're going to be

01:14:59.099 --> 01:15:00.699
<v Speaker 0>taking a look at how we use those

01:15:00.699 --> 01:15:03.019
<v Speaker 0>label selectors to query our infrastructure.

01:15:03.659 --> 01:15:05.979
<v Speaker 0>So if we run TSH

01:15:06.060 --> 01:15:06.619
<v Speaker 0>LS,

01:15:07.625 --> 01:15:10.105
<v Speaker 0>what we get are a list of all

01:15:10.105 --> 01:15:13.065
<v Speaker 0>of the agents, machines, VMs, bare metal, whatever

01:15:13.065 --> 01:15:15.385
<v Speaker 0>that are joined as part of the cluster.

01:15:15.945 --> 01:15:17.304
<v Speaker 0>And one of the cool things you can

01:15:17.304 --> 01:15:20.185
<v Speaker 0>do is pass in label selectors.

01:15:22.780 --> 01:15:24.060
<v Speaker 0>Oh, he says,

01:15:25.020 --> 01:15:25.739
<v Speaker 0>hopefully.

01:15:29.020 --> 01:15:30.300
<v Speaker 0>Oh, it's environment.

01:15:31.260 --> 01:15:32.700
<v Speaker 0>Hey, that actually worked.

01:15:32.940 --> 01:15:33.980
<v Speaker 0>Environment

01:15:33.980 --> 01:15:34.700
<v Speaker 0>staging.

01:15:38.065 --> 01:15:40.544
<v Speaker 0>I'm making it more difficult for myself.

01:15:41.344 --> 01:15:43.744
<v Speaker 0>So we can use those label selectors to

01:15:43.744 --> 01:15:44.704
<v Speaker 0>take a look.

01:15:45.264 --> 01:15:46.945
<v Speaker 0>I'd not actually tried this, but I'm now

01:15:46.945 --> 01:15:47.584
<v Speaker 0>feeling

01:15:48.224 --> 01:15:50.385
<v Speaker 0>a little bit brave. I'm not sure

01:15:51.660 --> 01:15:54.140
<v Speaker 0>how fancy those can get. Let's see if

01:15:54.140 --> 01:15:56.300
<v Speaker 0>we can just wrap in quotes first, which

01:15:56.300 --> 01:15:57.099
<v Speaker 0>we can.

01:15:57.900 --> 01:15:59.099
<v Speaker 0>Can we do

01:16:01.420 --> 01:16:02.940
<v Speaker 0>I'm making this up now.

01:16:04.780 --> 01:16:05.180
<v Speaker 0>Star.

01:16:06.195 --> 01:16:08.115
<v Speaker 0>No, I was curious if we could do

01:16:08.115 --> 01:16:10.275
<v Speaker 0>like, oh, it doesn't look like this. And

01:16:10.275 --> 01:16:11.475
<v Speaker 0>I'm sure there are

01:16:12.435 --> 01:16:14.435
<v Speaker 0>potentially patterns here. Oh no, it just wants

01:16:14.435 --> 01:16:15.875
<v Speaker 0>key value. That

01:16:16.035 --> 01:16:16.995
<v Speaker 0>would've been awesome.

01:16:17.155 --> 01:16:19.090
<v Speaker 0>So we can use the label selectors to

01:16:19.090 --> 01:16:20.770
<v Speaker 0>do a variable station and we can definitely

01:16:20.770 --> 01:16:23.730
<v Speaker 0>open a feature request for maybe like Google's

01:16:23.730 --> 01:16:25.490
<v Speaker 0>common expression language as a way to filter

01:16:25.490 --> 01:16:26.930
<v Speaker 0>those down even better.

01:16:27.250 --> 01:16:28.530
<v Speaker 0>So very cool.

01:16:29.730 --> 01:16:30.690
<v Speaker 0>All right, workshop.

01:16:31.995 --> 01:16:34.875
<v Speaker 0>So now we actually, yeah. So all we've

01:16:34.875 --> 01:16:36.074
<v Speaker 0>done is query

01:16:36.395 --> 01:16:38.315
<v Speaker 0>node list based on that, but we actually

01:16:38.315 --> 01:16:40.475
<v Speaker 0>want to execute commands. And if we take

01:16:40.475 --> 01:16:42.795
<v Speaker 0>a look at the SSH subcommand,

01:16:43.595 --> 01:16:45.515
<v Speaker 0>you'll see that we can

01:16:46.580 --> 01:16:49.540
<v Speaker 0>use TSHSSH.

01:16:50.020 --> 01:16:52.180
<v Speaker 0>We could tell the nodes that we want

01:16:52.180 --> 01:16:54.340
<v Speaker 0>to communicate to.

01:16:55.780 --> 01:16:56.420
<v Speaker 0>Let's see.

01:17:08.685 --> 01:17:10.445
<v Speaker 0>And we can run a command. Okay.

01:17:13.350 --> 01:17:15.030
<v Speaker 0>Well, I thought this is gonna work, but

01:17:15.030 --> 01:17:16.150
<v Speaker 0>I don't think it is.

01:17:20.070 --> 01:17:20.390
<v Speaker 0>User.

01:17:29.325 --> 01:17:30.605
<v Speaker 0>Secure.

01:17:36.765 --> 01:17:38.125
<v Speaker 0>Oh, that's the wrong user.

01:17:41.000 --> 01:17:41.560
<v Speaker 0>Login.

01:17:54.495 --> 01:17:55.295
<v Speaker 0>Okay.

01:17:55.455 --> 01:17:57.055
<v Speaker 0>Sorry about that. So

01:17:58.255 --> 01:18:00.015
<v Speaker 0>what did we do there? Well, we ran

01:18:00.015 --> 01:18:02.895
<v Speaker 0>TSS SSH. Then secured because of my TLS

01:18:02.895 --> 01:18:03.695
<v Speaker 0>configuration.

01:18:03.695 --> 01:18:06.735
<v Speaker 0>We've done -l root, not -l equals root,

01:18:06.735 --> 01:18:08.815
<v Speaker 0>should be -login equals root or -l space

01:18:08.815 --> 01:18:11.380
<v Speaker 0>root. Anyway, And for the host, we use

01:18:11.380 --> 01:18:13.780
<v Speaker 0>the label selector, which will allow us to

01:18:13.780 --> 01:18:17.139
<v Speaker 0>run arbitrary commands across one or more machines.

01:18:17.619 --> 01:18:19.460
<v Speaker 0>You can see here that we run LS

01:18:19.460 --> 01:18:21.300
<v Speaker 0>on the home directory and we can see

01:18:21.300 --> 01:18:23.780
<v Speaker 0>the binaries, the tarballs that we downloaded earlier.

01:18:25.005 --> 01:18:27.725
<v Speaker 0>If we run a Uname A, we'll also

01:18:27.725 --> 01:18:30.525
<v Speaker 0>see the environments or the configurations for each

01:18:30.525 --> 01:18:32.045
<v Speaker 0>of these machines, allowing us to see that

01:18:32.045 --> 01:18:33.244
<v Speaker 0>we have an harsh machine.

01:18:33.485 --> 01:18:35.085
<v Speaker 0>We have a Linux machine, which is the

01:18:35.085 --> 01:18:36.124
<v Speaker 0>Red Hat one.

01:18:39.324 --> 01:18:39.965
<v Speaker 0>And

01:18:41.800 --> 01:18:43.080
<v Speaker 0>I don't know why I only got two

01:18:43.080 --> 01:18:44.920
<v Speaker 0>of this. There should be three, right?

01:18:47.800 --> 01:18:48.760
<v Speaker 0>L s.

01:18:49.800 --> 01:18:50.520
<v Speaker 0>Yeah.

01:18:52.520 --> 01:18:53.080
<v Speaker 0>No idea.

01:18:56.165 --> 01:18:58.005
<v Speaker 0>And we can run whatever command we want

01:18:58.005 --> 01:19:00.405
<v Speaker 0>there. So the workshop wants us to actually

01:19:00.405 --> 01:19:02.645
<v Speaker 0>echo hi hello to a fail on each

01:19:02.645 --> 01:19:03.685
<v Speaker 0>of these nodes.

01:19:05.205 --> 01:19:06.804
<v Speaker 0>So we can say echo

01:19:08.645 --> 01:19:09.605
<v Speaker 0>hi

01:19:09.845 --> 01:19:10.805
<v Speaker 0>temp

01:19:11.580 --> 01:19:12.620
<v Speaker 0>Teleport.

01:19:12.860 --> 01:19:13.100
<v Speaker 0>Hello.

01:19:23.974 --> 01:19:25.175
<v Speaker 0>My terminal

01:19:25.335 --> 01:19:26.774
<v Speaker 0>is acting up.

01:19:27.494 --> 01:19:28.935
<v Speaker 0>I need to call it that's because of

01:19:28.935 --> 01:19:29.894
<v Speaker 0>the redirect.

01:19:29.974 --> 01:19:32.215
<v Speaker 0>Echo high, I'm just going to attempt

01:19:33.655 --> 01:19:34.454
<v Speaker 0>H.

01:19:34.534 --> 01:19:35.735
<v Speaker 0>Now that fits.

01:19:36.054 --> 01:19:37.620
<v Speaker 0>So then we actually get this command on

01:19:37.620 --> 01:19:39.700
<v Speaker 0>each node and then we can actually see,

01:19:39.700 --> 01:19:42.100
<v Speaker 0>well, let me take a look at tempH.

01:19:44.580 --> 01:19:47.220
<v Speaker 0>We will see high and high.

01:19:47.460 --> 01:19:48.820
<v Speaker 0>Oh yeah, and the reason we're only getting

01:19:48.820 --> 01:19:50.820
<v Speaker 0>two on the selector is we never updated

01:19:50.820 --> 01:19:51.540
<v Speaker 0>intentionally

01:19:51.885 --> 01:19:53.004
<v Speaker 0>at the start,

01:19:54.684 --> 01:19:57.005
<v Speaker 0>the label on the control plane. So if

01:19:57.005 --> 01:19:58.204
<v Speaker 0>I pop back here,

01:19:58.684 --> 01:20:01.565
<v Speaker 0>we still have ENV example here. So there

01:20:01.565 --> 01:20:02.204
<v Speaker 0>we go.

01:20:03.085 --> 01:20:04.284
<v Speaker 0>Makes sense when you understand.

01:20:05.990 --> 01:20:07.750
<v Speaker 0>Now what I wanted to be able to

01:20:07.750 --> 01:20:08.470
<v Speaker 0>do

01:20:09.510 --> 01:20:10.150
<v Speaker 0>is

01:20:10.390 --> 01:20:11.670
<v Speaker 0>Oh no, we can't do this one. It's

01:20:11.670 --> 01:20:12.150
<v Speaker 0>just

01:20:12.870 --> 01:20:13.910
<v Speaker 0>Okay, cool.

01:20:15.830 --> 01:20:17.670
<v Speaker 0>The EBPF exercise would have been cool, but

01:20:17.670 --> 01:20:19.030
<v Speaker 0>I actually didn't put that in anyway, we

01:20:19.030 --> 01:20:19.430
<v Speaker 0>got lucky.

01:20:20.165 --> 01:20:22.165
<v Speaker 0>So we want the IP address and the

01:20:22.165 --> 01:20:24.245
<v Speaker 0>UUID of every node in the Teleport cluster.

01:20:24.885 --> 01:20:27.685
<v Speaker 0>So when we run TSHLS,

01:20:27.685 --> 01:20:30.005
<v Speaker 0>we get some information back. What I really

01:20:30.005 --> 01:20:32.165
<v Speaker 0>like with us is this following the convention

01:20:32.165 --> 01:20:34.370
<v Speaker 0>of, you know, other tooling that we have

01:20:34.370 --> 01:20:36.530
<v Speaker 0>around right now, specifically kubectl,

01:20:37.010 --> 01:20:38.929
<v Speaker 0>where we can actually specify

01:20:39.570 --> 01:20:40.770
<v Speaker 0>an output parameter.

01:20:48.275 --> 01:20:49.315
<v Speaker 0>Format, sorry.

01:20:49.795 --> 01:20:52.755
<v Speaker 0>Yeah, I'm using the kubectl

01:20:52.755 --> 01:20:53.555
<v Speaker 0>syntax,

01:20:53.555 --> 01:20:56.195
<v Speaker 0>where we can say, Hey, here's the information

01:20:56.195 --> 01:20:58.515
<v Speaker 0>that we need. So we have this as

01:20:58.515 --> 01:21:01.075
<v Speaker 0>JSON. And if we're just looking to get

01:21:02.570 --> 01:21:04.490
<v Speaker 0>the IP and the UID, then we can

01:21:04.490 --> 01:21:05.690
<v Speaker 0>take a look at, in fact, if we

01:21:05.690 --> 01:21:07.050
<v Speaker 0>just pipe it through JQ,

01:21:10.890 --> 01:21:13.370
<v Speaker 0>then we could see that what we're after

01:21:13.370 --> 01:21:14.890
<v Speaker 0>is

01:21:23.185 --> 01:21:24.865
<v Speaker 0>so we've got a list, we've got a

01:21:24.865 --> 01:21:26.545
<v Speaker 0>node, where's the IP?

01:21:27.825 --> 01:21:29.745
<v Speaker 0>Public ADDR, should spec.

01:21:30.225 --> 01:21:31.585
<v Speaker 0>Public ADDR.

01:21:32.040 --> 01:21:34.520
<v Speaker 0>So we can see, all right, we want

01:21:35.800 --> 01:21:36.520
<v Speaker 0>spec,

01:21:36.760 --> 01:21:37.400
<v Speaker 0>public

01:21:37.960 --> 01:21:38.920
<v Speaker 0>ADDR.

01:21:42.680 --> 01:21:43.640
<v Speaker 0>What is spec?

01:21:50.955 --> 01:21:52.875
<v Speaker 0>Now I can't remember JQ, come on.

01:22:03.980 --> 01:22:05.900
<v Speaker 0>Yeah, that should be right, right? Cannot index

01:22:05.900 --> 01:22:07.340
<v Speaker 0>array with strings back.

01:22:08.700 --> 01:22:10.620
<v Speaker 0>I forget it has to do all array

01:22:10.620 --> 01:22:11.500
<v Speaker 0>thingy.

01:22:12.620 --> 01:22:13.660
<v Speaker 0>Oh, dreads.

01:22:26.295 --> 01:22:28.710
<v Speaker 0>You know, I don't always know the answers

01:22:28.710 --> 01:22:31.270
<v Speaker 0>to all items that are ready.

01:22:37.830 --> 01:22:39.430
<v Speaker 0>Oh, am I just missing the dot?

01:22:42.975 --> 01:22:44.175
<v Speaker 0>There we go.

01:22:45.375 --> 01:22:46.255
<v Speaker 0>So

01:22:47.295 --> 01:22:49.695
<v Speaker 0>simple when you look at our route. So

01:22:49.695 --> 01:22:51.295
<v Speaker 0>because of the configuration we have of this

01:22:51.295 --> 01:22:53.054
<v Speaker 0>Teleport cluster right now is that these two

01:22:53.054 --> 01:22:55.534
<v Speaker 0>are actually being proxied through the control plane

01:22:55.534 --> 01:22:57.210
<v Speaker 0>node. And we're using that in a kind

01:22:57.210 --> 01:22:59.210
<v Speaker 0>of bastion style setup, but the only node

01:22:59.210 --> 01:23:00.570
<v Speaker 0>we have an IP address is for this

01:23:00.570 --> 01:23:02.409
<v Speaker 0>one. And then if we wanted to get

01:23:02.409 --> 01:23:03.609
<v Speaker 0>the UID,

01:23:03.929 --> 01:23:05.609
<v Speaker 0>that would just be

01:23:09.449 --> 01:23:10.249
<v Speaker 0>metadata.

01:23:10.570 --> 01:23:10.889
<v Speaker 0>Name.

01:23:16.415 --> 01:23:18.415
<v Speaker 0>And we can get all the UIDs.

01:23:18.495 --> 01:23:19.935
<v Speaker 0>But of course, I don't really have any

01:23:19.935 --> 01:23:21.775
<v Speaker 0>rhyme or reason for this right now. I

01:23:21.775 --> 01:23:23.375
<v Speaker 0>just really like the fact that we have

01:23:23.375 --> 01:23:25.540
<v Speaker 0>the ability with the TSH command

01:23:25.620 --> 01:23:28.820
<v Speaker 0>to format and get the human readable output

01:23:28.820 --> 01:23:30.580
<v Speaker 0>and something that is machine readable and be

01:23:30.580 --> 01:23:32.180
<v Speaker 0>able to enter at that using tooling that

01:23:32.180 --> 01:23:34.820
<v Speaker 0>we're already comfortable with such as JQ.

01:23:36.980 --> 01:23:37.940
<v Speaker 0>All

01:23:37.940 --> 01:23:38.100
<v Speaker 0>right.

01:23:39.655 --> 01:23:40.295
<v Speaker 0>Well,

01:23:40.534 --> 01:23:42.775
<v Speaker 0>that is our first workshop.

01:23:43.255 --> 01:23:45.415
<v Speaker 0>I will tidy that up for anyone who's

01:23:45.415 --> 01:23:47.014
<v Speaker 0>watching this a little bit in the future.

01:23:47.014 --> 01:23:48.534
<v Speaker 0>That's maybe slightly different,

01:23:48.855 --> 01:23:50.935
<v Speaker 0>but I will make sure that the description

01:23:50.935 --> 01:23:52.455
<v Speaker 0>contains all our comments

01:23:52.910 --> 01:23:55.230
<v Speaker 0>for everything that you need to know. There's

01:23:55.230 --> 01:23:57.230
<v Speaker 0>lots more content coming on the Complete Guide

01:23:57.230 --> 01:23:59.790
<v Speaker 0>to Teleport. I hope this piques your interest.

01:23:59.870 --> 01:24:01.150
<v Speaker 0>I hope you like what you see. It's

01:24:01.150 --> 01:24:02.270
<v Speaker 0>a very cool tool

01:24:02.430 --> 01:24:04.510
<v Speaker 0>and we'll be back next week with more

01:24:04.510 --> 01:24:06.110
<v Speaker 0>workshops and more fun.

01:24:06.645 --> 01:24:09.205
<v Speaker 0>So have a wonderful day. I'll see you

01:24:09.205 --> 01:24:09.925
<v Speaker 0>all again soon.
