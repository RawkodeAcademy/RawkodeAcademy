WEBVTT

NOTE
Transcription provided by Deepgram
Request Id: 1a91779d-5ce7-413b-8ae4-3c382ebd36e7
Created: 2025-04-29T18:57:23.879Z
Duration: 4919.0146
Channels: 1

00:04:23.305 --> 00:04:25.705
<v Speaker 0>Hello. Welcome back to Rawkode Live. I'm your

00:04:25.705 --> 00:04:26.425
<v Speaker 0>host, Rawkode.

00:04:27.000 --> 00:04:30.920
<v Speaker 0>This is our clustered KubeCon special part two.

00:04:30.920 --> 00:04:34.600
<v Speaker 0>Today, we have three clusters all broken by

00:04:34.600 --> 00:04:36.920
<v Speaker 0>people joining us on this call. We are

00:04:36.920 --> 00:04:39.160
<v Speaker 0>gonna work in teams to fix them as

00:04:39.160 --> 00:04:39.960
<v Speaker 0>quickly as we can.

00:04:40.675 --> 00:04:42.675
<v Speaker 0>Before we begin, I just wanna encourage you

00:04:42.675 --> 00:04:44.275
<v Speaker 0>all to subscribe to the YouTube channel and

00:04:44.275 --> 00:04:46.035
<v Speaker 0>click the bell. This will get you notifications

00:04:46.035 --> 00:04:47.475
<v Speaker 0>for all future episodes.

00:04:48.115 --> 00:04:49.475
<v Speaker 0>If you're not watching live or even if

00:04:49.475 --> 00:04:51.235
<v Speaker 0>you are, but you wanna chat about cool

00:04:51.635 --> 00:04:53.075
<v Speaker 0>you wanna chat about cloud native,

00:04:53.770 --> 00:04:55.449
<v Speaker 0>or anything in between, come and join the

00:04:55.449 --> 00:04:56.810
<v Speaker 0>Discord. There's a few hundred of us on

00:04:56.810 --> 00:04:58.650
<v Speaker 0>there now having a bit of fun. And

00:04:58.650 --> 00:05:01.050
<v Speaker 0>lastly, thank you to Equinix Medal, my employer.

00:05:01.130 --> 00:05:02.650
<v Speaker 0>They allow me to do this on their

00:05:02.650 --> 00:05:04.250
<v Speaker 0>time, and feel free to check out the

00:05:04.250 --> 00:05:05.690
<v Speaker 0>platform by using the code Rawkode.

00:05:06.435 --> 00:05:09.634
<v Speaker 0>Alright. Let's get started. Today, I am joined

00:05:09.634 --> 00:05:12.354
<v Speaker 0>by Thomas and Chris. Hello, Thomas and Chris.

00:05:13.794 --> 00:05:14.675
<v Speaker 1>Hey.

00:05:14.835 --> 00:05:15.634
<v Speaker 0>Alright.

00:05:16.115 --> 00:05:18.034
<v Speaker 0>So let's start with you, Thomas. Do wanna

00:05:18.034 --> 00:05:19.715
<v Speaker 0>just say hello? Let us know quickly who

00:05:19.715 --> 00:05:21.155
<v Speaker 0>you are and then we'll move on and

00:05:21.155 --> 00:05:22.380
<v Speaker 0>get started for today.

00:05:23.500 --> 00:05:25.980
<v Speaker 2>Sure. I'm Thomas Stromberg.

00:05:26.780 --> 00:05:29.580
<v Speaker 2>Once upon a time, I was a mini

00:05:29.580 --> 00:05:31.900
<v Speaker 2>cube maintainer. I work at Equinix metal now

00:05:31.900 --> 00:05:33.180
<v Speaker 2>working on Tinker Bell. So

00:05:33.855 --> 00:05:36.655
<v Speaker 2>looking forward to this. Feeling a little rusty

00:05:36.655 --> 00:05:38.575
<v Speaker 2>in Kubernetes debugging, but I think we're gonna

00:05:38.575 --> 00:05:39.375
<v Speaker 2>have a time.

00:05:40.895 --> 00:05:42.895
<v Speaker 0>It's alright. Nice. The breaks are always really

00:05:42.895 --> 00:05:44.335
<v Speaker 0>simple. You want me to know much. I

00:05:44.335 --> 00:05:44.975
<v Speaker 0>promise.

00:05:45.215 --> 00:05:45.935
<v Speaker 0>Chris?

00:05:49.295 --> 00:05:51.530
<v Speaker 1>Hi. My name is Chris Nova.

00:05:51.690 --> 00:05:54.330
<v Speaker 1>I am just a computer person who does

00:05:54.330 --> 00:05:55.449
<v Speaker 1>computer things

00:05:55.930 --> 00:05:57.130
<v Speaker 1>and I'm here

00:05:57.449 --> 00:05:59.770
<v Speaker 1>to play with Kubernetes with some new friends.

00:06:00.330 --> 00:06:02.455
<v Speaker 0>There seems to be a lot of comments

00:06:02.455 --> 00:06:04.855
<v Speaker 0>and chat talking about how everyone feels sorry

00:06:04.855 --> 00:06:06.695
<v Speaker 0>for Thomas and I and your cluster. And

00:06:06.695 --> 00:06:08.215
<v Speaker 0>I believe some people may have watched your

00:06:08.215 --> 00:06:10.455
<v Speaker 0>stream this break during the week, so they

00:06:10.455 --> 00:06:11.815
<v Speaker 0>probably know what's coming.

00:06:12.135 --> 00:06:13.415
<v Speaker 0>But feel Yeah.

00:06:14.370 --> 00:06:15.330
<v Speaker 0>Okay.

00:06:15.330 --> 00:06:17.410
<v Speaker 0>Well, let's just get started. We are a

00:06:17.410 --> 00:06:18.610
<v Speaker 0>little bit late today. We just had some

00:06:18.610 --> 00:06:20.850
<v Speaker 0>technical hiccups that we have all resolved. We're

00:06:20.850 --> 00:06:22.930
<v Speaker 0>gonna jump on to Chris's cluster first. So

00:06:22.930 --> 00:06:24.770
<v Speaker 0>Thomas and I will be putting on this.

00:06:24.770 --> 00:06:26.530
<v Speaker 0>Chris, we will ask you for help as

00:06:26.530 --> 00:06:27.890
<v Speaker 0>we need. Feel free not to laugh too

00:06:27.890 --> 00:06:30.745
<v Speaker 0>loudly, but we will do our best.

00:06:31.305 --> 00:06:32.664
<v Speaker 1>Have No. This is gonna be great. We're

00:06:32.664 --> 00:06:33.944
<v Speaker 2>gonna have we're gonna have a great time.

00:06:33.944 --> 00:06:35.305
<v Speaker 1>It's gonna be a lot of fun.

00:06:35.944 --> 00:06:36.745
<v Speaker 0>Alright.

00:06:36.745 --> 00:06:38.824
<v Speaker 0>I have my screen shared. We are floating

00:06:38.824 --> 00:06:41.944
<v Speaker 0>heads. I am gonna open a connection onto

00:06:42.630 --> 00:06:44.470
<v Speaker 0>the control plane node.

00:06:44.790 --> 00:06:46.230
<v Speaker 0>I can see that we have a message

00:06:46.230 --> 00:06:47.830
<v Speaker 0>of the day. Thank you for that. Always

00:06:47.830 --> 00:06:50.150
<v Speaker 0>appreciate it. Thomas, can you join the session

00:06:50.150 --> 00:06:52.150
<v Speaker 0>and give me a echo hello so that

00:06:52.150 --> 00:06:53.910
<v Speaker 0>we know we have a shared buffer?

00:06:55.270 --> 00:06:57.350
<v Speaker 1>Oh, you're going straight into the node. Oh,

00:06:57.350 --> 00:06:57.990
<v Speaker 1>wow. Okay.

00:06:58.935 --> 00:07:01.415
<v Speaker 0>Well, I will use the Kubernetes admin token

00:07:01.415 --> 00:07:03.175
<v Speaker 0>to try and execute a get nodes or

00:07:03.175 --> 00:07:04.215
<v Speaker 0>get pods. We'll see if we have a

00:07:04.215 --> 00:07:05.655
<v Speaker 0>working control plane and we'll take it from

00:07:05.655 --> 00:07:06.135
<v Speaker 0>there.

00:07:07.574 --> 00:07:09.495
<v Speaker 1>I am here. I got coffee. I've got

00:07:09.495 --> 00:07:11.175
<v Speaker 1>some kombucha. Let's do this.

00:07:12.854 --> 00:07:13.335
<v Speaker 0>Alright.

00:07:15.919 --> 00:07:17.600
<v Speaker 0>Thomas, you're muted right now.

00:07:21.440 --> 00:07:22.000
<v Speaker 1>I don't

00:07:22.560 --> 00:07:24.400
<v Speaker 1>I think Thomas is muted. Yeah. Yeah. You've

00:07:24.400 --> 00:07:27.215
<v Speaker 0>muted yourself, man. Sorry about that. Alright.

00:07:28.415 --> 00:07:30.495
<v Speaker 2>So I tried to connect in, and it

00:07:30.495 --> 00:07:31.855
<v Speaker 2>made my own session. So how do I

00:07:31.855 --> 00:07:34.495
<v Speaker 2>share your show? Of course. On the left

00:07:34.495 --> 00:07:36.255
<v Speaker 0>hand side, there's some active sessions. If you

00:07:36.255 --> 00:07:37.935
<v Speaker 0>can click on that, please. You should see

00:07:37.935 --> 00:07:39.615
<v Speaker 0>those one by active sessions.

00:07:40.099 --> 00:07:41.699
<v Speaker 2>Okay. I will

00:07:42.979 --> 00:07:44.180
<v Speaker 2>join that one.

00:07:44.340 --> 00:07:46.020
<v Speaker 0>I'm just gonna get us

00:07:47.139 --> 00:07:49.060
<v Speaker 0>oh, I just had that weird screen blip

00:07:49.060 --> 00:07:50.500
<v Speaker 0>which means you're in a session.

00:07:52.979 --> 00:07:54.740
<v Speaker 0>So I will give you the honors, Thomas.

00:07:54.740 --> 00:07:55.539
<v Speaker 0>Feel free to type,

00:07:57.435 --> 00:07:59.195
<v Speaker 0>get nodes, get pods, whatever you want, and

00:07:59.195 --> 00:08:00.555
<v Speaker 0>let's see if we have a working control

00:08:00.555 --> 00:08:01.195
<v Speaker 0>plan.

00:08:03.435 --> 00:08:05.835
<v Speaker 2>Alright. Whoo. Okay. Wait. We do. A lot

00:08:05.835 --> 00:08:06.715
<v Speaker 2>here for this.

00:08:07.755 --> 00:08:09.035
<v Speaker 2>It it in an answers.

00:08:09.275 --> 00:08:11.035
<v Speaker 2>So that's one of the more

00:08:12.020 --> 00:08:14.580
<v Speaker 2>more impressive things that I've seen here. So

00:08:14.900 --> 00:08:16.660
<v Speaker 2>so scrolling up.

00:08:18.260 --> 00:08:19.780
<v Speaker 2>I see a lot of NOVAs.

00:08:19.780 --> 00:08:20.580
<v Speaker 0>Interesting.

00:08:21.300 --> 00:08:22.500
<v Speaker 2>Okay.

00:08:22.500 --> 00:08:23.780
<v Speaker 2>So we have a lot

00:08:24.180 --> 00:08:26.740
<v Speaker 2>we have a lot of stuff here. So

00:08:29.035 --> 00:08:31.035
<v Speaker 2>one of the let's see.

00:08:31.355 --> 00:08:32.075
<v Speaker 2>Google.

00:08:34.155 --> 00:08:34.875
<v Speaker 2>What's

00:08:36.794 --> 00:08:38.075
<v Speaker 2>it's the thing to

00:08:38.315 --> 00:08:38.794
<v Speaker 2>no.

00:08:40.600 --> 00:08:42.200
<v Speaker 2>It's the thing to dump all the config

00:08:42.200 --> 00:08:43.160
<v Speaker 2>to a

00:08:43.480 --> 00:08:44.440
<v Speaker 2>file again.

00:08:45.480 --> 00:08:49.160
<v Speaker 2>Buster info. That's

00:08:49.160 --> 00:08:51.000
<v Speaker 2>what I'm trying to do. Alright.

00:08:53.905 --> 00:08:55.585
<v Speaker 2>Okay.

00:08:55.585 --> 00:08:56.305
<v Speaker 2>So,

00:08:56.785 --> 00:08:58.225
<v Speaker 2>yeah, we got a lot of junk going

00:08:58.225 --> 00:08:58.945
<v Speaker 2>on here.

00:09:01.665 --> 00:09:04.065
<v Speaker 1>I love watching. I like I've already learned,

00:09:04.065 --> 00:09:06.065
<v Speaker 1>like, three things just watching you so far.

00:09:07.830 --> 00:09:08.550
<v Speaker 2>Well,

00:09:08.870 --> 00:09:10.950
<v Speaker 2>so as I was talking to I I

00:09:10.950 --> 00:09:12.950
<v Speaker 2>mentioned this before the the stream that,

00:09:14.390 --> 00:09:16.470
<v Speaker 2>know, when I broke a cluster previously, I

00:09:16.470 --> 00:09:17.910
<v Speaker 2>realized that one of the things this is

00:09:17.910 --> 00:09:21.505
<v Speaker 2>like is it's it's almost like investigating

00:09:21.665 --> 00:09:24.305
<v Speaker 2>a security incident. Like, you've got a parasite

00:09:24.305 --> 00:09:25.265
<v Speaker 2>in your system.

00:09:25.585 --> 00:09:28.305
<v Speaker 2>So I'm I'm trying to collect some information

00:09:28.305 --> 00:09:28.865
<v Speaker 2>first.

00:09:29.585 --> 00:09:31.745
<v Speaker 1>You're doing great. In in which case, like,

00:09:31.745 --> 00:09:33.505
<v Speaker 1>I feel like I I I left a

00:09:33.505 --> 00:09:35.220
<v Speaker 1>good amount of clues. So this is gonna

00:09:35.220 --> 00:09:36.580
<v Speaker 1>be really fun. I'm stoked to see how

00:09:36.580 --> 00:09:37.540
<v Speaker 1>this plays out. So

00:09:39.700 --> 00:09:42.660
<v Speaker 2>this is really weird scrolling behavior, though. Alright.

00:09:42.660 --> 00:09:44.500
<v Speaker 0>Yeah. Just reload the page. It'll fix the

00:09:44.500 --> 00:09:45.460
<v Speaker 0>scrolling behavior.

00:09:45.620 --> 00:09:47.940
<v Speaker 0>It it does happen, actually. It's really annoying.

00:09:47.940 --> 00:09:48.660
<v Speaker 0>I got it.

00:09:49.860 --> 00:09:51.995
<v Speaker 2>Sort of. I haven't. Sorry. I can't see

00:09:51.995 --> 00:09:53.675
<v Speaker 2>the bottom of my screen yet.

00:09:54.154 --> 00:09:55.355
<v Speaker 2>There we go. Alright.

00:09:56.954 --> 00:09:58.154
<v Speaker 2>So what is the

00:09:58.634 --> 00:10:00.154
<v Speaker 2>the test to see

00:10:01.194 --> 00:10:01.915
<v Speaker 2>the

00:10:02.315 --> 00:10:03.115
<v Speaker 2>what do you call it?

00:10:03.899 --> 00:10:05.660
<v Speaker 2>Isn't there like a WordPress app or something

00:10:05.660 --> 00:10:07.100
<v Speaker 2>that we're supposed to do to see, like,

00:10:07.100 --> 00:10:08.220
<v Speaker 2>how it works and

00:10:09.660 --> 00:10:12.140
<v Speaker 2>to effectively say, is this thing healthy?

00:10:13.820 --> 00:10:15.260
<v Speaker 0>It looks like it's What would rate for

00:10:15.260 --> 00:10:16.060
<v Speaker 2>is this healthy?

00:10:17.775 --> 00:10:19.135
<v Speaker 2>It's running. I

00:10:20.095 --> 00:10:21.935
<v Speaker 1>I I would say if if you can

00:10:21.935 --> 00:10:22.415
<v Speaker 1>get

00:10:22.815 --> 00:10:25.215
<v Speaker 1>the WordPress app or whatever it is that

00:10:25.215 --> 00:10:27.855
<v Speaker 1>that Rawkode has in in his repo, you

00:10:27.855 --> 00:10:29.055
<v Speaker 1>can get that running

00:10:30.175 --> 00:10:32.709
<v Speaker 1>and and get the cluster into a state

00:10:32.709 --> 00:10:34.630
<v Speaker 1>where it'll continue to run. I will I

00:10:34.630 --> 00:10:36.310
<v Speaker 1>I will buy you a steak dinner.

00:10:38.630 --> 00:10:39.350
<v Speaker 0>Okay.

00:10:39.509 --> 00:10:42.230
<v Speaker 0>So we do have a clustered pod running

00:10:42.230 --> 00:10:43.829
<v Speaker 0>in the default namespace.

00:10:44.630 --> 00:10:46.550
<v Speaker 0>Whether it's actually running or not, I'm not

00:10:46.550 --> 00:10:46.709
<v Speaker 0>sure.

00:10:47.925 --> 00:10:49.765
<v Speaker 0>Whether we can even upgrade it to the

00:10:49.765 --> 00:10:52.405
<v Speaker 0>version two, I'm doubly not sure.

00:10:55.605 --> 00:10:56.885
<v Speaker 2>Alright. So

00:10:59.925 --> 00:11:00.805
<v Speaker 0>What is FLS?

00:11:02.530 --> 00:11:04.050
<v Speaker 2>So one of the things I'm going to

00:11:04.050 --> 00:11:04.610
<v Speaker 2>do

00:11:05.250 --> 00:11:06.050
<v Speaker 2>is

00:11:06.050 --> 00:11:07.730
<v Speaker 2>basically make a

00:11:09.330 --> 00:11:10.770
<v Speaker 2>since I know we're dealing with a kernel

00:11:10.770 --> 00:11:11.650
<v Speaker 2>hacker here,

00:11:11.970 --> 00:11:14.610
<v Speaker 2>I'm going to make a, basically, a dump

00:11:14.610 --> 00:11:15.890
<v Speaker 2>of the file system

00:11:16.915 --> 00:11:17.795
<v Speaker 2>and

00:11:20.515 --> 00:11:23.395
<v Speaker 2>a dump of all the file system changes

00:11:23.395 --> 00:11:24.275
<v Speaker 2>recently.

00:11:25.955 --> 00:11:28.835
<v Speaker 2>So FLS is part of SleuthKit, which is

00:11:28.835 --> 00:11:30.675
<v Speaker 2>showing my age a little bit.

00:11:35.740 --> 00:11:36.540
<v Speaker 1>I

00:11:36.700 --> 00:11:38.620
<v Speaker 1>I I've I put this on easy mode.

00:11:38.620 --> 00:11:39.900
<v Speaker 1>If I would've known we were really gonna

00:11:39.900 --> 00:11:41.820
<v Speaker 1>be doing this, I would've it would've made

00:11:41.820 --> 00:11:43.260
<v Speaker 1>this a little bit more fun for us.

00:11:44.275 --> 00:11:47.395
<v Speaker 2>Alright. So I'm act I'm just collecting information

00:11:47.395 --> 00:11:48.995
<v Speaker 2>before mutation here. So

00:11:49.475 --> 00:11:51.475
<v Speaker 2>so for instance, what I'm showing oh, this

00:11:51.475 --> 00:11:52.995
<v Speaker 2>machine was installed recently.

00:11:53.875 --> 00:11:56.675
<v Speaker 0>Yeah. These are cluster API clusters. They respond

00:11:56.675 --> 00:11:58.355
<v Speaker 0>off a few days before. So

00:11:59.170 --> 00:12:01.090
<v Speaker 2>So I don't know when

00:12:01.730 --> 00:12:03.410
<v Speaker 2>alright. I'm just gonna start with

00:12:08.450 --> 00:12:09.170
<v Speaker 0>so

00:12:10.690 --> 00:12:14.130
<v Speaker 2>for instance, I can see that

00:12:13.365 --> 00:12:15.845
<v Speaker 2>the most recent changes on the file system

00:12:18.165 --> 00:12:18.885
<v Speaker 2>are

00:12:19.125 --> 00:12:21.605
<v Speaker 2>basically here. It's basically sorted order of changes

00:12:21.605 --> 00:12:23.045
<v Speaker 2>in the file system, and I'm going to

00:12:23.045 --> 00:12:25.445
<v Speaker 2>collect it for later. I do notice

00:12:25.685 --> 00:12:28.725
<v Speaker 2>some bizarre things already here. I see a

00:12:29.150 --> 00:12:30.270
<v Speaker 2>system d

00:12:30.910 --> 00:12:33.550
<v Speaker 2>change here. It looks like some files were

00:12:33.550 --> 00:12:35.470
<v Speaker 2>edited in this directory with them.

00:12:38.190 --> 00:12:38.750
<v Speaker 2>So

00:12:39.230 --> 00:12:41.710
<v Speaker 2>so yeah. Anyways, let's go to the let's

00:12:41.950 --> 00:12:43.790
<v Speaker 2>now that I've collected the the data,

00:12:44.595 --> 00:12:46.915
<v Speaker 2>how do we get can can you drive

00:12:46.915 --> 00:12:48.675
<v Speaker 2>a little bit for how do we test

00:12:48.675 --> 00:12:49.955
<v Speaker 2>your WordPress app?

00:12:50.595 --> 00:12:53.714
<v Speaker 0>Yes. We can definitely do that. So Alright.

00:12:53.714 --> 00:12:56.195
<v Speaker 0>What I would normally do is

00:12:56.515 --> 00:12:57.475
<v Speaker 0>run get pods.

00:12:59.630 --> 00:13:01.150
<v Speaker 0>And I should have just used my alias,

00:13:01.150 --> 00:13:02.030
<v Speaker 0>but there we go.

00:13:02.510 --> 00:13:04.590
<v Speaker 0>Well, okay. Our app is

00:13:05.230 --> 00:13:06.750
<v Speaker 2>So it's gone. Gone.

00:13:07.150 --> 00:13:08.910
<v Speaker 1>Yeah. Okay. And and just just for the

00:13:08.910 --> 00:13:10.590
<v Speaker 1>record, I just I I really like the

00:13:10.590 --> 00:13:12.190
<v Speaker 1>fact that they're all in crash loop back

00:13:12.190 --> 00:13:13.950
<v Speaker 1>off. That that was by design and and

00:13:13.950 --> 00:13:16.005
<v Speaker 1>I'm just really happy with this aesthetic right

00:13:16.005 --> 00:13:17.925
<v Speaker 1>now. So this was a big part of

00:13:17.925 --> 00:13:18.885
<v Speaker 1>my work.

00:13:20.005 --> 00:13:21.685
<v Speaker 0>I love that you've got it to deliver

00:13:21.685 --> 00:13:24.405
<v Speaker 0>a message all nicely lined up. That's that's

00:13:24.405 --> 00:13:25.365
<v Speaker 0>pretty special.

00:13:26.565 --> 00:13:28.790
<v Speaker 2>So where do we find your app to

00:13:28.790 --> 00:13:29.589
<v Speaker 2>deploy?

00:13:30.870 --> 00:13:32.149
<v Speaker 0>Okay. So we can just

00:13:32.870 --> 00:13:33.589
<v Speaker 0>press space.

00:13:33.990 --> 00:13:36.550
<v Speaker 0>Switch over to a do that locally, but

00:13:36.550 --> 00:13:37.430
<v Speaker 0>we can do that.

00:13:38.630 --> 00:13:39.190
<v Speaker 1>Alright.

00:13:47.495 --> 00:13:48.935
<v Speaker 0>Okay. Clustered.

00:13:48.935 --> 00:13:51.335
<v Speaker 0>This is cluster 22,

00:13:51.975 --> 00:13:54.375
<v Speaker 0>and I can just run just workloads, and

00:13:54.375 --> 00:13:55.255
<v Speaker 0>we'll see if it works.

00:14:01.200 --> 00:14:03.200
<v Speaker 1>This is what I love most about this.

00:14:03.200 --> 00:14:04.880
<v Speaker 1>This just just

00:14:05.680 --> 00:14:07.520
<v Speaker 1>this makes me gives me the warm and

00:14:07.520 --> 00:14:07.920
<v Speaker 1>fuzzies.

00:14:11.055 --> 00:14:13.135
<v Speaker 0>So we it did create it.

00:14:13.695 --> 00:14:15.695
<v Speaker 0>At least it says it did, but

00:14:16.815 --> 00:14:18.815
<v Speaker 0>running get pods on teleport

00:14:18.894 --> 00:14:20.415
<v Speaker 0>as a big no no,

00:14:21.214 --> 00:14:22.175
<v Speaker 0>which makes me think.

00:14:25.110 --> 00:14:26.710
<v Speaker 0>I don't know yet.

00:14:29.110 --> 00:14:31.110
<v Speaker 0>Are we speaking to the real API server?

00:14:35.205 --> 00:14:37.205
<v Speaker 2>Are we speaking to the real API server?

00:14:37.205 --> 00:14:39.765
<v Speaker 0>Yeah. So I'm gonna run my Just Workload

00:14:39.765 --> 00:14:41.045
<v Speaker 0>again. I wanna see if it says changed

00:14:41.045 --> 00:14:41.925
<v Speaker 0>or created.

00:14:42.565 --> 00:14:44.805
<v Speaker 0>Okay. It's saying created. So we're getting the

00:14:44.805 --> 00:14:47.285
<v Speaker 0>API server. We're getting a response, but nothing

00:14:47.285 --> 00:14:49.285
<v Speaker 0>is changing state in the cluster.

00:15:02.935 --> 00:15:05.735
<v Speaker 0>Alright. So let's take a look. I'm not

00:15:06.295 --> 00:15:07.895
<v Speaker 2>I'm not quite following here.

00:15:08.215 --> 00:15:09.335
<v Speaker 0>Sorry. So

00:15:09.655 --> 00:15:11.735
<v Speaker 0>can you see my screen at the moment?

00:15:12.055 --> 00:15:14.470
<v Speaker 2>Yeah. I I can see your your screen,

00:15:14.470 --> 00:15:16.150
<v Speaker 2>which is the same as my screen. Yeah.

00:15:16.150 --> 00:15:17.750
<v Speaker 0>So on my local terminal, which I I

00:15:17.750 --> 00:15:19.910
<v Speaker 0>need to deploy the application, I ran Yep.

00:15:19.990 --> 00:15:21.750
<v Speaker 0>Just workload twice. And you can see here

00:15:21.750 --> 00:15:24.630
<v Speaker 0>we're getting created and created. So, like,

00:15:25.590 --> 00:15:27.350
<v Speaker 0>I don't think it's actually being created. Otherwise,

00:15:27.350 --> 00:15:30.305
<v Speaker 0>we'd see unchanged on that second deploy. So

00:15:30.305 --> 00:15:32.625
<v Speaker 0>where we are speaking to an API server,

00:15:33.825 --> 00:15:34.464
<v Speaker 0>we're not

00:15:35.665 --> 00:15:37.585
<v Speaker 0>something's not happening on the back end, so

00:15:37.585 --> 00:15:38.785
<v Speaker 0>we need to work that out.

00:15:39.985 --> 00:15:40.625
<v Speaker 2>Alright.

00:15:42.940 --> 00:15:43.900
<v Speaker 2>Interesting.

00:15:44.220 --> 00:15:44.780
<v Speaker 2>Yeah.

00:15:45.660 --> 00:15:48.220
<v Speaker 2>It's

00:15:48.860 --> 00:15:52.140
<v Speaker 2>somewhat difficult, but not impossible, to have

00:15:52.380 --> 00:15:55.555
<v Speaker 2>a fake API server. But what is going

00:15:55.555 --> 00:15:57.395
<v Speaker 2>on here? Are we talking to the API

00:15:57.395 --> 00:15:59.555
<v Speaker 2>server on the right machine? Yeah. So I

00:15:59.555 --> 00:16:01.555
<v Speaker 0>I think we probably are based on the

00:16:01.555 --> 00:16:03.555
<v Speaker 0>fact that Chris didn't know we were gonna

00:16:03.555 --> 00:16:04.915
<v Speaker 0>jump on to the node and use this

00:16:04.915 --> 00:16:05.635
<v Speaker 0>token.

00:16:06.195 --> 00:16:06.835
<v Speaker 0>So

00:16:07.395 --> 00:16:08.355
<v Speaker 0>I think

00:16:09.050 --> 00:16:11.290
<v Speaker 2>Yeah. I mean, the certificates match and everything

00:16:11.290 --> 00:16:13.449
<v Speaker 2>else. Like Yeah. So I think this is

00:16:13.449 --> 00:16:15.769
<v Speaker 0>a real API server. I'm assuming we've maybe

00:16:15.769 --> 00:16:16.490
<v Speaker 0>got

00:16:17.370 --> 00:16:19.129
<v Speaker 0>yeah. If it was a, like, an admission

00:16:19.129 --> 00:16:21.850
<v Speaker 0>controller, it wouldn't say created on our site.

00:16:22.410 --> 00:16:23.449
<v Speaker 0>So it must be someone else.

00:16:24.575 --> 00:16:26.495
<v Speaker 0>I can see Chris just giggling.

00:16:27.055 --> 00:16:28.255
<v Speaker 1>I'm

00:16:28.255 --> 00:16:29.935
<v Speaker 1>I'm I'm not giggling. I mean, to be

00:16:29.935 --> 00:16:33.135
<v Speaker 1>fair, like, Thomas Thomas is the hero. Like,

00:16:33.375 --> 00:16:35.055
<v Speaker 1>the game's kind of already over.

00:16:36.015 --> 00:16:38.415
<v Speaker 1>But, like, I I wanna see how you

00:16:38.415 --> 00:16:39.850
<v Speaker 1>would go about fixing this because this is

00:16:39.850 --> 00:16:41.449
<v Speaker 1>gonna be really cool. And I think this

00:16:41.449 --> 00:16:42.649
<v Speaker 1>demonstrates a lot of

00:16:43.930 --> 00:16:45.370
<v Speaker 1>I mean, like, I I'll just let you

00:16:45.370 --> 00:16:46.649
<v Speaker 1>guys go through it. You're doing great. You're

00:16:46.649 --> 00:16:49.209
<v Speaker 1>gonna you're gonna find it. Alright. I'm I'm

00:16:49.209 --> 00:16:50.970
<v Speaker 2>gonna go first with

00:16:51.105 --> 00:16:53.185
<v Speaker 2>identifying the weird things that I saw in

00:16:53.185 --> 00:16:54.865
<v Speaker 2>the file system. Okay.

00:16:55.105 --> 00:16:56.945
<v Speaker 2>And hope that will give us some of

00:16:56.945 --> 00:16:57.425
<v Speaker 2>the

00:16:58.385 --> 00:17:00.144
<v Speaker 2>some of the interesting bits here.

00:17:00.464 --> 00:17:02.704
<v Speaker 2>And so we we have this wonderful bash

00:17:02.704 --> 00:17:04.145
<v Speaker 2>script that I saw earlier,

00:17:05.220 --> 00:17:07.460
<v Speaker 2>which is highly suspicious here.

00:17:08.020 --> 00:17:10.339
<v Speaker 1>It's highly suspicious. And to be honest,

00:17:11.060 --> 00:17:13.619
<v Speaker 1>I was I was anticipating this being the

00:17:13.619 --> 00:17:15.780
<v Speaker 1>last thing we found. So watching you approach

00:17:15.780 --> 00:17:18.195
<v Speaker 1>this the other way is gonna be really

00:17:18.195 --> 00:17:20.435
<v Speaker 1>fun. I'm real I'm literally, like, tickled right

00:17:20.435 --> 00:17:21.474
<v Speaker 1>now. This is great.

00:17:21.954 --> 00:17:22.355
<v Speaker 2>Yeah.

00:17:30.130 --> 00:17:31.970
<v Speaker 2>Oops. Okay. So

00:17:34.610 --> 00:17:37.570
<v Speaker 2>so what did we do here? All right.

00:17:41.090 --> 00:17:42.290
<v Speaker 2>So you did mention

00:17:43.065 --> 00:17:46.745
<v Speaker 2>oh, you are evil. Is this an API

00:17:46.745 --> 00:17:47.945
<v Speaker 0>server aggregation?

00:17:47.945 --> 00:17:48.345
<v Speaker 2>This is

00:17:49.304 --> 00:17:50.584
<v Speaker 2>yeah. Look at this.

00:17:51.225 --> 00:17:53.144
<v Speaker 2>The affected API server.

00:17:53.465 --> 00:17:54.424
<v Speaker 2>So, yeah, you were,

00:17:55.640 --> 00:17:57.719
<v Speaker 2>Oh, what did you do to my life?

00:17:58.440 --> 00:17:59.960
<v Speaker 1>Oh, okay. I'm sorry.

00:18:01.559 --> 00:18:02.440
<v Speaker 2>So

00:18:02.600 --> 00:18:04.679
<v Speaker 2>okay. So there's there's a lot of evil

00:18:04.679 --> 00:18:05.719
<v Speaker 2>happening here.

00:18:07.399 --> 00:18:08.120
<v Speaker 2>Let's see.

00:18:11.835 --> 00:18:14.475
<v Speaker 2>What what do we do here? Right. So

00:18:16.635 --> 00:18:18.875
<v Speaker 2>okay. Okay. So I see so I'm base

00:18:19.115 --> 00:18:21.115
<v Speaker 2>basically just dumping a list of here are

00:18:21.115 --> 00:18:22.955
<v Speaker 2>all the images on running containers.

00:18:25.590 --> 00:18:28.229
<v Speaker 2>Let me actually do this a little differently.

00:18:33.350 --> 00:18:35.110
<v Speaker 1>Thomas, I'm gonna have to get that FLS

00:18:35.110 --> 00:18:37.795
<v Speaker 1>command from you. That that that thing saved

00:18:37.795 --> 00:18:39.555
<v Speaker 1>the day here. That's the real hero of

00:18:39.555 --> 00:18:41.315
<v Speaker 1>the show. If everybody here walks away with

00:18:41.315 --> 00:18:43.315
<v Speaker 1>that copy pasta from Thomas, we're

00:18:45.395 --> 00:18:47.235
<v Speaker 2>If you if you,

00:18:47.635 --> 00:18:49.555
<v Speaker 2>yeah, if you ever have to deal with

00:18:50.080 --> 00:18:52.240
<v Speaker 2>infected machines now there's probably better things. This

00:18:52.240 --> 00:18:54.560
<v Speaker 2>is what I used, like, fifteen years ago.

00:18:54.560 --> 00:18:54.960
<v Speaker 2>But

00:18:55.520 --> 00:18:57.360
<v Speaker 2>Yeah. Let's

00:18:57.360 --> 00:18:57.840
<v Speaker 2>see.

00:18:58.480 --> 00:18:58.960
<v Speaker 2>So

00:19:00.480 --> 00:19:03.200
<v Speaker 2>so infect API server. I mean, that seems

00:19:03.200 --> 00:19:04.400
<v Speaker 2>to be, like, one of the first things

00:19:04.400 --> 00:19:06.415
<v Speaker 2>to kill, I guess. Well, can we check

00:19:06.415 --> 00:19:08.095
<v Speaker 0>some of the basics first? Right? Like Yeah.

00:19:08.095 --> 00:19:09.615
<v Speaker 2>Yeah. Let's check the basics. Look in the

00:19:09.615 --> 00:19:10.815
<v Speaker 0>static manifest,

00:19:10.815 --> 00:19:12.415
<v Speaker 0>like, I expect to see an API server

00:19:12.415 --> 00:19:15.055
<v Speaker 0>here. Yeah. Immediately, see it's been date is

00:19:15.055 --> 00:19:16.095
<v Speaker 0>different. Modified.

00:19:19.720 --> 00:19:22.440
<v Speaker 0>Yeah. Okay. There we go. It's with that

00:19:22.440 --> 00:19:24.520
<v Speaker 2>with that it's that temp file we saw.

00:19:24.520 --> 00:19:25.159
<v Speaker 0>Yeah.

00:19:26.600 --> 00:19:29.240
<v Speaker 0>So we could use QBDM just to reprovision

00:19:29.240 --> 00:19:30.760
<v Speaker 0>the APIs to our phase. Right?

00:19:31.575 --> 00:19:34.054
<v Speaker 2>Yeah. So I wonder now here's here's a

00:19:34.054 --> 00:19:36.375
<v Speaker 2>question that FLS can help the FLS data

00:19:36.375 --> 00:19:37.734
<v Speaker 2>can help identify.

00:19:38.375 --> 00:19:39.014
<v Speaker 2>Was

00:19:39.735 --> 00:19:43.255
<v Speaker 2>was the original copied was was Chris

00:19:43.255 --> 00:19:45.495
<v Speaker 2>nice enough to copy the original one anywhere

00:19:45.495 --> 00:19:47.820
<v Speaker 2>else? I actually, looking at the script, it

00:19:47.820 --> 00:19:49.179
<v Speaker 2>doesn't look like she was.

00:19:50.140 --> 00:19:52.140
<v Speaker 1>I I I have a copy. I I

00:19:52.140 --> 00:19:53.179
<v Speaker 1>have a copy.

00:19:53.820 --> 00:19:54.460
<v Speaker 1>Yeah.

00:19:55.020 --> 00:19:56.700
<v Speaker 1>I can I can send you one as

00:19:56.700 --> 00:19:57.580
<v Speaker 1>well? I just have to go in the

00:19:57.580 --> 00:19:58.860
<v Speaker 2>other room and get it off my local

00:19:58.860 --> 00:19:59.340
<v Speaker 2>social team.

00:20:00.914 --> 00:20:02.514
<v Speaker 2>So, yeah, I think that's

00:20:03.155 --> 00:20:04.994
<v Speaker 2>look. Can we kill that

00:20:05.395 --> 00:20:07.475
<v Speaker 2>that infect pod and then Well, we can

00:20:07.475 --> 00:20:09.955
<v Speaker 0>remove the the API server from the manifest

00:20:09.955 --> 00:20:12.035
<v Speaker 0>directory, which the kubelet will then get rid

00:20:12.035 --> 00:20:12.275
<v Speaker 0>of it.

00:20:14.150 --> 00:20:15.750
<v Speaker 0>We can either copy the q b d

00:20:15.750 --> 00:20:17.990
<v Speaker 0>I API server from another machine or we

00:20:17.990 --> 00:20:19.750
<v Speaker 0>can try and fluff our way through the

00:20:19.750 --> 00:20:21.430
<v Speaker 0>q b d m commands, which I think

00:20:21.430 --> 00:20:21.990
<v Speaker 0>is

00:20:22.870 --> 00:20:24.710
<v Speaker 0>in a oh, no. Help.

00:20:25.365 --> 00:20:26.804
<v Speaker 0>Is it not phases?

00:20:26.804 --> 00:20:27.605
<v Speaker 0>Phases.

00:20:28.725 --> 00:20:29.845
<v Speaker 0>Hold on. I'm trying to remember how to

00:20:29.845 --> 00:20:31.445
<v Speaker 0>curate the end. A phase for just dumping

00:20:31.445 --> 00:20:32.404
<v Speaker 2>the config,

00:20:33.285 --> 00:20:34.164
<v Speaker 2>I think.

00:20:34.804 --> 00:20:36.005
<v Speaker 0>I'm

00:20:36.005 --> 00:20:38.085
<v Speaker 0>sure it's in it phases something.

00:21:09.635 --> 00:21:11.394
<v Speaker 0>Why did I not remember how to do

00:21:11.394 --> 00:21:11.715
<v Speaker 0>this?

00:21:19.009 --> 00:21:20.849
<v Speaker 1>So a a clue would be

00:21:21.809 --> 00:21:23.250
<v Speaker 1>if you can get just get rid of

00:21:23.250 --> 00:21:25.250
<v Speaker 1>the container, that little everything I put in

00:21:25.250 --> 00:21:27.745
<v Speaker 1>the comments, that's that's really the only mutation

00:21:27.745 --> 00:21:29.905
<v Speaker 1>you should you should care about. It's I

00:21:29.905 --> 00:21:31.664
<v Speaker 1>I put a big block around it.

00:21:33.345 --> 00:21:35.825
<v Speaker 1>So it should be safe to say if

00:21:35.825 --> 00:21:37.585
<v Speaker 1>if we can get that code block to

00:21:37.585 --> 00:21:37.985
<v Speaker 1>go away,

00:21:38.910 --> 00:21:41.150
<v Speaker 1>we'll we're we're back you know, Jurassic Park

00:21:41.150 --> 00:21:43.070
<v Speaker 1>is back online. Well, that pod should already

00:21:43.070 --> 00:21:45.790
<v Speaker 0>be deleted because we removed the static manifest.

00:21:47.710 --> 00:21:48.510
<v Speaker 1>Okay.

00:21:50.990 --> 00:21:52.030
<v Speaker 2>Sorry. What did you say there?

00:21:54.185 --> 00:21:56.025
<v Speaker 0>I thought that pod would be away because

00:21:56.025 --> 00:21:57.945
<v Speaker 0>we removed the static manifest, but then I

00:21:57.945 --> 00:21:59.385
<v Speaker 0>can see in cube system, we still have

00:21:59.385 --> 00:22:00.745
<v Speaker 0>a cube API server.

00:22:04.905 --> 00:22:06.585
<v Speaker 0>Oh, that's just a real API server.

00:22:09.759 --> 00:22:10.959
<v Speaker 0>Can we edit that?

00:22:11.840 --> 00:22:12.799
<v Speaker 0>Oh, no. No.

00:22:13.120 --> 00:22:14.320
<v Speaker 0>That can't be right.

00:22:15.840 --> 00:22:16.479
<v Speaker 0>Yeah.

00:22:20.000 --> 00:22:21.440
<v Speaker 0>Hey. Did I not delete this file?

00:22:23.725 --> 00:22:25.804
<v Speaker 2>No. We haven't deleted this file yet. I

00:22:25.804 --> 00:22:26.365
<v Speaker 0>did.

00:22:27.965 --> 00:22:30.205
<v Speaker 2>Oh, did it get reinserted by

00:22:31.485 --> 00:22:33.644
<v Speaker 0>A mysterious force? I think so.

00:22:33.885 --> 00:22:35.565
<v Speaker 0>Oh, sorry. On you go. Stop.

00:22:37.940 --> 00:22:39.780
<v Speaker 1>This is great. I I love watching the

00:22:39.780 --> 00:22:41.940
<v Speaker 1>the teamwork here, how we have kernel introspection

00:22:41.940 --> 00:22:44.820
<v Speaker 1>coupled with Kubernetes expertise because this is this

00:22:44.820 --> 00:22:46.179
<v Speaker 1>is good. This is good stuff.

00:22:49.299 --> 00:22:50.900
<v Speaker 0>I I am so sure I did an

00:22:50.900 --> 00:22:53.059
<v Speaker 0>RM on that failed to to the move.

00:22:53.059 --> 00:22:55.835
<v Speaker 2>I I did not see an RM. Alright.

00:22:55.835 --> 00:22:57.995
<v Speaker 0>Let's let's do it again. We've always got

00:22:57.995 --> 00:22:59.755
<v Speaker 0>the fact that copy and temporary. Maybe I

00:22:59.755 --> 00:23:01.354
<v Speaker 2>just wasn't paying attention. But

00:23:01.914 --> 00:23:02.475
<v Speaker 2>yeah.

00:23:04.315 --> 00:23:05.674
<v Speaker 2>It's there again. Excellent.

00:23:06.680 --> 00:23:07.799
<v Speaker 2>So so

00:23:08.920 --> 00:23:12.200
<v Speaker 2>I think it's basically just reinserting itself. Yeah.

00:23:13.880 --> 00:23:14.919
<v Speaker 2>Wonderful.

00:23:14.920 --> 00:23:16.280
<v Speaker 0>What's the e attribute?

00:23:20.055 --> 00:23:21.575
<v Speaker 2>Beats me, but it could just be the

00:23:21.575 --> 00:23:22.534
<v Speaker 2>same as others.

00:23:24.855 --> 00:23:25.575
<v Speaker 2>Alright.

00:23:26.775 --> 00:23:29.015
<v Speaker 2>So we have unknown processes running on this

00:23:29.015 --> 00:23:31.175
<v Speaker 2>machine that are that are mutating this file.

00:23:31.175 --> 00:23:31.495
<v Speaker 2>So

00:23:34.350 --> 00:23:35.870
<v Speaker 2>we could use,

00:23:38.430 --> 00:23:39.070
<v Speaker 2>like,

00:23:39.790 --> 00:23:42.270
<v Speaker 2>audit CTL or something like that to actually

00:23:42.270 --> 00:23:44.350
<v Speaker 2>watch the file system changes. But

00:23:45.765 --> 00:23:47.525
<v Speaker 2>then I have a lot of copy pasting

00:23:47.525 --> 00:23:49.125
<v Speaker 2>to do, and I don't I don't have

00:23:49.125 --> 00:23:51.125
<v Speaker 2>audit CTL memorized. So

00:23:53.765 --> 00:23:55.525
<v Speaker 2>but So there's there's,

00:23:55.525 --> 00:23:57.285
<v Speaker 1>like, three directions I can nudge us in,

00:23:57.285 --> 00:23:58.530
<v Speaker 1>which would be fix

00:23:58.690 --> 00:24:00.450
<v Speaker 1>going about Kubernetes

00:24:00.530 --> 00:24:02.530
<v Speaker 1>and and what we would wanna look for

00:24:02.530 --> 00:24:04.210
<v Speaker 1>there and how we could find some introspection

00:24:04.210 --> 00:24:06.530
<v Speaker 1>there. There's the the things on the file

00:24:06.530 --> 00:24:08.210
<v Speaker 1>system we've already found. There's some more clues

00:24:08.210 --> 00:24:10.690
<v Speaker 1>in there as well. Oh, yeah. And then

00:24:10.534 --> 00:24:11.335
<v Speaker 1>ultimately,

00:24:11.414 --> 00:24:12.134
<v Speaker 1>I think,

00:24:12.774 --> 00:24:14.215
<v Speaker 1>like I said in the beginning, that that

00:24:14.215 --> 00:24:16.215
<v Speaker 1>first FLS, that's like, you got the keys

00:24:16.215 --> 00:24:17.975
<v Speaker 1>to the kingdom right there, baby. Like, that's

00:24:17.975 --> 00:24:18.934
<v Speaker 1>got all you need.

00:24:19.335 --> 00:24:19.974
<v Speaker 2>Yep.

00:24:20.534 --> 00:24:21.254
<v Speaker 1>Yep.

00:24:21.414 --> 00:24:23.174
<v Speaker 2>Alright. So let's let's go ahead and disable

00:24:23.174 --> 00:24:24.615
<v Speaker 2>some of these random things we found in

00:24:24.615 --> 00:24:27.100
<v Speaker 2>the file system. And there's there's a I

00:24:27.100 --> 00:24:29.580
<v Speaker 2>saw two suspicious system b services,

00:24:30.220 --> 00:24:32.940
<v Speaker 2>one NTP and one Nova. So let's let's

00:24:32.940 --> 00:24:34.940
<v Speaker 2>go ahead and look at those. So

00:24:35.980 --> 00:24:38.220
<v Speaker 1>And I I I did name everything very

00:24:38.905 --> 00:24:39.865
<v Speaker 1>politely,

00:24:40.105 --> 00:24:41.304
<v Speaker 1>if that makes sense. Yeah.

00:24:45.705 --> 00:24:46.985
<v Speaker 2>Alright. So

00:24:47.545 --> 00:24:48.745
<v Speaker 2>alright. So

00:24:49.625 --> 00:24:50.105
<v Speaker 2>system

00:24:50.425 --> 00:24:52.345
<v Speaker 2>so we have this Nova service

00:24:56.640 --> 00:24:59.440
<v Speaker 2>that starts that up so we can

00:25:01.520 --> 00:25:02.159
<v Speaker 1>and

00:25:05.919 --> 00:25:08.639
<v Speaker 2>we've got this NTP service that

00:25:08.720 --> 00:25:09.200
<v Speaker 2>was

00:25:10.405 --> 00:25:11.845
<v Speaker 2>a little suspicious,

00:25:12.005 --> 00:25:13.125
<v Speaker 2>but maybe not

00:25:13.765 --> 00:25:14.804
<v Speaker 2>that suspicious.

00:25:15.445 --> 00:25:17.284
<v Speaker 2>Looks It's clear. Fairly normal.

00:25:18.165 --> 00:25:20.085
<v Speaker 1>Yeah. So that should be fine.

00:25:20.885 --> 00:25:21.445
<v Speaker 2>Alright.

00:25:21.970 --> 00:25:22.610
<v Speaker 0>So

00:25:23.090 --> 00:25:25.170
<v Speaker 0>So we did a system control disable, but

00:25:25.170 --> 00:25:27.010
<v Speaker 0>I don't think that stops it. Right?

00:25:27.490 --> 00:25:29.810
<v Speaker 0>We'll need to stop it as well. Yeah.

00:25:29.810 --> 00:25:30.290
<v Speaker 2>You're right.

00:25:33.985 --> 00:25:36.385
<v Speaker 0>Do we think that's responsible for putting the

00:25:36.385 --> 00:25:38.625
<v Speaker 0>dodgy manifest back in this directory? Yeah. It

00:25:38.945 --> 00:25:41.024
<v Speaker 2>well, it at least has the capability of

00:25:41.024 --> 00:25:43.105
<v Speaker 2>putting dodgy manifests in place. Let's see.

00:25:59.880 --> 00:26:00.600
<v Speaker 0>There we go.

00:26:01.625 --> 00:26:03.464
<v Speaker 1>Well done. Alright. Well done.

00:26:05.144 --> 00:26:05.864
<v Speaker 2>So

00:26:08.264 --> 00:26:10.504
<v Speaker 2>since we know the calling card anyways, I'm

00:26:10.504 --> 00:26:12.504
<v Speaker 2>just gonna look here and see if there

00:26:12.504 --> 00:26:14.664
<v Speaker 2>are any suspicious other things. I see there

00:26:14.664 --> 00:26:16.345
<v Speaker 2>is in the root directory

00:26:17.140 --> 00:26:18.980
<v Speaker 2>also a Nova, but that might have just

00:26:18.980 --> 00:26:20.100
<v Speaker 2>been development.

00:26:22.340 --> 00:26:23.940
<v Speaker 1>Yeah. There's I mean, there's a couple of,

00:26:23.940 --> 00:26:27.299
<v Speaker 1>like What is with this? LibNova? Oh, okay.

00:26:27.299 --> 00:26:27.460
<v Speaker 1>Yeah.

00:26:30.395 --> 00:26:32.235
<v Speaker 1>I'm happy you found the calling card. You've

00:26:32.235 --> 00:26:34.234
<v Speaker 1>done this before, haven't you, Thomas?

00:26:36.075 --> 00:26:37.355
<v Speaker 2>I've investigated

00:26:37.355 --> 00:26:38.715
<v Speaker 2>break ins before.

00:26:39.195 --> 00:26:39.835
<v Speaker 2>That's bad.

00:26:45.380 --> 00:26:46.580
<v Speaker 2>Not in a long time.

00:26:47.380 --> 00:26:48.580
<v Speaker 1>Yeah. No. You're questioning.

00:27:01.105 --> 00:27:03.345
<v Speaker 2>Alright. So I

00:27:04.705 --> 00:27:06.784
<v Speaker 2>might have broken something. I hope I did.

00:27:08.385 --> 00:27:09.905
<v Speaker 1>Go for it. Try to list. That'll let

00:27:09.905 --> 00:27:11.425
<v Speaker 1>you know. Just try to list, and you'll

00:27:11.425 --> 00:27:12.625
<v Speaker 1>you'll get it real quick if you I

00:27:12.625 --> 00:27:13.825
<v Speaker 1>mean, try to do anything on the file

00:27:13.825 --> 00:27:14.145
<v Speaker 1>system.

00:27:14.750 --> 00:27:15.789
<v Speaker 1>There you go.

00:27:16.990 --> 00:27:17.789
<v Speaker 2>Alright.

00:27:17.870 --> 00:27:19.549
<v Speaker 2>So we found

00:27:21.070 --> 00:27:22.269
<v Speaker 2>I

00:27:23.549 --> 00:27:25.149
<v Speaker 2>forgot And so this is where

00:27:26.269 --> 00:27:27.549
<v Speaker 1>lds0.preload.

00:27:27.549 --> 00:27:28.110
<v Speaker 1>That's the one.

00:27:28.894 --> 00:27:29.454
<v Speaker 1>Okay.

00:27:32.254 --> 00:27:34.735
<v Speaker 1>You can just echo echo empty to it,

00:27:34.735 --> 00:27:37.054
<v Speaker 1>and that should that should fix it. Yeah.

00:27:42.174 --> 00:27:42.735
<v Speaker 1>Beautiful.

00:27:44.960 --> 00:27:45.919
<v Speaker 1>And list?

00:27:48.080 --> 00:27:49.440
<v Speaker 2>Hey. Okay.

00:27:49.440 --> 00:27:52.239
<v Speaker 2>K. We got one interesting bizarre thing out.

00:27:52.480 --> 00:27:53.199
<v Speaker 2>Okay.

00:27:53.679 --> 00:27:55.359
<v Speaker 2>Next

00:27:55.600 --> 00:27:57.039
<v Speaker 2>is

00:28:00.365 --> 00:28:02.285
<v Speaker 2>alright. So what do we gotta do now

00:28:02.285 --> 00:28:03.965
<v Speaker 2>for looking at

00:28:04.765 --> 00:28:06.525
<v Speaker 0>Well, we have no API server.

00:28:07.165 --> 00:28:08.525
<v Speaker 0>Oh, no. We don't. We have an API

00:28:08.525 --> 00:28:11.005
<v Speaker 2>server, but it's not really the right one.

00:28:13.120 --> 00:28:14.399
<v Speaker 2>So

00:28:16.240 --> 00:28:18.720
<v Speaker 2>I don't know what config you used to

00:28:18.720 --> 00:28:21.040
<v Speaker 2>generate like, what the options were for your

00:28:21.040 --> 00:28:22.080
<v Speaker 2>Cube ATM

00:28:22.720 --> 00:28:24.400
<v Speaker 2>cluster initially

00:28:27.405 --> 00:28:28.845
<v Speaker 2>to create a new one.

00:28:29.245 --> 00:28:32.445
<v Speaker 0>Okay. I will grab an API server manifest

00:28:32.445 --> 00:28:33.965
<v Speaker 0>from one of the other machines.

00:28:38.125 --> 00:28:41.085
<v Speaker 2>Alright. And I'm just gonna okay. So

00:28:44.020 --> 00:28:44.980
<v Speaker 2>so

00:28:46.980 --> 00:28:48.820
<v Speaker 2>what I'm gonna do is just look contextually

00:28:48.820 --> 00:28:50.900
<v Speaker 2>if there are any other interesting events in

00:28:50.900 --> 00:28:52.500
<v Speaker 2>the changes file around

00:28:52.900 --> 00:28:53.300
<v Speaker 2>here.

00:29:02.945 --> 00:29:04.465
<v Speaker 2>And I see the well

00:29:05.825 --> 00:29:06.624
<v Speaker 0>Alright.

00:29:07.345 --> 00:29:10.065
<v Speaker 2>I see the LDSO preload

00:29:10.000 --> 00:29:11.200
<v Speaker 2>thing here.

00:29:11.520 --> 00:29:13.679
<v Speaker 0>Do mind if I paste in this manifest?

00:29:14.880 --> 00:29:16.559
<v Speaker 2>Yeah. Go ahead and fix the manifest.

00:29:17.600 --> 00:29:18.239
<v Speaker 1>Yeah.

00:29:18.960 --> 00:29:21.520
<v Speaker 1>Thomas, share that that FLS command with me.

00:29:27.955 --> 00:29:30.115
<v Speaker 2>Sorry. I your your reputation

00:29:30.115 --> 00:29:32.114
<v Speaker 2>preceded you, so I

00:29:32.595 --> 00:29:35.315
<v Speaker 2>I knew Yeah. Roughly So this is one

00:29:35.315 --> 00:29:36.674
<v Speaker 1>of equals on my encounter.

00:29:37.640 --> 00:29:38.599
<v Speaker 1>You did well.

00:29:39.000 --> 00:29:40.360
<v Speaker 1>This is one of the things we we

00:29:40.360 --> 00:29:41.880
<v Speaker 1>spent it was, like, last night and the

00:29:41.880 --> 00:29:43.640
<v Speaker 1>day before, we spent a couple hours, like,

00:29:43.640 --> 00:29:45.479
<v Speaker 1>meeting some of the the guys on Twitch.

00:29:45.559 --> 00:29:47.240
<v Speaker 1>I say I'll say guys, but folks on

00:29:47.240 --> 00:29:49.080
<v Speaker 1>Twitch. And it was, like, do you know,

00:29:49.080 --> 00:29:50.865
<v Speaker 1>should we should we name these, like more

00:29:50.865 --> 00:29:51.665
<v Speaker 1>conspicuously?

00:29:51.665 --> 00:29:53.825
<v Speaker 1>Should we have a common calling card? Like,

00:29:53.825 --> 00:29:56.305
<v Speaker 1>how much cleanup should we do? And we

00:29:56.305 --> 00:29:57.825
<v Speaker 1>we kind of were like, let's let's keep

00:29:57.825 --> 00:29:58.304
<v Speaker 1>it

00:29:58.705 --> 00:30:00.865
<v Speaker 1>fun. And I think this is I'm I'm

00:30:00.865 --> 00:30:02.065
<v Speaker 1>thoroughly impressed.

00:30:02.065 --> 00:30:03.025
<v Speaker 1>This is well done.

00:30:08.340 --> 00:30:09.780
<v Speaker 1>Getting the rest of the cluster to clean

00:30:09.780 --> 00:30:10.580
<v Speaker 1>up is

00:30:12.580 --> 00:30:13.779
<v Speaker 1>not impossible.

00:30:13.860 --> 00:30:16.020
<v Speaker 1>It's it's it should be pretty straightforward here

00:30:16.020 --> 00:30:17.475
<v Speaker 1>once we start digging around.

00:30:18.435 --> 00:30:20.914
<v Speaker 0>My teleport's not typing anymore.

00:30:21.635 --> 00:30:22.274
<v Speaker 2>Yeah.

00:30:22.755 --> 00:30:24.755
<v Speaker 2>Didn't Dave you David send you the message

00:30:24.755 --> 00:30:26.115
<v Speaker 2>that this was supposed to be an easy

00:30:26.115 --> 00:30:26.674
<v Speaker 2>one?

00:30:28.515 --> 00:30:28.835
<v Speaker 2>No.

00:30:29.860 --> 00:30:31.860
<v Speaker 2>Oh, okay. He told me I should make

00:30:31.860 --> 00:30:32.899
<v Speaker 2>it an easy one. So

00:30:33.700 --> 00:30:35.700
<v Speaker 0>I said because it was time box, we

00:30:35.700 --> 00:30:36.739
<v Speaker 0>should take it easy.

00:30:37.779 --> 00:30:40.179
<v Speaker 1>Oh, sorry. Well, if if you're interested, I

00:30:40.179 --> 00:30:42.020
<v Speaker 1>can I can kind of guide us through

00:30:42.020 --> 00:30:43.795
<v Speaker 1>the rest of this really quick? No. No.

00:30:43.795 --> 00:30:46.035
<v Speaker 0>No. We're we're Yeah. Let's let's keep let's

00:30:46.035 --> 00:30:46.835
<v Speaker 2>keep break.

00:30:47.155 --> 00:30:49.395
<v Speaker 0>My Firefox is crashed. Breaking it or breaking

00:30:49.395 --> 00:30:51.235
<v Speaker 2>it more. So can you if

00:30:51.795 --> 00:30:53.715
<v Speaker 0>your teleper is still working, I think there's

00:30:53.715 --> 00:30:55.395
<v Speaker 0>a couple more IP addresses that need changed

00:30:55.395 --> 00:30:56.434
<v Speaker 0>in that file.

00:30:57.395 --> 00:30:58.115
<v Speaker 2>Yeah.

00:30:59.410 --> 00:31:02.130
<v Speaker 2>My teleport session is still working here. Yeah.

00:31:03.650 --> 00:31:04.690
<v Speaker 1>I need to

00:31:05.010 --> 00:31:06.370
<v Speaker 1>get mine back up.

00:31:13.015 --> 00:31:14.135
<v Speaker 1>And really the

00:31:15.495 --> 00:31:17.095
<v Speaker 1>a lot a lot of this is prior

00:31:17.095 --> 00:31:19.895
<v Speaker 1>art from from other scenarios I've gone through.

00:31:19.895 --> 00:31:20.375
<v Speaker 1>And,

00:31:21.335 --> 00:31:23.015
<v Speaker 1>you know, if there's there's a lot of

00:31:23.015 --> 00:31:24.615
<v Speaker 1>good Easter eggs and good, like, tips and

00:31:24.615 --> 00:31:26.220
<v Speaker 1>tricks. So I I was hoping and then

00:31:26.220 --> 00:31:27.580
<v Speaker 1>we already got one of them, which is

00:31:27.580 --> 00:31:29.580
<v Speaker 1>that that fabulous FLS command. I was really

00:31:29.580 --> 00:31:30.940
<v Speaker 1>hoping folks

00:31:30.940 --> 00:31:33.420
<v Speaker 1>would would walk away from this knowing that

00:31:33.420 --> 00:31:35.340
<v Speaker 1>there is some some things to watch out

00:31:35.340 --> 00:31:35.580
<v Speaker 1>for.

00:31:42.735 --> 00:31:44.975
<v Speaker 1>And let me grab

00:31:44.975 --> 00:31:45.695
<v Speaker 1>this.

00:31:49.855 --> 00:31:51.855
<v Speaker 1>But really in the in that that static

00:31:51.855 --> 00:31:54.160
<v Speaker 1>manifest now that's not being overwritten with that

00:31:54.160 --> 00:31:56.240
<v Speaker 1>errant system d service, you really should just

00:31:56.240 --> 00:31:57.920
<v Speaker 1>be able to leave that that one container

00:31:57.920 --> 00:32:00.480
<v Speaker 1>and and the clusters. And then it's just

00:32:00.480 --> 00:32:02.240
<v Speaker 1>cleaning up the cluster at that point.

00:32:02.640 --> 00:32:03.040
<v Speaker 2>Yep.

00:32:11.075 --> 00:32:13.395
<v Speaker 0>Okay. So that should be a working, hopefully,

00:32:13.395 --> 00:32:15.634
<v Speaker 0>API server. Can we delete the x file?

00:32:15.715 --> 00:32:17.395
<v Speaker 2>Yeah. You can delete the x file. That's

00:32:17.395 --> 00:32:19.475
<v Speaker 2>fine. Alright. Let's check for

00:32:21.640 --> 00:32:24.360
<v Speaker 0>Sorry? Don't like me. Alright.

00:32:25.480 --> 00:32:26.039
<v Speaker 2>So

00:32:28.360 --> 00:32:30.040
<v Speaker 2>so what are you looking for here? Oh.

00:32:30.040 --> 00:32:31.480
<v Speaker 0>I'm just waiting for the API server to

00:32:31.480 --> 00:32:32.840
<v Speaker 0>come back. Static. Yeah.

00:32:33.735 --> 00:32:35.654
<v Speaker 0>In theory, I should.

00:32:36.135 --> 00:32:37.654
<v Speaker 0>Oh. I should.

00:32:38.135 --> 00:32:39.495
<v Speaker 0>I'll let you type, Thomas.

00:32:40.055 --> 00:32:41.815
<v Speaker 0>That mean we can run get pods and

00:32:41.815 --> 00:32:44.295
<v Speaker 0>actually see? Yeah. Let's see.

00:32:46.390 --> 00:32:48.150
<v Speaker 0>Alright. So I we could probably just delete

00:32:48.150 --> 00:32:49.350
<v Speaker 0>that whole namespace.

00:32:49.750 --> 00:32:51.429
<v Speaker 2>Yeah. Let's see.

00:32:55.590 --> 00:32:56.550
<v Speaker 2>I'll do this thing.

00:32:57.955 --> 00:32:59.395
<v Speaker 2>Old school way, I guess.

00:33:00.035 --> 00:33:01.635
<v Speaker 2>The first one's You can do dash dash

00:33:01.635 --> 00:33:04.435
<v Speaker 1>all now, Thomas. You can do delete PO

00:33:04.435 --> 00:33:06.115
<v Speaker 1>or delete namespace now.

00:33:07.715 --> 00:33:08.755
<v Speaker 2>Oh, yeah.

00:33:09.679 --> 00:33:10.320
<v Speaker 2>Well

00:33:13.120 --> 00:33:14.880
<v Speaker 0>As long as there's no admission controllers on

00:33:14.880 --> 00:33:16.400
<v Speaker 0>there in that in space with other objects

00:33:16.400 --> 00:33:18.559
<v Speaker 0>with finalizer, it would be fine. Alright. I'm

00:33:18.559 --> 00:33:19.840
<v Speaker 2>just gonna do it this way.

00:33:21.039 --> 00:33:21.440
<v Speaker 1>Good.

00:33:28.095 --> 00:33:29.855
<v Speaker 1>I love I love seeing

00:33:30.735 --> 00:33:33.055
<v Speaker 1>somebody really proficient on the command line like

00:33:33.055 --> 00:33:35.375
<v Speaker 1>this. This just this just touches me right

00:33:35.375 --> 00:33:37.055
<v Speaker 1>in that, like, soft place in my heart

00:33:37.055 --> 00:33:38.655
<v Speaker 1>that nobody ever goes.

00:33:40.860 --> 00:33:42.619
<v Speaker 2>Alright. So those are terminating.

00:33:46.940 --> 00:33:48.700
<v Speaker 2>We still have some of the default ones,

00:33:48.700 --> 00:33:50.779
<v Speaker 2>but that's fine. I'm not I'll I'll I'll

00:33:50.779 --> 00:33:52.219
<v Speaker 2>leave your calling card there.

00:33:52.940 --> 00:33:54.940
<v Speaker 2>I accidentally killed two of them, but whatever.

00:33:56.685 --> 00:33:58.605
<v Speaker 1>I'm curious to see if they come back.

00:33:59.005 --> 00:34:00.684
<v Speaker 2>Yeah. Me too.

00:34:05.165 --> 00:34:07.405
<v Speaker 2>Still terminating. That's not looking good.

00:34:08.790 --> 00:34:10.310
<v Speaker 1>They they they should

00:34:13.590 --> 00:34:15.990
<v Speaker 1>we'll see. Yeah. They're they're done.

00:34:16.550 --> 00:34:18.630
<v Speaker 1>It looks good. Yeah. That in this case

00:34:18.630 --> 00:34:20.870
<v Speaker 0>is all cleaned up. Yeah. Cool. Oh, well

00:34:20.870 --> 00:34:21.030
<v Speaker 1>done.

00:34:21.735 --> 00:34:24.455
<v Speaker 2>Do you wanna try your deploy again and

00:34:24.455 --> 00:34:25.335
<v Speaker 2>see

00:34:25.815 --> 00:34:27.175
<v Speaker 2>if we have a healthy deploy?

00:34:38.860 --> 00:34:40.780
<v Speaker 0>Unchanged. Unchanged. Excited.

00:34:41.100 --> 00:34:41.820
<v Speaker 1>Yay.

00:34:42.620 --> 00:34:43.660
<v Speaker 1>Good job.

00:34:46.300 --> 00:34:47.020
<v Speaker 2>And

00:34:51.100 --> 00:34:51.420
<v Speaker 0>they're running.

00:34:52.455 --> 00:34:55.815
<v Speaker 2>We got Postgres and clustered. And I guess

00:34:55.815 --> 00:34:58.455
<v Speaker 2>the last thing is to verify connectivity.

00:34:59.575 --> 00:35:02.455
<v Speaker 0>Well, have to edit deployment clustered.

00:35:03.415 --> 00:35:05.255
<v Speaker 0>We should be able to upgrade Why are

00:35:05.255 --> 00:35:05.655
<v Speaker 2>you editing?

00:35:06.160 --> 00:35:08.960
<v Speaker 0>We're Oh, I was trying create a video.

00:35:08.960 --> 00:35:09.840
<v Speaker 2>Okay.

00:35:11.440 --> 00:35:13.120
<v Speaker 0>Which I suspect will work fine, and then

00:35:13.120 --> 00:35:14.560
<v Speaker 0>we'll port forward and see.

00:35:24.885 --> 00:35:26.245
<v Speaker 0>I'm still impatient.

00:35:27.525 --> 00:35:29.045
<v Speaker 2>So I have to ask,

00:35:29.925 --> 00:35:31.365
<v Speaker 2>since I didn't disassemble

00:35:31.365 --> 00:35:34.244
<v Speaker 2>your library or even, you know, really dump

00:35:34.244 --> 00:35:35.205
<v Speaker 2>any debug,

00:35:35.605 --> 00:35:36.005
<v Speaker 2>what

00:35:38.140 --> 00:35:40.220
<v Speaker 1>Slash temp. Go check out slash Go

00:35:41.100 --> 00:35:42.380
<v Speaker 1>check out slash temp.

00:35:43.740 --> 00:35:45.420
<v Speaker 1>I I figured if if you were looking,

00:35:45.420 --> 00:35:47.100
<v Speaker 1>slash temp is like that's I feel like

00:35:47.100 --> 00:35:48.540
<v Speaker 1>if if I put it in slash temp,

00:35:48.855 --> 00:35:52.055
<v Speaker 1>it's that's the difference between hacking and security

00:35:52.055 --> 00:35:54.775
<v Speaker 1>research. It's fleeting things in slash temp.

00:35:55.095 --> 00:35:57.015
<v Speaker 2>Exactly. I I I saw there was the

00:35:57.015 --> 00:35:58.615
<v Speaker 2>temp nova director. I haven't looked at what

00:35:58.615 --> 00:36:00.295
<v Speaker 2>all or the file, but I haven't seen

00:36:00.295 --> 00:36:02.215
<v Speaker 2>what else. It's it's I love it. It's

00:36:02.215 --> 00:36:02.455
<v Speaker 1>very

00:36:04.420 --> 00:36:06.020
<v Speaker 1>Yeah. You should just list everything in temp

00:36:06.020 --> 00:36:07.940
<v Speaker 1>and it's a hidden file called dot nova,

00:36:07.940 --> 00:36:09.940
<v Speaker 1>I think. It might be obscure. It's caught

00:36:09.940 --> 00:36:11.060
<v Speaker 2>in there with last. And

00:36:12.980 --> 00:36:15.545
<v Speaker 1>yeah. I left it's very polite in there.

00:36:15.545 --> 00:36:17.145
<v Speaker 1>There's even a a lovely make file for

00:36:17.145 --> 00:36:17.945
<v Speaker 1>you as well.

00:36:18.585 --> 00:36:19.465
<v Speaker 2>Excellent.

00:36:19.465 --> 00:36:20.905
<v Speaker 2>So let's Yeah.

00:36:21.065 --> 00:36:22.825
<v Speaker 2>I guess before we drop off, I wanna

00:36:22.825 --> 00:36:23.625
<v Speaker 2>quickly

00:36:24.185 --> 00:36:26.025
<v Speaker 2>browse those files. But

00:36:27.400 --> 00:36:29.240
<v Speaker 2>so far, things are looking too good to

00:36:29.240 --> 00:36:30.040
<v Speaker 2>be true.

00:36:31.080 --> 00:36:33.000
<v Speaker 1>No. You did great. You honestly, I I

00:36:33.000 --> 00:36:34.440
<v Speaker 1>mean this sincerely. You knocked it out of

00:36:34.440 --> 00:36:36.200
<v Speaker 1>the park. This is this is well done.

00:36:36.200 --> 00:36:36.760
<v Speaker 2>Alright.

00:36:37.160 --> 00:36:38.200
<v Speaker 2>So let's

00:36:40.360 --> 00:36:42.360
<v Speaker 2>let's see. Oh,

00:36:42.360 --> 00:36:42.680
<v Speaker 2>damn.

00:36:47.175 --> 00:36:49.175
<v Speaker 2>Okay. So there is the dot Novo

00:36:49.335 --> 00:36:52.295
<v Speaker 2>file where

00:36:57.430 --> 00:36:59.830
<v Speaker 2>What all files were there in temp?

00:37:04.710 --> 00:37:05.990
<v Speaker 1>How do how do we get back?

00:37:07.905 --> 00:37:09.425
<v Speaker 1>Are you back in temp? I don't I

00:37:09.425 --> 00:37:11.265
<v Speaker 1>don't see Yeah. I'm I'm in temp and

00:37:11.265 --> 00:37:13.105
<v Speaker 2>the the dot Nova was the

00:37:14.225 --> 00:37:16.705
<v Speaker 1>Look for a different file. Just list list

00:37:16.705 --> 00:37:17.985
<v Speaker 1>long temp.

00:37:18.145 --> 00:37:19.425
<v Speaker 1>Everything in temp.

00:37:19.825 --> 00:37:20.225
<v Speaker 1>Okay.

00:37:23.560 --> 00:37:26.360
<v Speaker 2>Obscure. I see. Temp obscure.

00:37:29.960 --> 00:37:32.920
<v Speaker 1>There you go. And this is I even

00:37:32.920 --> 00:37:34.200
<v Speaker 1>think the shared object should be there.

00:37:35.175 --> 00:37:36.615
<v Speaker 1>There you go. It is.

00:37:37.255 --> 00:37:39.495
<v Speaker 2>Oh, hiding process the process.

00:37:39.815 --> 00:37:42.055
<v Speaker 2>Okay. This is this is a very common

00:37:42.135 --> 00:37:43.495
<v Speaker 1>I did so we

00:37:43.895 --> 00:37:46.055
<v Speaker 1>we thought about doing an eBPF something or

00:37:46.055 --> 00:37:46.215
<v Speaker 1>other,

00:37:47.369 --> 00:37:48.970
<v Speaker 1>but this is just good old l d

00:37:48.970 --> 00:37:50.809
<v Speaker 1>preload, and and that was kind of, the

00:37:50.809 --> 00:37:52.490
<v Speaker 1>big talking point I wanted to get here.

00:37:52.490 --> 00:37:52.890
<v Speaker 1>And,

00:37:53.769 --> 00:37:55.130
<v Speaker 2>yeah, I can see that my p f

00:37:55.130 --> 00:37:57.210
<v Speaker 2>that I did earlier, the Nova did not

00:37:57.210 --> 00:37:57.930
<v Speaker 2>show up. So

00:37:58.569 --> 00:38:00.490
<v Speaker 1>My heart was beating out of my chest

00:38:00.490 --> 00:38:01.885
<v Speaker 1>when you did that p s. I can't

00:38:01.885 --> 00:38:03.165
<v Speaker 1>even and it and it didn't work. And

00:38:03.165 --> 00:38:04.365
<v Speaker 1>I was like, oh, I've got them. I

00:38:04.365 --> 00:38:05.965
<v Speaker 1>fucked I fucking got them. And then it

00:38:05.965 --> 00:38:06.925
<v Speaker 1>was and then

00:38:07.405 --> 00:38:09.005
<v Speaker 1>David was just like, oh, no. You gotta

00:38:09.005 --> 00:38:10.445
<v Speaker 1>do a system cuddle stop. And I was

00:38:10.445 --> 00:38:12.285
<v Speaker 1>just like, that's gonna get it. You can

00:38:12.285 --> 00:38:13.965
<v Speaker 1>know that the PS didn't show it.

00:38:16.640 --> 00:38:19.600
<v Speaker 1>Cool. Yeah. No. Well done. This is great.

00:38:19.600 --> 00:38:22.160
<v Speaker 1>Thanks. Alright. Well, our port forward didn't work

00:38:22.160 --> 00:38:23.920
<v Speaker 0>to browse to the application. Does that mean

00:38:23.920 --> 00:38:24.880
<v Speaker 0>there's more to It

00:38:27.120 --> 00:38:28.960
<v Speaker 1>should it should I didn't touch the network.

00:38:29.895 --> 00:38:31.575
<v Speaker 2>Alright. You're you're welcome.

00:38:34.615 --> 00:38:36.615
<v Speaker 0>Alright. Good job, Thomas.

00:38:36.695 --> 00:38:37.735
<v Speaker 0>That was a

00:38:38.055 --> 00:38:40.135
<v Speaker 2>Thank you. That was nice to watch. FLS

00:38:40.135 --> 00:38:41.575
<v Speaker 0>is now gonna be stuck in my brain.

00:38:42.150 --> 00:38:43.910
<v Speaker 2>Yeah. So SleuthKit,

00:38:43.910 --> 00:38:46.710
<v Speaker 2>it's it's an old technology, but there are

00:38:46.710 --> 00:38:49.030
<v Speaker 2>many other things. There's but one of the

00:38:49.030 --> 00:38:50.710
<v Speaker 2>nice things about FLS

00:38:50.869 --> 00:38:53.910
<v Speaker 2>is that it also notices deleted files because

00:38:53.910 --> 00:38:56.785
<v Speaker 2>it is dumping the raw EXT

00:38:56.785 --> 00:38:58.145
<v Speaker 2>file system data

00:38:58.625 --> 00:39:01.265
<v Speaker 2>and not just relying on the current state.

00:39:01.345 --> 00:39:01.825
<v Speaker 2>So

00:39:03.505 --> 00:39:05.585
<v Speaker 1>Nice. So check out if you go to

00:39:05.585 --> 00:39:07.025
<v Speaker 1>the root directory and look at the bash

00:39:07.025 --> 00:39:09.025
<v Speaker 1>RC, I hit a little there's a a

00:39:09.025 --> 00:39:11.265
<v Speaker 1>bash forward in there and there's

00:39:11.799 --> 00:39:13.640
<v Speaker 1>a I made the assumption a couple of

00:39:13.640 --> 00:39:15.319
<v Speaker 1>assumptions with this. One of which was that

00:39:15.319 --> 00:39:17.240
<v Speaker 1>if you were looking at the raw block

00:39:17.240 --> 00:39:19.799
<v Speaker 1>device logs in any form like with FLS,

00:39:19.799 --> 00:39:21.640
<v Speaker 1>you were gonna get everything. But

00:39:22.039 --> 00:39:23.480
<v Speaker 1>even if y'all were to exit out of

00:39:23.480 --> 00:39:25.079
<v Speaker 1>this and come back, it you it's gonna

00:39:25.079 --> 00:39:26.359
<v Speaker 1>clean up after you're on the way out.

00:39:29.535 --> 00:39:31.775
<v Speaker 1>Check out dot Nova in here. There's it's

00:39:31.855 --> 00:39:33.135
<v Speaker 1>I hid it somewhere in there. I don't

00:39:33.135 --> 00:39:35.375
<v Speaker 1>know where the pointer is. Yeah. There you

00:39:35.375 --> 00:39:37.615
<v Speaker 1>go. That very last line.

00:39:37.935 --> 00:39:38.495
<v Speaker 1>Yeah.

00:39:40.095 --> 00:39:42.450
<v Speaker 1>So yeah. I mean, it was superficial clean

00:39:42.450 --> 00:39:45.330
<v Speaker 1>clean, but but really looking slightly deeper into

00:39:45.330 --> 00:39:46.690
<v Speaker 1>the Linux system, you were gonna get a

00:39:46.690 --> 00:39:49.090
<v Speaker 1>lot. And I think this this is good.

00:39:49.650 --> 00:39:50.370
<v Speaker 0>Nice.

00:39:50.690 --> 00:39:51.410
<v Speaker 2>Excellent.

00:39:51.890 --> 00:39:54.050
<v Speaker 2>Thank you for for setting up this scenario.

00:39:54.050 --> 00:39:56.455
<v Speaker 2>It was fun. It it Yeah. It exercises

00:39:56.455 --> 00:39:58.295
<v Speaker 2>a lot of muscles that haven't been used

00:39:58.295 --> 00:39:59.415
<v Speaker 2>in decades.

00:39:59.494 --> 00:39:59.655
<v Speaker 2>So

00:40:00.615 --> 00:40:01.415
<v Speaker 1>Great.

00:40:01.415 --> 00:40:02.775
<v Speaker 0>Alright. And I think the

00:40:03.335 --> 00:40:04.855
<v Speaker 1>yeah. Yeah. What do I do? Tell me

00:40:04.855 --> 00:40:06.135
<v Speaker 1>what to do. No. If you got something

00:40:06.135 --> 00:40:07.255
<v Speaker 0>to say, go for it, and then we'll

00:40:07.255 --> 00:40:08.375
<v Speaker 0>jump into Thomas' cluster.

00:40:11.150 --> 00:40:12.670
<v Speaker 1>Yeah. I'm trying to figure out how to

00:40:12.670 --> 00:40:15.310
<v Speaker 1>open up Thomas' cluster. I'm here in the

00:40:15.310 --> 00:40:16.670
<v Speaker 1>teleport browser,

00:40:16.910 --> 00:40:18.510
<v Speaker 1>so I just go to root and click

00:40:18.510 --> 00:40:20.030
<v Speaker 1>on connect. Is that what I do?

00:40:20.670 --> 00:40:23.230
<v Speaker 0>Hold on because I got logged out when

00:40:23.230 --> 00:40:25.285
<v Speaker 0>I restarted Firefox. I'm I'll start a session

00:40:25.285 --> 00:40:26.885
<v Speaker 0>just so it doesn't flash your IP address

00:40:26.885 --> 00:40:27.605
<v Speaker 0>on the screen.

00:40:28.565 --> 00:40:30.165
<v Speaker 0>Oh, because if I go to active sessions,

00:40:30.165 --> 00:40:32.165
<v Speaker 0>your IP will be there. Let's just then

00:40:32.165 --> 00:40:33.205
<v Speaker 1>do Okay. Yeah.

00:40:34.245 --> 00:40:34.965
<v Speaker 1>Yeah.

00:40:36.085 --> 00:40:36.565
<v Speaker 0>So

00:40:36.980 --> 00:40:39.299
<v Speaker 0>I'll open the control plane and if you

00:40:39.299 --> 00:40:41.140
<v Speaker 0>go to active sessions now, you should be

00:40:41.140 --> 00:40:42.740
<v Speaker 0>able to see that join and then just

00:40:42.740 --> 00:40:45.140
<v Speaker 0>type echo hello or anything like that.

00:40:45.780 --> 00:40:48.020
<v Speaker 1>Okay. So I see a few seconds ago.

00:40:48.020 --> 00:40:50.339
<v Speaker 1>I see two of them. I see Rawkode

00:40:50.339 --> 00:40:51.780
<v Speaker 1>options

00:40:51.245 --> 00:40:52.125
<v Speaker 1>join.

00:40:53.085 --> 00:40:54.445
<v Speaker 0>Oh, because I just have one when I

00:40:54.445 --> 00:40:56.045
<v Speaker 0>was copying the API server. So if you

00:40:56.125 --> 00:40:57.405
<v Speaker 0>yeah. The one you've just joined is the

00:40:57.405 --> 00:40:59.405
<v Speaker 0>correct one. It's my screen flashed.

00:41:00.925 --> 00:41:01.725
<v Speaker 1>Let's see.

00:41:02.525 --> 00:41:04.445
<v Speaker 2>So I'm gonna have to admit, I I

00:41:04.445 --> 00:41:06.285
<v Speaker 2>was not nearly as creative as you.

00:41:07.700 --> 00:41:09.780
<v Speaker 1>Okay. No. That's good. That's good. I so

00:41:09.780 --> 00:41:11.540
<v Speaker 1>I didn't really know what to expect, and

00:41:11.540 --> 00:41:12.980
<v Speaker 1>I I kind of live in a bubble.

00:41:12.980 --> 00:41:14.660
<v Speaker 1>Like, I I've I've taken a step aback

00:41:14.660 --> 00:41:16.660
<v Speaker 1>from kind of what's going on in cloud

00:41:16.660 --> 00:41:19.059
<v Speaker 1>native and Kubernetes and everything. And so, like,

00:41:19.059 --> 00:41:21.385
<v Speaker 1>really, all I knew was here's here's a

00:41:21.385 --> 00:41:23.305
<v Speaker 1>Kube config and an SSH to a cluster

00:41:23.305 --> 00:41:25.305
<v Speaker 1>and break it. Yeah. And I was like,

00:41:25.305 --> 00:41:27.065
<v Speaker 1>okay. Well, I've got some some good, you

00:41:27.065 --> 00:41:28.025
<v Speaker 1>know, horizontal

00:41:28.744 --> 00:41:30.585
<v Speaker 1>attack vector tools, and I just kinda put

00:41:30.585 --> 00:41:32.184
<v Speaker 1>together a fun scenario. So

00:41:32.790 --> 00:41:34.150
<v Speaker 1>I I I have no idea what to

00:41:34.150 --> 00:41:35.430
<v Speaker 1>expect here and I don't know very much

00:41:35.430 --> 00:41:37.110
<v Speaker 1>about you, Thomas. So like,

00:41:37.590 --> 00:41:39.350
<v Speaker 1>you're gonna get to watch me frail now.

00:41:39.750 --> 00:41:40.390
<v Speaker 2>Yeah.

00:41:40.550 --> 00:41:42.710
<v Speaker 2>I'll just say everything's working just fine.

00:41:44.870 --> 00:41:47.110
<v Speaker 1>Oh, great. Well, I have exported

00:41:47.115 --> 00:41:49.355
<v Speaker 0>kube config path and alias kube control to

00:41:49.355 --> 00:41:51.115
<v Speaker 0>k. So if you wanna run, get nodes,

00:41:51.115 --> 00:41:53.435
<v Speaker 0>get pods or anything else, Chris, and we'll

00:41:53.435 --> 00:41:54.635
<v Speaker 0>we'll see where we're at.

00:41:55.755 --> 00:41:57.355
<v Speaker 1>Well, I I want it I feel like

00:41:57.355 --> 00:42:00.155
<v Speaker 1>I should return the same favor of collecting

00:42:00.155 --> 00:42:01.035
<v Speaker 1>before mutating.

00:42:02.370 --> 00:42:03.810
<v Speaker 1>But I I don't even know if that's

00:42:03.810 --> 00:42:05.730
<v Speaker 1>gonna that's gonna be necessary.

00:42:05.730 --> 00:42:06.770
<v Speaker 1>But let's

00:42:08.370 --> 00:42:10.370
<v Speaker 1>yeah. Yeah. I'm just gonna just do

00:42:10.690 --> 00:42:12.690
<v Speaker 1>just check out the state of the cluster,

00:42:12.690 --> 00:42:14.130
<v Speaker 1>I think. We'll start we'll start at the

00:42:14.130 --> 00:42:16.225
<v Speaker 1>top work our way down. Whereas I think

00:42:16.225 --> 00:42:17.905
<v Speaker 1>we we started at the bottom and worked

00:42:17.905 --> 00:42:20.705
<v Speaker 1>our way up the last. So let's just

00:42:20.705 --> 00:42:22.945
<v Speaker 1>let's just get let's get pods in the

00:42:22.945 --> 00:42:25.265
<v Speaker 1>default namespace, and I'll run the command that

00:42:25.265 --> 00:42:27.505
<v Speaker 1>I wanted everyone here to I wanted you

00:42:27.505 --> 00:42:28.065
<v Speaker 1>guys to run.

00:42:32.270 --> 00:42:33.630
<v Speaker 1>So that looks good.

00:42:35.310 --> 00:42:37.390
<v Speaker 0>You both managed to drop a message and

00:42:37.390 --> 00:42:40.350
<v Speaker 0>to get pods. That was It's tradition at

00:42:40.350 --> 00:42:40.990
<v Speaker 2>this point.

00:42:41.790 --> 00:42:44.204
<v Speaker 1>Yeah. Wow. Okay. So, like, now I'm I'm

00:42:44.204 --> 00:42:46.684
<v Speaker 1>wondering, should I should I be collecting information

00:42:46.684 --> 00:42:48.845
<v Speaker 1>on on the the file system here?

00:42:52.365 --> 00:42:54.605
<v Speaker 0>Well, he says he kept it simple. Maybe

00:42:54.605 --> 00:42:56.525
<v Speaker 0>maybe we I kept it very simple. I

00:42:56.525 --> 00:42:57.484
<v Speaker 2>don't I don't

00:42:58.170 --> 00:42:59.770
<v Speaker 2>I'll I'll say there are no root kits

00:42:59.770 --> 00:43:00.730
<v Speaker 2>on this machine.

00:43:01.290 --> 00:43:01.930
<v Speaker 1>Okay.

00:43:02.170 --> 00:43:04.570
<v Speaker 1>Well done. So then let's let's see what

00:43:04.570 --> 00:43:06.490
<v Speaker 1>we have here. So let's

00:43:06.730 --> 00:43:08.090
<v Speaker 1>let's get

00:43:09.369 --> 00:43:12.170
<v Speaker 1>we'll get all in the cube system namespace

00:43:12.170 --> 00:43:14.005
<v Speaker 1>and see what we got here. And I'm

00:43:14.005 --> 00:43:16.405
<v Speaker 1>just I'm just looking at this point. So

00:43:16.965 --> 00:43:19.925
<v Speaker 1>everything looks fine. It's all running. The control

00:43:19.925 --> 00:43:21.285
<v Speaker 1>plane looks good.

00:43:25.125 --> 00:43:28.244
<v Speaker 1>Yeah. So no crazy restarts. I mean, already

00:43:28.244 --> 00:43:29.980
<v Speaker 1>the things I did were sticking out to

00:43:29.980 --> 00:43:31.260
<v Speaker 1>me like it's sore thumb. You know, I

00:43:31.260 --> 00:43:33.740
<v Speaker 1>had two containers running in the API server,

00:43:33.980 --> 00:43:36.380
<v Speaker 1>you know, fourteen, fifteen, 16 restarts.

00:43:36.860 --> 00:43:38.460
<v Speaker 1>Let's get namespaces

00:43:38.460 --> 00:43:39.660
<v Speaker 1>and let's see.

00:43:40.140 --> 00:43:42.700
<v Speaker 1>We have Rawkode. We have metal l b.

00:43:43.205 --> 00:43:45.765
<v Speaker 1>These all look fine. Selium looks fine.

00:43:46.165 --> 00:43:48.645
<v Speaker 1>And I guess the success criteria here would

00:43:48.645 --> 00:43:49.125
<v Speaker 1>be

00:43:50.405 --> 00:43:52.965
<v Speaker 1>if I scroll up, we do not have

00:43:52.965 --> 00:43:55.365
<v Speaker 1>our application running. So I'll I'll I'll do

00:43:55.365 --> 00:43:56.645
<v Speaker 1>the same thing that that that we did

00:43:56.645 --> 00:43:59.130
<v Speaker 1>on my cluster. David, could you please deploy

00:43:59.130 --> 00:44:01.210
<v Speaker 1>your application and see what happens?

00:44:01.450 --> 00:44:02.330
<v Speaker 0>Indeed.

00:44:04.809 --> 00:44:06.970
<v Speaker 1>And I have to ask, was the was

00:44:06.970 --> 00:44:08.970
<v Speaker 1>the pod honk

00:44:10.265 --> 00:44:12.025
<v Speaker 1>Whose idea was this? Where did this come

00:44:12.025 --> 00:44:12.585
<v Speaker 1>from?

00:44:15.305 --> 00:44:17.065
<v Speaker 1>Okay. Well,

00:44:17.065 --> 00:44:20.185
<v Speaker 0>we got a etcd server. This database space

00:44:20.185 --> 00:44:21.145
<v Speaker 0>exceeded,

00:44:21.225 --> 00:44:22.985
<v Speaker 0>so we can't write to etcd in order

00:44:22.985 --> 00:44:24.185
<v Speaker 0>to deploy our application.

00:44:26.170 --> 00:44:29.450
<v Speaker 0>So we've seen this before on clustered. Sorry.

00:44:29.450 --> 00:44:30.170
<v Speaker 0>Let me go.

00:44:30.650 --> 00:44:31.930
<v Speaker 1>Can you oh, can you go back and

00:44:31.930 --> 00:44:33.290
<v Speaker 1>and show that? I I missed what you

00:44:33.290 --> 00:44:34.010
<v Speaker 1>just said.

00:44:38.890 --> 00:44:39.690
<v Speaker 0>So we've got

00:44:40.575 --> 00:44:42.974
<v Speaker 0>etcd is complete. We can't write to etcd

00:44:42.974 --> 00:44:45.214
<v Speaker 0>to do the deploy, and it's because the

00:44:45.214 --> 00:44:46.975
<v Speaker 0>database space has exceeded.

00:44:47.935 --> 00:44:49.935
<v Speaker 2>Okay. We'll Let's see.

00:44:50.335 --> 00:44:52.335
<v Speaker 1>Just wanna check out our file system here.

00:44:52.734 --> 00:44:53.375
<v Speaker 1>So that's okay.

00:44:55.359 --> 00:44:57.360
<v Speaker 1>This all looks good superficially.

00:44:57.599 --> 00:44:59.440
<v Speaker 1>And I'm gonna I'm gonna trust Thomas here

00:44:59.440 --> 00:45:01.839
<v Speaker 1>that there's no rootkits and that nothing. These

00:45:01.839 --> 00:45:04.080
<v Speaker 1>are all actual real numbers.

00:45:06.160 --> 00:45:08.160
<v Speaker 0>The last time I seen this error on

00:45:08.160 --> 00:45:10.855
<v Speaker 0>this show, the problem was either

00:45:11.095 --> 00:45:13.095
<v Speaker 0>I think the attributes were changed on the

00:45:13.095 --> 00:45:14.535
<v Speaker 0>STD fails, so it couldn't be written to

00:45:14.535 --> 00:45:15.734
<v Speaker 0>it and then the other one was someone

00:45:15.734 --> 00:45:17.734
<v Speaker 0>modified the STD configuration

00:45:17.894 --> 00:45:20.135
<v Speaker 0>which actually has a size attribute.

00:45:20.615 --> 00:45:22.134
<v Speaker 0>So which says we can only write this

00:45:22.134 --> 00:45:24.240
<v Speaker 0>much to STD and then it stops accepting

00:45:24.240 --> 00:45:25.040
<v Speaker 0>anymore.

00:45:25.040 --> 00:45:26.640
<v Speaker 0>So I think we'll need to

00:45:27.040 --> 00:45:29.200
<v Speaker 0>do that. And I have a cheat sheet

00:45:29.200 --> 00:45:30.800
<v Speaker 0>that I always use for entity because I

00:45:30.800 --> 00:45:31.600
<v Speaker 0>can never

00:45:31.760 --> 00:45:33.040
<v Speaker 0>remember entity.

00:45:33.280 --> 00:45:33.760
<v Speaker 0>So

00:45:34.400 --> 00:45:35.520
<v Speaker 0>I'll get that set up for us.

00:45:37.434 --> 00:45:39.835
<v Speaker 1>I'm also I'm also curious about these these

00:45:39.835 --> 00:45:41.355
<v Speaker 1>Honk pods as well.

00:45:45.515 --> 00:45:46.795
<v Speaker 2>I don't know anything.

00:45:48.474 --> 00:45:49.515
<v Speaker 0>App install

00:45:49.515 --> 00:45:50.875
<v Speaker 0>s c d file.

00:45:55.320 --> 00:45:57.160
<v Speaker 1>I don't know anything. I love I love

00:45:57.160 --> 00:45:58.920
<v Speaker 1>this. Oh, this is evil. I was so

00:45:58.920 --> 00:46:00.760
<v Speaker 1>mean to you guys. I'm so sorry.

00:46:02.440 --> 00:46:04.440
<v Speaker 2>That's that's okay. I so I've I've broken

00:46:04.440 --> 00:46:06.520
<v Speaker 2>one other cluster for clustered,

00:46:06.839 --> 00:46:07.640
<v Speaker 2>and I

00:46:08.575 --> 00:46:10.415
<v Speaker 2>and I I did get

00:46:11.455 --> 00:46:13.775
<v Speaker 2>excessively evil in that one. So I was

00:46:13.775 --> 00:46:15.615
<v Speaker 2>encouraged to keep it simple this time.

00:46:16.335 --> 00:46:17.215
<v Speaker 2>I see. And

00:46:17.615 --> 00:46:19.695
<v Speaker 0>Yeah. We destroyed the boxes so much, we

00:46:19.695 --> 00:46:20.815
<v Speaker 0>couldn't go on to fix it.

00:46:22.310 --> 00:46:24.070
<v Speaker 1>So I mean, I I was like like,

00:46:24.070 --> 00:46:25.510
<v Speaker 1>what what else do we wanna do here?

00:46:25.510 --> 00:46:27.590
<v Speaker 1>I do I recompile a kernel and like

00:46:27.590 --> 00:46:29.510
<v Speaker 1>put a new kernel image in the bootloader?

00:46:29.510 --> 00:46:30.710
<v Speaker 1>Like like, what are we what are we

00:46:30.710 --> 00:46:32.310
<v Speaker 1>doing here? And I just was like,

00:46:32.790 --> 00:46:35.350
<v Speaker 1>my my promise to myself was we will

00:46:35.525 --> 00:46:37.365
<v Speaker 1>we'll stop at the layer right above the

00:46:37.365 --> 00:46:39.365
<v Speaker 1>kernel. Like, when I started entertaining the idea

00:46:39.365 --> 00:46:41.525
<v Speaker 1>of loading kernel modules or eBPF probes, I

00:46:41.525 --> 00:46:43.285
<v Speaker 1>was like, nope, Nova, that's just you can't

00:46:43.285 --> 00:46:44.165
<v Speaker 1>be that mean.

00:46:44.645 --> 00:46:45.285
<v Speaker 2>Yeah.

00:46:46.005 --> 00:46:47.525
<v Speaker 1>Okay. So, yeah, back to fixing that d

00:46:47.525 --> 00:46:48.485
<v Speaker 1>d. Let's see what we got here.

00:46:49.170 --> 00:46:51.089
<v Speaker 0>Yeah. So at CD, we now have a

00:46:51.089 --> 00:46:52.770
<v Speaker 0>working client so we can speak at CD

00:46:52.770 --> 00:46:54.849
<v Speaker 0>if we if we need to. It doesn't

00:46:54.849 --> 00:46:56.609
<v Speaker 0>look like fails to be modified, but of

00:46:56.609 --> 00:46:58.770
<v Speaker 0>course we know that means nothing on Linux.

00:47:00.290 --> 00:47:03.089
<v Speaker 1>Yeah. You can I I I Linux timestamps

00:47:03.089 --> 00:47:03.730
<v Speaker 1>are adorable?

00:47:04.715 --> 00:47:05.515
<v Speaker 0>Yeah.

00:47:06.235 --> 00:47:08.155
<v Speaker 0>I think on this part one today, all

00:47:08.155 --> 00:47:10.075
<v Speaker 0>three of us modified all the date times

00:47:10.075 --> 00:47:11.915
<v Speaker 0>on the static manifest.

00:47:12.635 --> 00:47:14.155
<v Speaker 0>They can no longer be I thought I

00:47:14.155 --> 00:47:16.155
<v Speaker 1>thought about doing that or like mutating any

00:47:16.155 --> 00:47:17.115
<v Speaker 1>of the I node

00:47:17.435 --> 00:47:19.675
<v Speaker 1>features and I was just like, no, just

00:47:19.675 --> 00:47:20.235
<v Speaker 1>keep it nice.

00:47:21.300 --> 00:47:22.420
<v Speaker 1>Keep it real.

00:47:23.300 --> 00:47:23.940
<v Speaker 0>Well,

00:47:24.100 --> 00:47:26.180
<v Speaker 0>I I I don't see anything

00:47:26.500 --> 00:47:27.380
<v Speaker 0>weird

00:47:27.540 --> 00:47:28.260
<v Speaker 0>here.

00:47:28.580 --> 00:47:29.140
<v Speaker 1>Can

00:47:29.540 --> 00:47:31.140
<v Speaker 1>we check out the STD logs?

00:47:31.380 --> 00:47:33.140
<v Speaker 1>I just wanna see what what the STD

00:47:33.140 --> 00:47:34.740
<v Speaker 1>logs are saying in the control plane.

00:47:40.035 --> 00:47:41.475
<v Speaker 0>Oh, there's two of them.

00:47:43.715 --> 00:47:45.795
<v Speaker 0>Let's try You can tail star. I like

00:47:45.875 --> 00:47:47.075
<v Speaker 1>if if yeah. There we go.

00:47:53.500 --> 00:47:54.380
<v Speaker 1>Dialing

00:47:54.380 --> 00:47:55.980
<v Speaker 1>connection refused.

00:47:57.740 --> 00:47:59.100
<v Speaker 1>That doesn't look right.

00:48:01.099 --> 00:48:02.300
<v Speaker 1>What's going on?

00:48:02.700 --> 00:48:05.145
<v Speaker 1>202379,

00:48:05.145 --> 00:48:06.425
<v Speaker 1>that's the STD

00:48:07.625 --> 00:48:09.305
<v Speaker 1>socket we're listening on. Right?

00:48:09.705 --> 00:48:10.425
<v Speaker 0>Yep.

00:48:11.465 --> 00:48:13.145
<v Speaker 1>So what's what's going on with that? Can

00:48:13.145 --> 00:48:14.905
<v Speaker 1>you can you can you hit that socket?

00:48:14.905 --> 00:48:16.185
<v Speaker 1>Can we send data? Can you in map

00:48:16.185 --> 00:48:17.785
<v Speaker 1>that? What do we got? Who's screwing with

00:48:17.785 --> 00:48:20.700
<v Speaker 1>my network? We can because we can run

00:48:21.500 --> 00:48:22.860
<v Speaker 0>an STD get.

00:48:23.180 --> 00:48:25.580
<v Speaker 0>So we are successfully able to speak STD.

00:48:25.580 --> 00:48:27.020
<v Speaker 0>We got some data out.

00:48:29.180 --> 00:48:30.780
<v Speaker 1>What what command did you just run at

00:48:30.780 --> 00:48:33.425
<v Speaker 1>c d cuddle? Yeah. Get and then pass

00:48:33.425 --> 00:48:35.345
<v Speaker 0>in a path and let's just close that

00:48:35.825 --> 00:48:37.665
<v Speaker 0>Kubernetes service. Okay. Cool.

00:48:38.385 --> 00:48:39.185
<v Speaker 1>Okay.

00:48:41.185 --> 00:48:43.265
<v Speaker 1>And it's still saying it's unable to write?

00:48:43.265 --> 00:48:44.625
<v Speaker 1>Where did what does that c d write

00:48:44.625 --> 00:48:44.865
<v Speaker 1>to?

00:48:49.460 --> 00:48:50.180
<v Speaker 0>So

00:48:50.260 --> 00:48:52.020
<v Speaker 0>if we take a look at the static

00:48:52.020 --> 00:48:53.060
<v Speaker 0>manifest,

00:48:53.220 --> 00:48:55.620
<v Speaker 0>we will see that it's written to I

00:48:55.620 --> 00:48:57.300
<v Speaker 0>think it's varlib etcd.

00:48:57.700 --> 00:48:59.140
<v Speaker 0>There's a host path in here.

00:48:59.975 --> 00:49:01.975
<v Speaker 0>Yeah. Varlib etcd. Well

00:49:03.015 --> 00:49:04.215
<v Speaker 1>done. Thank you.

00:49:08.375 --> 00:49:09.815
<v Speaker 2>And

00:49:09.815 --> 00:49:11.495
<v Speaker 2>you can just delete any of the files

00:49:11.495 --> 00:49:13.335
<v Speaker 2>in here, and it'll recover just fine. Don't

00:49:13.335 --> 00:49:13.495
<v Speaker 2>worry.

00:49:15.000 --> 00:49:16.760
<v Speaker 0>That didn't sound sincere.

00:49:19.960 --> 00:49:22.760
<v Speaker 0>So these are all 62 meg files.

00:49:25.800 --> 00:49:26.600
<v Speaker 1>Okay.

00:49:27.675 --> 00:49:30.075
<v Speaker 1>So this is this is effectively the STD

00:49:30.075 --> 00:49:30.955
<v Speaker 1>database?

00:49:31.995 --> 00:49:33.995
<v Speaker 0>It was yeah. Can can

00:49:33.995 --> 00:49:35.755
<v Speaker 1>you type can can you type history? I

00:49:35.755 --> 00:49:37.675
<v Speaker 1>just wanna see if what if we have

00:49:37.675 --> 00:49:39.195
<v Speaker 1>anything there in the batch history.

00:49:40.235 --> 00:49:41.675
<v Speaker 1>Yeah. Let's see what else we got here.

00:49:41.675 --> 00:49:43.275
<v Speaker 0>Scroll down. Yeah. This is just our stuff.

00:49:43.970 --> 00:49:45.330
<v Speaker 1>Okay. That's clean.

00:49:49.809 --> 00:49:52.289
<v Speaker 0>So there is because I only know this

00:49:52.289 --> 00:49:54.130
<v Speaker 0>because this happened before, but there's an x

00:49:54.130 --> 00:49:55.410
<v Speaker 0>t d max

00:49:55.410 --> 00:49:58.690
<v Speaker 0>database size thing that I bet has probably

00:49:58.690 --> 00:50:00.130
<v Speaker 0>been

00:49:59.505 --> 00:50:00.145
<v Speaker 0>set.

00:50:04.144 --> 00:50:06.464
<v Speaker 1>Yeah. I don't know. I my work with

00:50:06.464 --> 00:50:08.625
<v Speaker 1>the STD is is really limited.

00:50:09.984 --> 00:50:12.144
<v Speaker 2>So I'll I'll at least give give a

00:50:12.144 --> 00:50:14.840
<v Speaker 2>hint that might help. Sure. I've actually

00:50:16.200 --> 00:50:18.760
<v Speaker 2>I didn't SSH into this machine at all.

00:50:19.800 --> 00:50:21.000
<v Speaker 0>Of course, you didn't.

00:50:23.560 --> 00:50:25.560
<v Speaker 2>Well, okay. So I SSH in to verify

00:50:25.560 --> 00:50:27.000
<v Speaker 2>that I could SSH in, but I didn't

00:50:27.000 --> 00:50:29.015
<v Speaker 2>do any mutations over SSH because I wasn't

00:50:29.015 --> 00:50:30.775
<v Speaker 2>sure how to SSH in to begin with

00:50:30.775 --> 00:50:31.415
<v Speaker 2>anyways.

00:50:31.975 --> 00:50:34.615
<v Speaker 1>Me neither. I did everything. I just Over

00:50:34.615 --> 00:50:35.415
<v Speaker 2>APIs.

00:50:38.055 --> 00:50:40.535
<v Speaker 1>As did I. I just privilege escalated into

00:50:40.230 --> 00:50:41.830
<v Speaker 1>one of my hack pods for everything I

00:50:41.830 --> 00:50:42.390
<v Speaker 1>did.

00:50:43.109 --> 00:50:43.750
<v Speaker 0>Yeah.

00:50:44.390 --> 00:50:46.230
<v Speaker 0>Have we lost our API server?

00:50:47.350 --> 00:50:48.710
<v Speaker 1>I don't know. Check and see.

00:50:56.365 --> 00:50:58.605
<v Speaker 1>Hello? Yeah. That looks fine.

00:50:59.725 --> 00:51:01.325
<v Speaker 0>Okay. That's not working.

00:51:06.045 --> 00:51:07.805
<v Speaker 1>So I'd I would be willing to say

00:51:07.805 --> 00:51:08.365
<v Speaker 1>that

00:51:08.765 --> 00:51:10.765
<v Speaker 1>because ETCD is not

00:51:11.559 --> 00:51:12.840
<v Speaker 1>responding,

00:51:15.079 --> 00:51:16.760
<v Speaker 1>the API server's hanging.

00:51:20.599 --> 00:51:22.119
<v Speaker 0>This IP address is

00:51:22.440 --> 00:51:23.000
<v Speaker 0>wrong.

00:51:26.945 --> 00:51:28.705
<v Speaker 0>Was that a cron job change?

00:51:29.505 --> 00:51:30.945
<v Speaker 0>That would have been sneaky.

00:51:31.825 --> 00:51:33.985
<v Speaker 2>I'll I'll say there are no cron jobs

00:51:33.985 --> 00:51:34.705
<v Speaker 2>on the system.

00:51:39.460 --> 00:51:41.220
<v Speaker 2>And no system d services.

00:51:41.380 --> 00:51:42.900
<v Speaker 2>I tried to keep it very different this

00:51:42.900 --> 00:51:43.460
<v Speaker 2>time.

00:51:44.500 --> 00:51:46.900
<v Speaker 1>Did you use system d services last time?

00:51:47.220 --> 00:51:47.940
<v Speaker 2>Yep.

00:51:48.820 --> 00:51:49.620
<v Speaker 1>Nice.

00:51:50.180 --> 00:51:53.140
<v Speaker 0>Alright. So it looks like

00:51:59.825 --> 00:52:02.145
<v Speaker 1>So we can't hit local host?

00:52:04.225 --> 00:52:05.825
<v Speaker 1>So we were able can you just try

00:52:05.825 --> 00:52:07.105
<v Speaker 1>to list we tried to list pods and

00:52:07.105 --> 00:52:08.380
<v Speaker 1>it's hanging now. Correct?

00:52:08.619 --> 00:52:09.740
<v Speaker 0>Yeah. Unless

00:52:10.060 --> 00:52:12.220
<v Speaker 0>I am losing my mind. Bet we we

00:52:12.220 --> 00:52:13.980
<v Speaker 0>were able to list pods. We've seen that

00:52:13.980 --> 00:52:15.900
<v Speaker 0>Thomas has necessarily all those pods that said

00:52:15.900 --> 00:52:16.540
<v Speaker 0>honk.

00:52:17.100 --> 00:52:19.420
<v Speaker 0>Obviously, was some sort of timer thing happening.

00:52:19.420 --> 00:52:21.660
<v Speaker 0>So maybe it's like Kubernetes job. But

00:52:22.835 --> 00:52:25.955
<v Speaker 2>Yeah. There's there's no timers that I implemented.

00:52:26.194 --> 00:52:28.515
<v Speaker 2>Just keep in mind that oftentimes the API

00:52:28.515 --> 00:52:31.395
<v Speaker 2>server gets really grumpy if etcd is grumpy.

00:52:32.194 --> 00:52:34.275
<v Speaker 1>Yeah. That's I I mean, the etc

00:52:34.859 --> 00:52:37.579
<v Speaker 1>server in general can take thirty plus sixty

00:52:37.579 --> 00:52:39.180
<v Speaker 1>seconds to kind of get to a back

00:52:39.180 --> 00:52:40.780
<v Speaker 1>to a happy state sometimes.

00:52:42.299 --> 00:52:44.300
<v Speaker 0>Oh, we've lost HTT server

00:52:44.859 --> 00:52:46.220
<v Speaker 1>failed to apply request.

00:52:53.045 --> 00:52:55.045
<v Speaker 1>No space. It's it's just no space again.

00:52:55.045 --> 00:52:56.244
<v Speaker 1>It's gotta be something

00:52:57.285 --> 00:52:58.165
<v Speaker 1>somebody

00:52:58.244 --> 00:53:00.005
<v Speaker 1>flushed a large amount of data to a

00:53:00.005 --> 00:53:00.725
<v Speaker 1>pod somewhere. I'm

00:53:01.490 --> 00:53:03.089
<v Speaker 1>those honk pods, if we get rid of

00:53:03.089 --> 00:53:06.130
<v Speaker 1>those, they're I would hope that it's something,

00:53:06.130 --> 00:53:08.130
<v Speaker 1>like, they're just writing a large amount of

00:53:08.130 --> 00:53:10.210
<v Speaker 1>data somewhere to the API server, like, the

00:53:10.210 --> 00:53:11.410
<v Speaker 1>form of a label or something.

00:53:14.895 --> 00:53:15.695
<v Speaker 0>Okay.

00:53:15.775 --> 00:53:16.415
<v Speaker 0>So

00:53:16.975 --> 00:53:18.335
<v Speaker 0>we need to be able to shut down

00:53:18.335 --> 00:53:19.615
<v Speaker 0>those processes then.

00:53:21.295 --> 00:53:22.895
<v Speaker 1>I think getting rid of the honk pods

00:53:22.895 --> 00:53:24.415
<v Speaker 1>would be a good first step.

00:53:26.495 --> 00:53:28.095
<v Speaker 1>And then I also I also like the

00:53:28.095 --> 00:53:30.350
<v Speaker 1>idea of trying to flush etcd as well.

00:53:30.350 --> 00:53:31.710
<v Speaker 1>But I don't know how much the persistent

00:53:31.710 --> 00:53:33.310
<v Speaker 1>state of the cluster we would nuke if

00:53:33.310 --> 00:53:35.470
<v Speaker 1>we just started manually messing with etcd files.

00:53:35.470 --> 00:53:37.550
<v Speaker 1>I have I'd again, etcd is like I

00:53:37.550 --> 00:53:37.790
<v Speaker 1>just

00:53:38.590 --> 00:53:40.670
<v Speaker 1>I haven't really had to debug it Yeah.

00:53:40.750 --> 00:53:42.990
<v Speaker 1>In dev. My my recommendation,

00:53:42.990 --> 00:53:44.915
<v Speaker 2>do not use the file system. Use use

00:53:44.915 --> 00:53:46.355
<v Speaker 2>the Etsy client.

00:53:46.595 --> 00:53:49.795
<v Speaker 2>Yeah. That's Unless that's really useful. That means

00:53:49.795 --> 00:53:50.835
<v Speaker 0>I have to know how to work the

00:53:50.835 --> 00:53:52.195
<v Speaker 0>Etsy command

00:53:52.195 --> 00:53:53.235
<v Speaker 0>line application.

00:53:56.435 --> 00:53:58.035
<v Speaker 0>Is there an alternative for us?

00:53:58.950 --> 00:54:00.550
<v Speaker 0>Do we got a shell? No.

00:54:01.270 --> 00:54:02.630
<v Speaker 1>No. Can I can I drive for a

00:54:02.630 --> 00:54:03.750
<v Speaker 1>second? Please. Please.

00:54:08.150 --> 00:54:10.310
<v Speaker 1>I typed, you know, nothing happened.

00:54:12.605 --> 00:54:13.805
<v Speaker 0>There we go. Yeah.

00:54:15.724 --> 00:54:17.325
<v Speaker 1>I wanna see this really quick.

00:54:18.045 --> 00:54:18.685
<v Speaker 1>And

00:54:18.845 --> 00:54:21.085
<v Speaker 1>the connection was refused,

00:54:21.244 --> 00:54:21.725
<v Speaker 1>and

00:54:22.525 --> 00:54:25.805
<v Speaker 1>let's p s ox

00:54:24.830 --> 00:54:26.110
<v Speaker 1>grep cube.

00:54:26.110 --> 00:54:28.350
<v Speaker 1>And which container runtime are we using?

00:54:28.990 --> 00:54:29.950
<v Speaker 0>Container d.

00:54:31.710 --> 00:54:34.030
<v Speaker 1>What's I see all these new fancy container

00:54:34.030 --> 00:54:35.390
<v Speaker 1>tools. I don't know what these kids these

00:54:35.390 --> 00:54:36.430
<v Speaker 1>days are doing.

00:54:39.470 --> 00:54:42.405
<v Speaker 1>Okay. So let's look and see.

00:54:44.644 --> 00:54:46.244
<v Speaker 1>I wanna how do we what would be

00:54:46.244 --> 00:54:49.285
<v Speaker 1>the docker p s for So we tested

00:54:49.285 --> 00:54:50.805
<v Speaker 0>to a cry control

00:54:53.620 --> 00:54:54.580
<v Speaker 0>socket.

00:54:55.540 --> 00:54:58.180
<v Speaker 0>Okay. I can't remember exactly. This may work.

00:54:59.460 --> 00:55:01.380
<v Speaker 2>Yeah. I can tell you've done this before.

00:55:02.020 --> 00:55:03.300
<v Speaker 2>But then you have to add PS at

00:55:03.300 --> 00:55:04.980
<v Speaker 2>the end. Oh, it's a runtime endpoint. Right?

00:55:13.815 --> 00:55:17.255
<v Speaker 2>I remember in a previous episode, showed

00:55:17.255 --> 00:55:19.575
<v Speaker 2>off the like, you can just set the

00:55:19.575 --> 00:55:22.580
<v Speaker 2>default for setting the runtime endpoint in the

00:55:23.060 --> 00:55:25.940
<v Speaker 2>CryCuddle config to save keystrokes later. But I

00:55:25.940 --> 00:55:27.860
<v Speaker 2>always I saw it, I was like, okay.

00:55:27.860 --> 00:55:29.220
<v Speaker 2>I should remember this, and I don't remember

00:55:29.220 --> 00:55:30.100
<v Speaker 2>how he did it.

00:55:30.580 --> 00:55:32.260
<v Speaker 0>Oh, there we go. It's container t container

00:55:32.260 --> 00:55:33.620
<v Speaker 0>t dot sock. So

00:55:36.525 --> 00:55:38.765
<v Speaker 1>Thank you. Okay. There

00:55:39.964 --> 00:55:40.685
<v Speaker 1>we go.

00:55:41.325 --> 00:55:42.045
<v Speaker 1>Cool.

00:55:42.125 --> 00:55:43.325
<v Speaker 1>We have Well,

00:55:45.244 --> 00:55:46.925
<v Speaker 1>we have what is speaker?

00:55:47.805 --> 00:55:49.964
<v Speaker 0>That's a metal l b. So we can

00:55:49.964 --> 00:55:51.244
<v Speaker 0>ignore the speaker part.

00:55:52.550 --> 00:55:55.270
<v Speaker 1>And STD was recreated thirty nine seconds ago.

00:55:55.430 --> 00:55:57.910
<v Speaker 0>And attempt one hundred and thirty five. So

00:55:57.910 --> 00:56:00.550
<v Speaker 0>the STD is yeah. It's rather unhappy.

00:56:01.510 --> 00:56:02.630
<v Speaker 1>Yeah. So

00:56:02.869 --> 00:56:04.310
<v Speaker 1>what's going on? Look at how do we

00:56:04.310 --> 00:56:05.590
<v Speaker 1>like look at this? I wanna see what

00:56:05.590 --> 00:56:06.710
<v Speaker 1>this container is.

00:56:07.395 --> 00:56:08.675
<v Speaker 1>Like, how do we we do, like, the

00:56:08.835 --> 00:56:10.995
<v Speaker 1>like a docker inspect on on this container?

00:56:12.035 --> 00:56:13.715
<v Speaker 0>So we can look at this I'm assuming

00:56:13.715 --> 00:56:16.355
<v Speaker 1>this Manifest. Wait. What? This is it all

00:56:16.355 --> 00:56:16.915
<v Speaker 0>here?

00:56:18.835 --> 00:56:20.480
<v Speaker 1>See, I we should have dumped the cluster

00:56:20.480 --> 00:56:21.760
<v Speaker 1>when we could have. This is this is

00:56:21.760 --> 00:56:23.359
<v Speaker 1>why he did this. I should have learned.

00:56:23.359 --> 00:56:24.960
<v Speaker 1>I should have been paying closer attention.

00:56:26.400 --> 00:56:28.079
<v Speaker 0>So we could just try, like, an STD

00:56:28.079 --> 00:56:28.960
<v Speaker 0>compact,

00:56:29.039 --> 00:56:31.520
<v Speaker 0>which would remove all the deleted items from

00:56:31.520 --> 00:56:33.280
<v Speaker 0>it and bring the size the database size

00:56:33.280 --> 00:56:34.080
<v Speaker 0>back into

00:56:34.525 --> 00:56:36.045
<v Speaker 0>hopefully, enough to get it started. Go

00:56:37.165 --> 00:56:37.885
<v Speaker 1>for it.

00:56:41.645 --> 00:56:43.485
<v Speaker 0>It's just compact, isn't it?

00:56:45.485 --> 00:56:46.205
<v Speaker 0>Yeah. Okay.

00:56:51.180 --> 00:56:52.060
<v Speaker 0>Number?

00:56:52.140 --> 00:56:53.740
<v Speaker 0>Oh, how do I pick a number?

00:56:55.100 --> 00:56:56.380
<v Speaker 1>Needs one argument?

00:56:56.460 --> 00:56:57.260
<v Speaker 1>Just do

00:57:02.705 --> 00:57:04.865
<v Speaker 0>Required revision has been compacted.

00:57:05.665 --> 00:57:07.105
<v Speaker 0>Can I let I have I have no

00:57:07.105 --> 00:57:07.585
<v Speaker 1>idea

00:57:08.785 --> 00:57:11.825
<v Speaker 1>no idea what you're doing? Me neither. So

00:57:13.025 --> 00:57:14.065
<v Speaker 0>let's try

00:57:15.345 --> 00:57:16.945
<v Speaker 0>the defrag command too.

00:57:17.510 --> 00:57:19.990
<v Speaker 0>I'm very natives. Let's try that. Yeah. Defrag's

00:57:19.990 --> 00:57:21.670
<v Speaker 2>fun. Let's do it. Let's do it.

00:57:23.190 --> 00:57:24.950
<v Speaker 1>Is there wait. Is there really an STD

00:57:24.950 --> 00:57:26.150
<v Speaker 1>cuddle defrag?

00:57:26.150 --> 00:57:28.150
<v Speaker 1>Is this Yes.

00:57:28.150 --> 00:57:29.030
<v Speaker 2>There is.

00:57:29.510 --> 00:57:31.349
<v Speaker 1>I'm buying a farm and moving. I'm buying

00:57:31.349 --> 00:57:33.535
<v Speaker 1>some goats. I'm so done with tech. I'm

00:57:33.535 --> 00:57:34.095
<v Speaker 1>done.

00:57:34.975 --> 00:57:37.455
<v Speaker 0>Alright. Well, that failed measurably.

00:57:38.015 --> 00:57:40.655
<v Speaker 1>Contacts deadline exceeded. That's a go error.

00:57:41.055 --> 00:57:42.815
<v Speaker 2>Yeah. So you should check out the alarms

00:57:42.815 --> 00:57:43.535
<v Speaker 2>as well.

00:57:44.255 --> 00:57:47.215
<v Speaker 2>That's a kind of a cool feature of

00:57:46.110 --> 00:57:47.230
<v Speaker 2>etcd cuddle.

00:57:50.830 --> 00:57:52.910
<v Speaker 2>And, yeah, and and the health.

00:57:53.950 --> 00:57:55.790
<v Speaker 2>Those are all really great things. Oh, yeah.

00:57:55.790 --> 00:57:57.550
<v Speaker 0>So there's the no space alarm.

00:57:58.030 --> 00:57:58.350
<v Speaker 2>Yeah.

00:58:00.845 --> 00:58:03.005
<v Speaker 1>So how can we list all of the

00:58:03.165 --> 00:58:04.605
<v Speaker 1>is there well, it would be like an

00:58:04.605 --> 00:58:05.645
<v Speaker 1>etsyv cuddle

00:58:05.885 --> 00:58:07.005
<v Speaker 1>d u

00:58:07.005 --> 00:58:08.365
<v Speaker 1>is what we wanna do?

00:58:09.724 --> 00:58:12.220
<v Speaker 1>Like, what's the etsyv cuddle, like, version of,

00:58:12.220 --> 00:58:14.540
<v Speaker 1>like, d u dash dash h?

00:58:15.180 --> 00:58:16.940
<v Speaker 2>Yeah. We're we're getting warmer.

00:58:17.980 --> 00:58:18.540
<v Speaker 1>Yeah.

00:58:21.100 --> 00:58:22.380
<v Speaker 1>I I I don't know. You're gonna have

00:58:22.380 --> 00:58:23.660
<v Speaker 1>to help me here. I I genuinely don't

00:58:23.660 --> 00:58:25.180
<v Speaker 1>know enough about etsyd. I can start to

00:58:25.180 --> 00:58:25.900
<v Speaker 1>Google

00:58:26.975 --> 00:58:28.095
<v Speaker 1>Etsy d

00:58:29.055 --> 00:58:32.175
<v Speaker 1>u or Etsy d cuddle.

00:58:32.895 --> 00:58:34.975
<v Speaker 2>Yeah. I'm not sure there's a d u.

00:58:34.975 --> 00:58:37.135
<v Speaker 2>If there is, I would love to learn

00:58:37.135 --> 00:58:37.535
<v Speaker 2>about it.

00:58:38.580 --> 00:58:39.940
<v Speaker 1>Yeah. I don't know. I this is just

00:58:39.940 --> 00:58:41.860
<v Speaker 1>what I think. Like, basically, I just I'm

00:58:41.860 --> 00:58:43.940
<v Speaker 1>assuming STD works like any database and it

00:58:43.940 --> 00:58:45.620
<v Speaker 1>just writes, you know, some sort of block

00:58:45.620 --> 00:58:49.380
<v Speaker 1>abstraction to regular old EXT four disk. And

00:58:49.380 --> 00:58:51.060
<v Speaker 1>I'm sure there's some way to browse and

00:58:51.060 --> 00:58:52.740
<v Speaker 1>explore those files and that's what I wanna

00:58:52.740 --> 00:58:55.285
<v Speaker 1>do. I whatever at CD and those those

00:58:55.285 --> 00:58:59.285
<v Speaker 1>guys have called exploring their proprietary

00:58:59.285 --> 00:59:00.645
<v Speaker 1>block abstraction,

00:59:01.365 --> 00:59:03.045
<v Speaker 1>let's find that and let's do that.

00:59:05.650 --> 00:59:07.170
<v Speaker 0>Well, it looks like we can get something

00:59:07.170 --> 00:59:09.570
<v Speaker 0>called a revision test key.

00:59:10.130 --> 00:59:11.010
<v Speaker 1>Sure.

00:59:13.730 --> 00:59:15.650
<v Speaker 2>So we have some people in chat talking

00:59:15.650 --> 00:59:19.475
<v Speaker 2>about disarming alarms and increasing size quota. Yeah.

00:59:19.475 --> 00:59:21.315
<v Speaker 0>I was googling how to increase the size,

00:59:21.315 --> 00:59:22.275
<v Speaker 0>but I haven't

00:59:25.315 --> 00:59:26.355
<v Speaker 0>and then I think

00:59:28.915 --> 00:59:31.795
<v Speaker 1>I'm I'm, like, literally, like, getting getting started

00:59:31.795 --> 00:59:33.875
<v Speaker 1>with a tt.i0

00:59:33.600 --> 00:59:35.520
<v Speaker 1>is where I am right now.

00:59:41.600 --> 00:59:44.320
<v Speaker 1>Yeah. Also, the my Twitch chat seems to

00:59:44.320 --> 00:59:45.280
<v Speaker 1>think that

00:59:46.355 --> 00:59:48.515
<v Speaker 1>SCD db size is limited

00:59:49.155 --> 00:59:51.075
<v Speaker 1>and time scale db.

00:59:51.234 --> 00:59:53.235
<v Speaker 1>Did you run out of disk space? No.

00:59:53.954 --> 00:59:56.035
<v Speaker 1>Tanya, while we're not out of disk space,

00:59:56.355 --> 00:59:58.915
<v Speaker 1>I'm talking to my my my Twitch

00:59:58.915 --> 00:59:59.395
<v Speaker 1>friends.

01:00:02.519 --> 01:00:03.960
<v Speaker 1>Yeah. I don't know. How do you

01:00:05.160 --> 01:00:06.920
<v Speaker 1>let's see. I'm I'll tell you guys what

01:00:06.920 --> 01:00:08.920
<v Speaker 1>I'm googling. STD, Cuddle,

01:00:09.960 --> 01:00:11.000
<v Speaker 1>size quota.

01:00:12.055 --> 01:00:14.935
<v Speaker 0>Alright. I found something under maintenance stop, so

01:00:14.935 --> 01:00:16.375
<v Speaker 0>we can get that a dash.

01:00:18.775 --> 01:00:20.935
<v Speaker 1>It's base quota. STD dash dash quota back

01:00:20.935 --> 01:00:22.375
<v Speaker 1>end bytes. What's that?

01:00:30.340 --> 01:00:32.100
<v Speaker 0>Well, that didn't work. We can't get the

01:00:32.100 --> 01:00:33.620
<v Speaker 0>current revision so that we could work out

01:00:33.620 --> 01:00:35.140
<v Speaker 0>how to delete the old revisions.

01:00:35.380 --> 01:00:36.020
<v Speaker 0>This

01:00:36.580 --> 01:00:38.180
<v Speaker 0>has a alarm disable.

01:00:38.180 --> 01:00:39.220
<v Speaker 0>I don't know if we can just do

01:00:39.220 --> 01:00:40.100
<v Speaker 0>that

01:00:40.555 --> 01:00:42.475
<v Speaker 0>just to keep it happy.

01:00:46.955 --> 01:00:47.995
<v Speaker 0>Lift,

01:00:48.315 --> 01:00:49.355
<v Speaker 0>disable,

01:00:51.835 --> 01:00:52.635
<v Speaker 0>disarm.

01:00:57.530 --> 01:00:59.770
<v Speaker 0>The alarm's gone. Does that mean SCD is

01:00:59.770 --> 01:01:00.330
<v Speaker 0>happy?

01:01:05.930 --> 01:01:07.690
<v Speaker 1>Try to get pods. That's our that's our

01:01:07.690 --> 01:01:08.570
<v Speaker 1>control. Right?

01:01:11.435 --> 01:01:12.715
<v Speaker 0>Okay. Get pods.

01:01:15.275 --> 01:01:17.275
<v Speaker 0>Alright. So we can just disable the alarm.

01:01:17.275 --> 01:01:18.555
<v Speaker 0>I don't know what that does with the

01:01:18.555 --> 01:01:19.915
<v Speaker 0>database quota though.

01:01:21.115 --> 01:01:22.395
<v Speaker 0>I don't know if it's gonna come back,

01:01:22.395 --> 01:01:23.355
<v Speaker 0>but I wonder if we can do the

01:01:23.355 --> 01:01:26.155
<v Speaker 0>revision command now

01:01:25.050 --> 01:01:27.290
<v Speaker 0>that I copy and paste it.

01:01:28.650 --> 01:01:30.250
<v Speaker 0>I'm just still gonna give us a yeah.

01:01:30.250 --> 01:01:31.770
<v Speaker 0>Still got a contact deadline.

01:01:31.850 --> 01:01:33.770
<v Speaker 0>SCD is probably not very happy.

01:01:34.650 --> 01:01:37.850
<v Speaker 1>Did Thomas, did you privilege escalate into something

01:01:37.850 --> 01:01:41.205
<v Speaker 1>with SCD cuddle, mutate SCD alarm size quota

01:01:41.205 --> 01:01:43.285
<v Speaker 1>something or other. This this isn't an app.

01:01:43.285 --> 01:01:45.125
<v Speaker 1>You didn't actually flush a bunch of frivolous

01:01:45.125 --> 01:01:46.805
<v Speaker 1>data to disk. You actually just told that

01:01:46.805 --> 01:01:48.005
<v Speaker 1>td to misbehave.

01:01:53.970 --> 01:01:55.010
<v Speaker 1>This is fine.

01:01:55.250 --> 01:01:56.849
<v Speaker 0>Well, the alarm's not coming back, and we

01:01:56.849 --> 01:01:58.530
<v Speaker 0>do have a working API server. So maybe

01:01:58.530 --> 01:02:00.450
<v Speaker 0>we can ignore it. Try to And delete

01:02:00.450 --> 01:02:01.650
<v Speaker 0>these honk pods?

01:02:02.369 --> 01:02:04.530
<v Speaker 1>Yeah. Delete the honk pods. I'm gonna well,

01:02:04.530 --> 01:02:06.450
<v Speaker 1>you you have the cursor right now, but

01:02:05.985 --> 01:02:08.225
<v Speaker 1>I I wanna dump the cluster config now

01:02:08.225 --> 01:02:10.145
<v Speaker 1>and look at the events in Kubernetes and

01:02:10.145 --> 01:02:12.145
<v Speaker 1>see what this guy's been doing. Alright. Okay.

01:02:12.145 --> 01:02:13.665
<v Speaker 0>We still can't write the STDs, so we

01:02:13.665 --> 01:02:15.025
<v Speaker 0>are gonna have to try and change the

01:02:15.025 --> 01:02:15.905
<v Speaker 0>database size.

01:02:20.160 --> 01:02:22.240
<v Speaker 1>Let's see. Etcd

01:02:22.240 --> 01:02:23.200
<v Speaker 1>cuddle

01:02:23.520 --> 01:02:25.200
<v Speaker 1>change database

01:02:25.200 --> 01:02:26.000
<v Speaker 1>size.

01:02:30.640 --> 01:02:32.575
<v Speaker 0>I don't like it when people mess with

01:02:32.575 --> 01:02:34.655
<v Speaker 0>entity, just for the record, Thomas.

01:02:35.455 --> 01:02:36.175
<v Speaker 2>Yeah.

01:02:36.495 --> 01:02:38.255
<v Speaker 2>So this is a learning opportunity.

01:02:38.255 --> 01:02:40.895
<v Speaker 2>So I'll I'll note that you you did

01:02:40.895 --> 01:02:42.415
<v Speaker 2>buy yourself about

01:02:43.215 --> 01:02:44.815
<v Speaker 2>ten seconds of runtime.

01:02:45.990 --> 01:02:48.470
<v Speaker 2>You've already squandered it. By turning Alright.

01:02:48.470 --> 01:02:49.110
<v Speaker 1>Yeah.

01:02:53.510 --> 01:02:55.510
<v Speaker 0>Let's see the CTL

01:02:55.510 --> 01:02:56.070
<v Speaker 0>database.

01:03:03.935 --> 01:03:04.895
<v Speaker 1>Yeah.

01:03:04.895 --> 01:03:06.335
<v Speaker 1>Everybody in my chat is like, we were

01:03:06.335 --> 01:03:08.095
<v Speaker 1>too nice when we broke our cluster.

01:03:09.615 --> 01:03:10.815
<v Speaker 1>No.

01:03:10.815 --> 01:03:11.855
<v Speaker 1>This is good.

01:03:14.255 --> 01:03:17.050
<v Speaker 2>So so I'm gonna give a an interesting

01:03:17.050 --> 01:03:19.530
<v Speaker 2>tidbit here. One of the fun things about

01:03:19.530 --> 01:03:20.570
<v Speaker 2>ETCD

01:03:20.570 --> 01:03:21.210
<v Speaker 2>is

01:03:22.330 --> 01:03:24.570
<v Speaker 2>that it's the way that it's set up,

01:03:24.570 --> 01:03:27.369
<v Speaker 2>it's listening on a public IP and port.

01:03:32.144 --> 01:03:32.785
<v Speaker 1>The

01:03:33.424 --> 01:03:36.464
<v Speaker 1>the etcd and the etcd server itself is

01:03:36.464 --> 01:03:38.704
<v Speaker 1>listening on a public IP that's that's reachable

01:03:38.704 --> 01:03:41.424
<v Speaker 1>if the the node is exposed and but

01:03:41.424 --> 01:03:43.505
<v Speaker 1>it's just it uses its own internal auth.

01:03:43.590 --> 01:03:45.590
<v Speaker 1>That's where all those the TLS, etcd search

01:03:45.590 --> 01:03:47.190
<v Speaker 1>management comes into play.

01:03:47.510 --> 01:03:48.390
<v Speaker 2>Correct.

01:03:50.230 --> 01:03:50.950
<v Speaker 1>So

01:03:51.110 --> 01:03:53.350
<v Speaker 1>are you saying that you are just flooding

01:03:53.590 --> 01:03:55.510
<v Speaker 1>well, like like I I don't know. I

01:03:55.510 --> 01:03:57.110
<v Speaker 1>I wanna start checking in to see how

01:03:57.110 --> 01:03:59.145
<v Speaker 1>etcd is actually mutating the file system and

01:03:59.145 --> 01:04:00.745
<v Speaker 1>seeing if you're truly filling

01:04:01.065 --> 01:04:02.825
<v Speaker 1>up our file system or at least or

01:04:02.825 --> 01:04:04.505
<v Speaker 1>if you're just filling up what etcd is

01:04:04.505 --> 01:04:07.225
<v Speaker 1>told is the limit for its file system.

01:04:08.745 --> 01:04:11.225
<v Speaker 1>So yeah. Try to set that right there.

01:04:11.225 --> 01:04:13.305
<v Speaker 1>Set that to something substantially larger.

01:04:18.650 --> 01:04:19.690
<v Speaker 1>That's huge.

01:04:21.850 --> 01:04:22.650
<v Speaker 1>I know. I I

01:04:24.090 --> 01:04:25.850
<v Speaker 0>Oh, because it's in a container.

01:04:27.210 --> 01:04:27.530
<v Speaker 1>Yeah.

01:04:28.415 --> 01:04:30.255
<v Speaker 1>Exec into the etcd container.

01:04:31.295 --> 01:04:32.494
<v Speaker 0>I don't know if we can do that

01:04:32.494 --> 01:04:33.855
<v Speaker 0>with cry control.

01:04:34.975 --> 01:04:35.935
<v Speaker 0>Here we can. Okay.

01:04:43.530 --> 01:04:46.490
<v Speaker 1>Exec IT, copy of the name of Yeah.

01:04:46.490 --> 01:04:47.770
<v Speaker 0>It's not there just now.

01:04:49.850 --> 01:04:52.090
<v Speaker 1>Oh, that's probably what's happening is the is

01:04:52.090 --> 01:04:54.810
<v Speaker 1>the container crashing and that explains the restarts

01:04:54.810 --> 01:04:56.490
<v Speaker 1>of the API server as well.

01:04:57.305 --> 01:04:57.945
<v Speaker 1>And

01:05:02.825 --> 01:05:04.425
<v Speaker 0>It's not coming back.

01:05:08.025 --> 01:05:10.025
<v Speaker 1>Look at the API server. Oh, we can't.

01:05:15.660 --> 01:05:17.260
<v Speaker 0>Come back at c d. Let me make

01:05:17.260 --> 01:05:17.820
<v Speaker 0>sure.

01:05:22.300 --> 01:05:23.580
<v Speaker 0>Yeah. It's not gonna work.

01:05:34.744 --> 01:05:36.105
<v Speaker 0>Wonder if oh, we can just add it

01:05:36.105 --> 01:05:36.745
<v Speaker 0>here.

01:05:37.865 --> 01:05:38.265
<v Speaker 1>Yeah.

01:05:49.920 --> 01:05:52.160
<v Speaker 0>Well, that should get restarted by the kubelet

01:05:52.160 --> 01:05:52.640
<v Speaker 0>and

01:05:53.040 --> 01:05:55.040
<v Speaker 1>Check the kubelet logs, journal cuddle f u

01:05:55.040 --> 01:05:55.520
<v Speaker 1>kubelet.

01:05:56.885 --> 01:05:58.325
<v Speaker 1>My favorite command to type.

01:06:16.390 --> 01:06:18.550
<v Speaker 0>Not sure if I see anything NCD ish

01:06:18.550 --> 01:06:19.030
<v Speaker 0>here.

01:06:26.715 --> 01:06:29.515
<v Speaker 1>Where did you edit the YTD pod manifest?

01:06:30.715 --> 01:06:32.555
<v Speaker 0>Yeah. And we oh, it's in a back

01:06:32.555 --> 01:06:33.995
<v Speaker 0>off state, so it may take a bit

01:06:33.995 --> 01:06:35.755
<v Speaker 0>longer to come back. Although, I think maybe

01:06:35.755 --> 01:06:36.235
<v Speaker 0>that's it.

01:06:39.010 --> 01:06:40.930
<v Speaker 0>There? And check can you check the alarms

01:06:40.930 --> 01:06:42.450
<v Speaker 1>again? I wanna see if that alarm came

01:06:42.450 --> 01:06:43.010
<v Speaker 1>back.

01:06:46.609 --> 01:06:48.290
<v Speaker 0>We can't speak to entity yet.

01:06:49.365 --> 01:06:51.525
<v Speaker 1>Yeah. Oh, yeah. Because it's not ready.

01:07:05.525 --> 01:07:06.970
<v Speaker 0>Yeah. Wonder if that number was too big.

01:07:06.970 --> 01:07:08.330
<v Speaker 0>Maybe I'm making it worse.

01:07:08.570 --> 01:07:11.290
<v Speaker 1>That's six that's 16 megs. So change that

01:07:11.290 --> 01:07:12.570
<v Speaker 1>16 to

01:07:12.810 --> 01:07:14.170
<v Speaker 1>one zero two four.

01:07:15.290 --> 01:07:16.010
<v Speaker 1>Nope.

01:07:16.090 --> 01:07:18.090
<v Speaker 1>Get rid of that. There you go. That's

01:07:18.090 --> 01:07:18.490
<v Speaker 1>a gig.

01:07:33.369 --> 01:07:34.410
<v Speaker 0>Failed to delete.

01:07:37.450 --> 01:07:38.250
<v Speaker 2>So if you do

01:07:42.490 --> 01:07:44.250
<v Speaker 2>I guess, it'd be interesting to see what

01:07:44.250 --> 01:07:46.810
<v Speaker 2>CryCuddle is showing nowadays for

01:07:47.355 --> 01:07:48.795
<v Speaker 1>Yeah. Yeah.

01:07:52.955 --> 01:07:53.195
<v Speaker 0>So

01:07:54.075 --> 01:07:54.715
<v Speaker 2>Oh.

01:07:55.355 --> 01:07:56.875
<v Speaker 0>I mean, we can always just restart the

01:07:56.875 --> 01:07:59.195
<v Speaker 0>kubla and try and Yeah. Encourage it.

01:08:00.700 --> 01:08:02.940
<v Speaker 1>Yeah. Go for it. The only other questions

01:08:02.940 --> 01:08:05.020
<v Speaker 2>I have is whether like, I didn't realize

01:08:05.020 --> 01:08:07.660
<v Speaker 2>you could do shell expansion in the

01:08:08.140 --> 01:08:09.340
<v Speaker 2>YAML command

01:08:09.740 --> 01:08:11.420
<v Speaker 2>and the Kubectl command. I didn't realize it

01:08:11.420 --> 01:08:12.380
<v Speaker 2>went through a shell.

01:08:14.620 --> 01:08:15.740
<v Speaker 2>Is that in fact true?

01:08:18.035 --> 01:08:19.715
<v Speaker 1>Where did we do shell inspection? Did we

01:08:19.715 --> 01:08:21.314
<v Speaker 1>tilde when we should have homed?

01:08:21.795 --> 01:08:24.275
<v Speaker 0>Yeah. And here, where we passed the arguments

01:08:24.275 --> 01:08:26.835
<v Speaker 0>then. Yeah. That's not gonna work. Can you

01:08:26.835 --> 01:08:27.795
<v Speaker 2>actually do that?

01:08:28.729 --> 01:08:30.569
<v Speaker 2>I've never done it. So but

01:08:31.050 --> 01:08:32.729
<v Speaker 2>I I would be surprised if we can

01:08:32.729 --> 01:08:34.010
<v Speaker 2>run through bash.

01:08:34.410 --> 01:08:35.849
<v Speaker 1>That's a very good point.

01:08:36.810 --> 01:08:38.809
<v Speaker 1>Yeah. Just change that to

01:08:39.290 --> 01:08:40.330
<v Speaker 1>if it's in bytes,

01:08:43.205 --> 01:08:44.084
<v Speaker 1>There you go.

01:08:47.125 --> 01:08:47.844
<v Speaker 2>Alright.

01:08:48.005 --> 01:08:49.444
<v Speaker 1>And restart the cubelet again.

01:08:58.670 --> 01:09:02.110
<v Speaker 1>And can you list pods or containers? Docker

01:09:02.110 --> 01:09:03.710
<v Speaker 1>p s, Cryocuttle p s?

01:09:04.990 --> 01:09:06.030
<v Speaker 0>Yeah. We still can.

01:09:10.774 --> 01:09:12.774
<v Speaker 0>Or it's not attempted to start

01:09:12.774 --> 01:09:13.814
<v Speaker 0>at c d.

01:09:14.614 --> 01:09:21.734
<v Speaker 0>Kibble log What's

01:09:21.734 --> 01:09:24.774
<v Speaker 2>the Should be it notes not sync.

01:09:25.654 --> 01:09:26.375
<v Speaker 1>There it goes.

01:09:42.015 --> 01:09:43.135
<v Speaker 0>Let's see what

01:09:43.774 --> 01:09:45.295
<v Speaker 0>container d says.

01:09:51.535 --> 01:09:52.734
<v Speaker 2>Oh, it just came back up.

01:09:53.719 --> 01:09:54.440
<v Speaker 1>Yep.

01:09:55.400 --> 01:09:56.360
<v Speaker 1>There

01:09:56.360 --> 01:09:57.800
<v Speaker 1>it is. Yay.

01:10:00.040 --> 01:10:01.239
<v Speaker 0>Disarmed.

01:10:03.560 --> 01:10:04.199
<v Speaker 1>Well done.

01:10:05.495 --> 01:10:07.175
<v Speaker 1>And can you get pods

01:10:07.495 --> 01:10:09.815
<v Speaker 1>and delete those pods quickly quickly? Can you

01:10:09.815 --> 01:10:11.175
<v Speaker 1>delete all now?

01:10:16.135 --> 01:10:16.935
<v Speaker 1>Goddamn it.

01:10:21.030 --> 01:10:22.949
<v Speaker 0>Alright. I guess we're going bigger.

01:10:24.150 --> 01:10:24.949
<v Speaker 0>Alright.

01:10:30.790 --> 01:10:32.305
<v Speaker 1>Alright. Sorry for swearing on your I don't

01:10:32.305 --> 01:10:33.985
<v Speaker 1>I don't know the rules. This is, like,

01:10:33.985 --> 01:10:35.105
<v Speaker 1>corporate something.

01:10:35.665 --> 01:10:37.425
<v Speaker 1>I'm not allowed to swear like a sailor,

01:10:37.425 --> 01:10:38.705
<v Speaker 1>I don't think. People will get mad at

01:10:38.705 --> 01:10:40.305
<v Speaker 1>me. No. There is a code of conduct

01:10:40.305 --> 01:10:42.545
<v Speaker 0>which explicitly states you are allowed to swear,

01:10:42.545 --> 01:10:44.465
<v Speaker 0>but that's about all that's accepted.

01:10:44.865 --> 01:10:47.240
<v Speaker 1>Alright. Okay. I'm gonna give a hint that

01:10:47.240 --> 01:10:49.480
<v Speaker 2>the the pods are just a red herring.

01:10:50.280 --> 01:10:52.520
<v Speaker 0>So something else is filling up at city.

01:10:52.600 --> 01:10:54.680
<v Speaker 2>Yeah. If if you if you look at

01:10:54.680 --> 01:10:56.760
<v Speaker 2>the if you look at the pod manifest,

01:10:56.760 --> 01:10:58.600
<v Speaker 2>you'll see it's just a sleep eighty six

01:10:58.600 --> 01:10:59.400
<v Speaker 2>four hundred.

01:11:00.120 --> 01:11:00.520
<v Speaker 1>Okay.

01:11:05.505 --> 01:11:08.065
<v Speaker 0>Alright. So making that number bigger and restarting

01:11:08.065 --> 01:11:09.585
<v Speaker 0>the kubelet to restart it to d was

01:11:09.585 --> 01:11:11.345
<v Speaker 0>probably pointless because the thing is still running

01:11:11.345 --> 01:11:11.905
<v Speaker 0>on the system.

01:11:14.190 --> 01:11:16.030
<v Speaker 0>Alright. How do we find this road process

01:11:16.030 --> 01:11:16.670
<v Speaker 0>then?

01:11:17.870 --> 01:11:18.990
<v Speaker 1>Is it if

01:11:19.950 --> 01:11:21.950
<v Speaker 1>it's a road process that he put on

01:11:21.950 --> 01:11:23.710
<v Speaker 1>the system, I mean, we can start we

01:11:23.710 --> 01:11:25.470
<v Speaker 1>can start looking in the process tree. I

01:11:25.470 --> 01:11:27.550
<v Speaker 1>I wanted to look and intersect and see,

01:11:27.550 --> 01:11:29.855
<v Speaker 1>like, what has changed on the file system

01:11:29.855 --> 01:11:31.855
<v Speaker 1>in the last day, in the last two

01:11:31.855 --> 01:11:33.295
<v Speaker 1>days, the last three days.

01:11:34.495 --> 01:11:37.375
<v Speaker 1>Thomas is shaking his head no, though. Well,

01:11:38.575 --> 01:11:40.575
<v Speaker 0>I actually say no because he gave us

01:11:40.575 --> 01:11:42.495
<v Speaker 0>a hint. Alright? He said that this listens

01:11:42.495 --> 01:11:43.455
<v Speaker 0>on the public

01:11:44.710 --> 01:11:45.909
<v Speaker 0>thing. So let's

01:11:46.070 --> 01:11:47.430
<v Speaker 0>oh, no. Because it's gotta speak with other

01:11:47.430 --> 01:11:48.390
<v Speaker 0>nodes too.

01:11:48.710 --> 01:11:50.550
<v Speaker 0>How do we if you got something running

01:11:50.550 --> 01:11:51.990
<v Speaker 0>on your own machine that's talking to our

01:11:52.070 --> 01:11:53.190
<v Speaker 0>that's at c d.

01:11:54.870 --> 01:11:57.190
<v Speaker 2>Perhaps IP tables might help.

01:11:58.575 --> 01:12:01.535
<v Speaker 1>Perhaps IP tables. Yeah. List IP IP tables

01:12:01.535 --> 01:12:02.415
<v Speaker 1>cap l.

01:12:02.895 --> 01:12:04.655
<v Speaker 1>Let's just see what we have there. And,

01:12:04.655 --> 01:12:05.535
<v Speaker 2>like,

01:12:05.535 --> 01:12:06.095
<v Speaker 2>look.

01:12:06.735 --> 01:12:08.335
<v Speaker 2>You you may wanna see who all is

01:12:08.335 --> 01:12:09.455
<v Speaker 2>talking to etcd.

01:12:13.560 --> 01:12:14.840
<v Speaker 1>Tell Matt Tolpin

01:12:15.160 --> 01:12:16.760
<v Speaker 1>would at least tell us what all is

01:12:16.760 --> 01:12:18.360
<v Speaker 1>listening and

01:12:19.560 --> 01:12:20.679
<v Speaker 1>where it's listening.

01:12:21.720 --> 01:12:23.480
<v Speaker 0>So do we wanna tell Matt stat and

01:12:23.480 --> 01:12:26.040
<v Speaker 0>look for things on Port 2379?

01:12:26.680 --> 01:12:27.400
<v Speaker 0>Yeah.

01:12:28.040 --> 01:12:28.440
<v Speaker 2>Sure.

01:12:29.295 --> 01:12:30.975
<v Speaker 2>I Close.

01:12:34.655 --> 01:12:36.655
<v Speaker 0>What's what's like starting for next stat to

01:12:36.655 --> 01:12:37.535
<v Speaker 0>get more here?

01:12:38.415 --> 01:12:40.255
<v Speaker 1>Pulp in. I usually do pulp in, but

01:12:40.255 --> 01:12:42.190
<v Speaker 1>you can do whatever. Do you wanna type?

01:12:42.190 --> 01:12:44.510
<v Speaker 0>Because I'm not sure what flags you mean.

01:12:45.469 --> 01:12:46.590
<v Speaker 0>Alright. Okay.

01:12:47.630 --> 01:12:48.269
<v Speaker 2>Yeah.

01:12:50.989 --> 01:12:51.469
<v Speaker 2>So you

01:12:52.190 --> 01:12:54.110
<v Speaker 2>all those acts might be suspicious.

01:12:56.035 --> 01:12:59.315
<v Speaker 1>Right. So 157131124242

01:12:59.315 --> 01:13:01.315
<v Speaker 0>is an IP address we should maybe block.

01:13:01.715 --> 01:13:03.635
<v Speaker 0>Is that an IP address? Yes.

01:13:04.755 --> 01:13:07.075
<v Speaker 2>What? Yes. So he's he it looks like

01:13:07.075 --> 01:13:08.995
<v Speaker 1>he's doing something to add TD from wherever

01:13:08.995 --> 01:13:09.795
<v Speaker 1>this IP is,

01:13:10.570 --> 01:13:12.489
<v Speaker 1>which that looks like

01:13:12.730 --> 01:13:14.650
<v Speaker 1>it's a public IP. I don't recognize at

01:13:14.650 --> 01:13:15.690
<v Speaker 1>the top of my head.

01:13:17.050 --> 01:13:18.650
<v Speaker 0>Alright. So should we just add a drop

01:13:18.650 --> 01:13:19.849
<v Speaker 0>from that IP?

01:13:20.489 --> 01:13:21.370
<v Speaker 1>Sure. Go for it.

01:13:22.345 --> 01:13:24.265
<v Speaker 0>Alright. I'm gonna have to Google IP tables

01:13:24.265 --> 01:13:24.905
<v Speaker 0>now.

01:13:25.385 --> 01:13:27.625
<v Speaker 2>I was gonna say I was expecting I

01:13:27.785 --> 01:13:29.625
<v Speaker 2>wasn't expecting to see the hint in the

01:13:29.625 --> 01:13:31.225
<v Speaker 2>next step. I was expecting that you were

01:13:31.225 --> 01:13:33.465
<v Speaker 2>gonna have to look in TCP dump or

01:13:33.465 --> 01:13:34.505
<v Speaker 2>or something of that nature.

01:13:36.940 --> 01:13:38.540
<v Speaker 1>So you did mess with the network. Have

01:13:38.540 --> 01:13:39.499
<v Speaker 2>to solve that issue.

01:13:41.260 --> 01:13:42.139
<v Speaker 0>Okay.

01:13:42.219 --> 01:13:43.979
<v Speaker 0>So we'll just do

01:13:44.860 --> 01:13:45.659
<v Speaker 0>157

01:13:45.820 --> 01:13:47.420
<v Speaker 0>You can do a Four.

01:13:49.474 --> 01:13:50.274
<v Speaker 1>A s 20

01:13:51.235 --> 01:13:52.834
<v Speaker 0>four. That? No?

01:13:53.315 --> 01:13:54.835
<v Speaker 1>You can do a 30. Or yeah, that's

01:13:54.835 --> 01:13:55.474
<v Speaker 1>fine.

01:13:57.715 --> 01:13:58.434
<v Speaker 1>J drop.

01:14:02.000 --> 01:14:04.080
<v Speaker 1>And run the net stat again for me,

01:14:04.080 --> 01:14:04.559
<v Speaker 1>please.

01:14:09.360 --> 01:14:10.639
<v Speaker 1>Last act.

01:14:10.640 --> 01:14:13.360
<v Speaker 0>Should we restart etcd to would that flush

01:14:13.360 --> 01:14:14.320
<v Speaker 0>those connections?

01:14:15.120 --> 01:14:16.160
<v Speaker 1>Yeah. Go for it.

01:14:21.175 --> 01:14:23.255
<v Speaker 1>Did Thomas, did you grab the go

01:14:24.375 --> 01:14:24.935
<v Speaker 1>ahead.

01:14:25.335 --> 01:14:27.095
<v Speaker 2>I was gonna say I just noticed in

01:14:27.095 --> 01:14:28.375
<v Speaker 2>another window that

01:14:30.055 --> 01:14:32.455
<v Speaker 2>something that I had been observing has changed

01:14:32.455 --> 01:14:33.015
<v Speaker 2>state

01:14:34.300 --> 01:14:36.380
<v Speaker 2>in that I can no longer connect to

01:14:36.540 --> 01:14:38.220
<v Speaker 2>it no it can no longer connect to

01:14:38.220 --> 01:14:39.180
<v Speaker 2>etcd. So

01:14:39.900 --> 01:14:41.820
<v Speaker 1>I see. You did put something outside of

01:14:41.820 --> 01:14:42.620
<v Speaker 1>the cluster.

01:14:43.180 --> 01:14:45.020
<v Speaker 1>So oh, okay. I was polite. I put

01:14:45.020 --> 01:14:47.420
<v Speaker 1>in a teammate backdoor in that container

01:14:47.565 --> 01:14:49.405
<v Speaker 1>that I could at least host exec through,

01:14:49.405 --> 01:14:51.085
<v Speaker 1>but I didn't like, I'm not running anything

01:14:51.085 --> 01:14:53.245
<v Speaker 1>on any of my local boxes. That's just

01:14:53.245 --> 01:14:54.125
<v Speaker 1>not nice.

01:14:54.605 --> 01:14:56.605
<v Speaker 0>I thought this was easy, but Thomas, come

01:14:56.605 --> 01:14:58.125
<v Speaker 0>on. Yeah. It

01:14:58.685 --> 01:15:01.005
<v Speaker 2>just a very simple denial of service attack.

01:15:01.005 --> 01:15:02.810
<v Speaker 2>That's it. Alright.

01:15:03.450 --> 01:15:05.130
<v Speaker 0>Did you h But now you still you

01:15:05.130 --> 01:15:05.770
<v Speaker 2>still have to

01:15:06.490 --> 01:15:08.090
<v Speaker 2>so I can know you know, it's no

01:15:08.090 --> 01:15:09.929
<v Speaker 2>longer mutating anything. So

01:15:11.530 --> 01:15:14.250
<v Speaker 1>Sure. So whatever it was mutated.

01:15:14.970 --> 01:15:17.370
<v Speaker 1>Yeah. Alright. So we have h t d

01:15:18.495 --> 01:15:19.375
<v Speaker 0>endpoint

01:15:19.455 --> 01:15:20.335
<v Speaker 0>health.

01:15:21.535 --> 01:15:22.815
<v Speaker 0>There's no response He

01:15:24.175 --> 01:15:27.135
<v Speaker 1>he dossed etcd on the public port on

01:15:27.135 --> 01:15:29.055
<v Speaker 1>our cluster, which was preventing us from

01:15:31.160 --> 01:15:33.080
<v Speaker 1>scheduling work in our cluster because that CD

01:15:33.080 --> 01:15:34.120
<v Speaker 1>was filling up.

01:15:36.920 --> 01:15:38.920
<v Speaker 1>So I think let's let's try to tidy

01:15:38.920 --> 01:15:41.400
<v Speaker 1>up at CD. Let's get the API server

01:15:41.400 --> 01:15:42.199
<v Speaker 1>healthy

01:15:42.200 --> 01:15:43.719
<v Speaker 1>and let's

01:15:44.200 --> 01:15:45.880
<v Speaker 1>I like, I mean, obviously, I wanna start

01:15:45.880 --> 01:15:46.840
<v Speaker 1>looking at other

01:15:47.215 --> 01:15:49.375
<v Speaker 1>networking rules in this infrastructure, but we can

01:15:49.375 --> 01:15:51.775
<v Speaker 1>talk about that later after breakfast. I will

01:15:51.775 --> 01:15:54.095
<v Speaker 2>say you have you have solved the the

01:15:54.095 --> 01:15:56.655
<v Speaker 2>the main, like, root cause here. Although, you

01:15:56.655 --> 01:15:58.175
<v Speaker 2>still have to clean up after it.

01:15:58.815 --> 01:15:59.135
<v Speaker 1>Right.

01:15:59.679 --> 01:16:02.400
<v Speaker 1>The whole pods are are gone or at

01:16:02.400 --> 01:16:04.800
<v Speaker 0>least they're going. So that's a star.

01:16:06.079 --> 01:16:07.119
<v Speaker 1>Well done.

01:16:10.480 --> 01:16:12.320
<v Speaker 0>Was there anything else on this system that

01:16:12.320 --> 01:16:12.480
<v Speaker 0>we

01:16:13.615 --> 01:16:16.655
<v Speaker 1>Can you list containers really quick for me?

01:16:22.095 --> 01:16:22.895
<v Speaker 1>Okay.

01:16:24.495 --> 01:16:25.295
<v Speaker 1>Thank you.

01:16:26.300 --> 01:16:28.540
<v Speaker 1>And try to run your deployment, yeah, one

01:16:28.540 --> 01:16:29.260
<v Speaker 1>more time.

01:16:31.739 --> 01:16:33.660
<v Speaker 1>Sorry. I'm just barking commands at you. I

01:16:33.660 --> 01:16:35.180
<v Speaker 1>apologize. Oh, no. Please, the

01:16:36.380 --> 01:16:37.420
<v Speaker 0>let's make sure.

01:16:37.820 --> 01:16:39.099
<v Speaker 0>Yeah. I think

01:16:39.900 --> 01:16:41.020
<v Speaker 0>Yeah. It's happy.

01:16:42.095 --> 01:16:44.735
<v Speaker 2>So the the key here was actually you

01:16:44.735 --> 01:16:47.935
<v Speaker 2>increasing the the space for ETCD

01:16:48.655 --> 01:16:51.535
<v Speaker 2>Mhmm. And combined with the lack

01:16:51.935 --> 01:16:52.655
<v Speaker 2>of

01:16:52.895 --> 01:16:55.455
<v Speaker 2>my scripts to DOS the

01:16:56.255 --> 01:16:56.895
<v Speaker 2>the data.

01:16:58.010 --> 01:17:00.010
<v Speaker 0>So can I just confirm them? Right?

01:17:00.650 --> 01:17:02.329
<v Speaker 0>That is how STD

01:17:02.570 --> 01:17:03.289
<v Speaker 0>works

01:17:04.090 --> 01:17:06.330
<v Speaker 2>Right. On a Kubernetes cluster. Like, so anyone

01:17:06.330 --> 01:17:07.850
<v Speaker 0>could do that to any public STD that

01:17:07.850 --> 01:17:10.090
<v Speaker 0>they found. You no. You you have to

01:17:10.090 --> 01:17:12.244
<v Speaker 2>have the certs. Alright. Okay. So I'm just

01:17:12.244 --> 01:17:13.764
<v Speaker 0>actually That's

01:17:13.764 --> 01:17:16.485
<v Speaker 0>what I was worried about. Okay. So Yeah.

01:17:16.965 --> 01:17:17.764
<v Speaker 1>So

01:17:17.844 --> 01:17:19.044
<v Speaker 1>the the

01:17:19.205 --> 01:17:21.284
<v Speaker 1>the takeaway here, just kinda play it back,

01:17:21.525 --> 01:17:22.164
<v Speaker 1>you

01:17:22.565 --> 01:17:24.724
<v Speaker 1>scheduled a pod, you grabbed the STD certs

01:17:25.440 --> 01:17:27.040
<v Speaker 1>from the system because I mean, we we

01:17:27.040 --> 01:17:28.960
<v Speaker 1>had root. Once you had the certs, you

01:17:28.960 --> 01:17:31.840
<v Speaker 1>then effectively I mean, etcd cuddle is a

01:17:31.840 --> 01:17:33.600
<v Speaker 1>well known tool. So you used etcd cuddle

01:17:33.600 --> 01:17:35.120
<v Speaker 1>to hit what you knew was a publicly

01:17:35.120 --> 01:17:37.200
<v Speaker 1>listening TCP port.

01:17:37.360 --> 01:17:39.675
<v Speaker 1>And from there, you had the keys to

01:17:39.675 --> 01:17:41.594
<v Speaker 1>etcd and you just decided to pick on

01:17:41.594 --> 01:17:42.794
<v Speaker 1>etcd for us.

01:17:44.074 --> 01:17:46.954
<v Speaker 2>Yep. Just just flooding etcd with rights.

01:17:48.155 --> 01:17:48.794
<v Speaker 1>Lovely.

01:17:48.955 --> 01:17:50.875
<v Speaker 1>Okay. So let's can I can I can

01:17:50.875 --> 01:17:52.074
<v Speaker 1>we just check a few things here? I'm

01:17:52.074 --> 01:17:53.719
<v Speaker 1>just curious why why we're here. This is

01:17:53.719 --> 01:17:55.079
<v Speaker 1>a great learning opportunity.

01:17:55.320 --> 01:17:56.760
<v Speaker 1>Can you go back to that where that

01:17:56.760 --> 01:17:59.640
<v Speaker 1>main directory where those those dot w files,

01:17:59.640 --> 01:18:01.320
<v Speaker 1>whatever they were, the etcd rights?

01:18:02.040 --> 01:18:04.519
<v Speaker 0>Yeah. The far left

01:18:05.719 --> 01:18:07.800
<v Speaker 0>etcd Yeah. And the right head log. So

01:18:07.880 --> 01:18:08.440
<v Speaker 0>oh, member.

01:18:09.185 --> 01:18:09.985
<v Speaker 1>There

01:18:10.785 --> 01:18:13.825
<v Speaker 1>you go. And can we just see how

01:18:13.825 --> 01:18:16.625
<v Speaker 1>big these are now? I'm just curious how

01:18:17.105 --> 01:18:19.105
<v Speaker 1>how much of the etcd of these rights

01:18:19.105 --> 01:18:20.385
<v Speaker 1>are being persisted,

01:18:21.665 --> 01:18:23.105
<v Speaker 1>and how much of them are still there?

01:18:27.449 --> 01:18:29.689
<v Speaker 2>Etcd by default will at least

01:18:30.250 --> 01:18:32.889
<v Speaker 2>as as configured here, will only allow 2.1

01:18:32.889 --> 01:18:34.489
<v Speaker 2>gigs of data to be stored.

01:18:35.210 --> 01:18:35.769
<v Speaker 1>Yeah.

01:18:36.170 --> 01:18:37.929
<v Speaker 2>It's pretty trivial to flood that.

01:18:39.355 --> 01:18:42.315
<v Speaker 1>Interesting. This is a great exploit. Good job.

01:18:42.555 --> 01:18:44.795
<v Speaker 1>I did not realize ETCD was this

01:18:46.875 --> 01:18:48.955
<v Speaker 1>subject to to flooding. But again, like the

01:18:48.955 --> 01:18:51.195
<v Speaker 1>certs is this is a really good one.

01:18:51.740 --> 01:18:54.780
<v Speaker 2>Yeah. I was I was going with TLS

01:18:54.780 --> 01:18:57.500
<v Speaker 2>flooding instead, but it seems like etcd is

01:18:57.500 --> 01:18:59.420
<v Speaker 2>no longer it's no longer an issue for

01:18:59.420 --> 01:19:00.540
<v Speaker 2>etcd to

01:19:01.500 --> 01:19:02.060
<v Speaker 2>to

01:19:02.620 --> 01:19:04.540
<v Speaker 2>a lot of the DOS attacks I had

01:19:04.540 --> 01:19:05.980
<v Speaker 2>considered were no longer worked.

01:19:06.994 --> 01:19:09.794
<v Speaker 1>I see. I I remember hearing

01:19:11.235 --> 01:19:13.314
<v Speaker 1>some some HP floods

01:19:13.474 --> 01:19:15.474
<v Speaker 1>on a couple of the Kubernetes components back

01:19:15.474 --> 01:19:18.034
<v Speaker 1>in the day, but I haven't actually seen

01:19:18.514 --> 01:19:19.954
<v Speaker 1>I haven't seen anything like this. So I'm

01:19:19.954 --> 01:19:22.670
<v Speaker 1>just like, can you just share a little

01:19:22.670 --> 01:19:24.750
<v Speaker 1>bit about your flood? Just, like, you don't

01:19:24.830 --> 01:19:25.710
<v Speaker 1>I don't have to see it, but I'm

01:19:25.710 --> 01:19:27.150
<v Speaker 1>just curious. Were you just able to write,

01:19:27.150 --> 01:19:28.670
<v Speaker 1>like, a megabyte of data and just flood

01:19:28.670 --> 01:19:29.870
<v Speaker 1>that in a loop or something?

01:19:30.430 --> 01:19:31.790
<v Speaker 2>Yeah. That's basically

01:19:32.270 --> 01:19:35.390
<v Speaker 2>so at etcd cuddle has a put command,

01:19:35.630 --> 01:19:36.990
<v Speaker 2>and you can put random keys.

01:19:38.405 --> 01:19:40.245
<v Speaker 2>In fact, you can actually just keep putting

01:19:40.245 --> 01:19:42.005
<v Speaker 2>to the same key, and an an etcd

01:19:42.005 --> 01:19:44.725
<v Speaker 2>will store each revision. So it's a d

01:19:44.725 --> 01:19:46.085
<v Speaker 2>d of dev random

01:19:46.645 --> 01:19:50.005
<v Speaker 2>into the etcd cuddle. And so Oh. You

01:19:50.005 --> 01:19:52.805
<v Speaker 1>can piped you piped dev random to etcd

01:19:52.805 --> 01:19:53.125
<v Speaker 1>cuddle?

01:19:53.739 --> 01:19:56.619
<v Speaker 2>Yeah. So you can use the so we

01:19:56.619 --> 01:19:58.540
<v Speaker 2>talked about compact and defrag, and we showed

01:19:58.540 --> 01:19:59.739
<v Speaker 2>those off late earlier.

01:19:59.980 --> 01:20:01.980
<v Speaker 2>And had it only been writing to the

01:20:01.980 --> 01:20:04.380
<v Speaker 2>same key, that could have helped. But

01:20:05.179 --> 01:20:06.860
<v Speaker 2>I decided in the end actually just to

01:20:06.860 --> 01:20:08.380
<v Speaker 2>write to random key names as well, and

01:20:08.380 --> 01:20:09.864
<v Speaker 2>it was no longer helpful.

01:20:11.145 --> 01:20:11.945
<v Speaker 1>Interesting.

01:20:12.665 --> 01:20:16.025
<v Speaker 1>Awesome. Great. I've I've learned awful lot from

01:20:16.025 --> 01:20:17.625
<v Speaker 0>both of you today. So

01:20:18.345 --> 01:20:20.105
<v Speaker 0>thank you very much for joining me. I

01:20:20.105 --> 01:20:21.465
<v Speaker 0>don't think we have time to give you

01:20:21.465 --> 01:20:22.585
<v Speaker 0>my cluster,

01:20:22.665 --> 01:20:22.745
<v Speaker 0>so

01:20:23.760 --> 01:20:25.760
<v Speaker 0>I'll maybe open it up to people on

01:20:25.760 --> 01:20:27.679
<v Speaker 0>Twitter or something. I don't know yet.

01:20:28.320 --> 01:20:29.599
<v Speaker 0>Because we've already done it over time. I

01:20:29.599 --> 01:20:30.960
<v Speaker 0>won't I won't keep you any longer. But

01:20:30.960 --> 01:20:32.960
<v Speaker 0>thank you both for joining me. There's lots

01:20:32.960 --> 01:20:35.359
<v Speaker 0>of knowledge here shared and I appreciate that.

01:20:35.360 --> 01:20:37.039
<v Speaker 0>And I hope you both have a wonderful

01:20:37.039 --> 01:20:37.199
<v Speaker 0>day.

01:20:38.225 --> 01:20:39.744
<v Speaker 0>Any last words?

01:20:41.425 --> 01:20:43.105
<v Speaker 1>Thomas, I'd love to catch up after this

01:20:43.105 --> 01:20:44.625
<v Speaker 1>and, like, nice to meet both of you

01:20:44.625 --> 01:20:46.625
<v Speaker 1>face to face. But, yeah, this has been

01:20:46.625 --> 01:20:48.385
<v Speaker 1>so much fun. Thanks for inviting me. This

01:20:48.385 --> 01:20:49.745
<v Speaker 1>was I had so much fun with this.

01:20:49.745 --> 01:20:51.700
<v Speaker 1>This was really good for me. My therapist

01:20:51.700 --> 01:20:54.020
<v Speaker 1>agrees. This is this is good for me.

01:20:54.660 --> 01:20:57.220
<v Speaker 2>Yeah. Same. I I learned a lot just

01:20:57.220 --> 01:20:59.700
<v Speaker 2>from, you know, not only building the case,

01:20:59.700 --> 01:21:01.700
<v Speaker 2>but seeing seeing the case solved. So

01:21:02.260 --> 01:21:03.620
<v Speaker 2>and as well from

01:21:03.700 --> 01:21:06.735
<v Speaker 2>your your evil. That that could have been

01:21:06.735 --> 01:21:07.695
<v Speaker 2>really brutal.

01:21:08.415 --> 01:21:10.095
<v Speaker 1>I I so I'm glad I I kept

01:21:10.095 --> 01:21:11.695
<v Speaker 1>it where I did, and I left I

01:21:11.695 --> 01:21:13.135
<v Speaker 1>left, like, a good a good set of

01:21:13.135 --> 01:21:14.575
<v Speaker 1>breadcrumbs for you. Yeah.

01:21:14.895 --> 01:21:16.495
<v Speaker 1>I I will do a write up on

01:21:16.495 --> 01:21:18.015
<v Speaker 1>mine, and I'll probably do a write up

01:21:18.015 --> 01:21:20.175
<v Speaker 1>on yours as well on my blog after

01:21:20.175 --> 01:21:20.655
<v Speaker 1>all this.

01:21:21.610 --> 01:21:22.489
<v Speaker 2>Sounds good.

01:21:22.970 --> 01:21:24.650
<v Speaker 2>Awesome. I'll send you the commands.

01:21:25.850 --> 01:21:28.250
<v Speaker 0>Alright. Well, thank you both again. Have a

01:21:28.250 --> 01:21:29.610
<v Speaker 0>great day, and I'll speak to you soon.

01:21:29.610 --> 01:21:29.850
<v Speaker 0>Bye.
