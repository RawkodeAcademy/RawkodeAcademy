WEBVTT

NOTE
Transcription provided by Deepgram
Request Id: bf9e6258-8c70-45cd-964e-db0aa55f1a97
Created: 2025-04-29T15:45:11.297Z
Duration: 209.04419
Channels: 1

00:00:00.000 --> 00:00:03.600
<v Speaker 0>Okay. In this short video, I wanna show

00:00:03.600 --> 00:00:06.320
<v Speaker 0>you where we are with Shopify.

00:00:06.720 --> 00:00:10.320
<v Speaker 0>Shopify is an OAuth two credential

00:00:10.320 --> 00:00:11.200
<v Speaker 0>manager

00:00:11.280 --> 00:00:12.639
<v Speaker 0>for Kubernetes.

00:00:13.200 --> 00:00:15.105
<v Speaker 0>So the first thing we're gonna do is

00:00:15.105 --> 00:00:17.505
<v Speaker 0>apply an OAuth API

00:00:17.505 --> 00:00:18.305
<v Speaker 0>spec.

00:00:19.105 --> 00:00:21.185
<v Speaker 0>What does that look like? Well, we can

00:00:21.185 --> 00:00:24.064
<v Speaker 0>take a look at our discord. Yaml here.

00:00:24.465 --> 00:00:26.225
<v Speaker 0>The first thing we define is our OAuth

00:00:26.225 --> 00:00:29.529
<v Speaker 0>API. Here I'm defining one for Discord.

00:00:30.169 --> 00:00:33.290
<v Speaker 0>Now it has a few HTTP based settings,

00:00:33.290 --> 00:00:35.210
<v Speaker 0>such as the base URL,

00:00:35.930 --> 00:00:37.290
<v Speaker 0>the authorization

00:00:37.290 --> 00:00:38.649
<v Speaker 0>header prefix,

00:00:39.129 --> 00:00:41.050
<v Speaker 0>and then some headers that are expected to

00:00:41.050 --> 00:00:42.809
<v Speaker 0>go along with the request.

00:00:43.905 --> 00:00:47.025
<v Speaker 0>We also can configure the authorization method.

00:00:47.025 --> 00:00:49.345
<v Speaker 0>Here, we set the authorization URL and the

00:00:49.345 --> 00:00:50.465
<v Speaker 0>token URL.

00:00:50.945 --> 00:00:53.905
<v Speaker 0>Discord also requires that we specify the response

00:00:53.905 --> 00:00:56.820
<v Speaker 0>type and the grant type. So those are

00:00:56.820 --> 00:00:59.379
<v Speaker 0>specified under the authorization prompt.

00:01:00.339 --> 00:01:01.780
<v Speaker 0>Next, we can define,

00:01:03.539 --> 00:01:05.700
<v Speaker 0>try not to reveal anything secret here,

00:01:06.180 --> 00:01:07.460
<v Speaker 0>the OAuth connection.

00:01:08.295 --> 00:01:10.534
<v Speaker 0>The OAuth connection has a name of Discord

00:01:10.534 --> 00:01:12.534
<v Speaker 0>and we tell it which API this connection

00:01:12.534 --> 00:01:14.615
<v Speaker 0>is for. This means you can have multiple

00:01:14.615 --> 00:01:18.215
<v Speaker 0>OAuth connections for the Discord API with different

00:01:18.215 --> 00:01:19.975
<v Speaker 0>users or scopes if required.

00:01:21.070 --> 00:01:23.150
<v Speaker 0>Next, we define the scopes that we want,

00:01:23.310 --> 00:01:26.270
<v Speaker 0>and then we specify where the credentials,

00:01:26.270 --> 00:01:28.350
<v Speaker 0>the client ID and the client secret

00:01:28.350 --> 00:01:30.190
<v Speaker 0>for this API live.

00:01:30.750 --> 00:01:33.790
<v Speaker 0>Here, we're using a secret ref to OAuth

00:01:33.855 --> 00:01:34.735
<v Speaker 0>connection

00:01:34.735 --> 00:01:35.695
<v Speaker 0>Discord,

00:01:35.775 --> 00:01:37.695
<v Speaker 0>and we specify the keys used for the

00:01:37.695 --> 00:01:39.695
<v Speaker 0>client ID and the client secret.

00:01:40.095 --> 00:01:42.975
<v Speaker 0>And I have these specified in this file,

00:01:43.375 --> 00:01:45.055
<v Speaker 0>but I'm not going to show you that.

00:01:47.920 --> 00:01:51.360
<v Speaker 0>We can apply our examples Discord

00:01:51.520 --> 00:01:52.400
<v Speaker 0>like so.

00:01:53.440 --> 00:01:56.240
<v Speaker 0>From here, we can run get auth

00:01:57.040 --> 00:01:58.960
<v Speaker 0>APIs and we'll see that we have our

00:01:58.960 --> 00:02:00.160
<v Speaker 0>Discord API.

00:02:00.640 --> 00:02:01.920
<v Speaker 0>If we describe it,

00:02:04.314 --> 00:02:06.715
<v Speaker 0>we'll just see that it is registered

00:02:06.715 --> 00:02:09.194
<v Speaker 0>and there's not really too much to do

00:02:09.194 --> 00:02:10.075
<v Speaker 0>with this.

00:02:11.035 --> 00:02:11.835
<v Speaker 0>However,

00:02:11.915 --> 00:02:14.235
<v Speaker 0>I also have my OAuth

00:02:14.475 --> 00:02:15.035
<v Speaker 0>connection.

00:02:16.680 --> 00:02:18.840
<v Speaker 0>And if we describe this

00:02:19.640 --> 00:02:20.840
<v Speaker 0>OAuth connections,

00:02:28.775 --> 00:02:30.375
<v Speaker 0>Then we'll see that we have our OAuth

00:02:30.375 --> 00:02:32.935
<v Speaker 0>connection now. It started initializing.

00:02:33.015 --> 00:02:34.935
<v Speaker 0>It detected that we actually have the client

00:02:34.935 --> 00:02:36.455
<v Speaker 0>ID and secret available.

00:02:36.614 --> 00:02:39.575
<v Speaker 0>So we're currently in the disconnected state.

00:02:39.894 --> 00:02:41.655
<v Speaker 0>This is OAuth, so we have to do

00:02:41.655 --> 00:02:44.135
<v Speaker 0>the OAuth dance. No ifs, no buts.

00:02:45.360 --> 00:02:46.640
<v Speaker 0>So if we jump over to the web

00:02:46.640 --> 00:02:48.160
<v Speaker 0>interface for Shopify

00:02:48.160 --> 00:02:49.520
<v Speaker 0>and hit refresh,

00:02:49.840 --> 00:02:52.480
<v Speaker 0>you'll see that we now have a disconnected

00:02:52.480 --> 00:02:53.760
<v Speaker 0>Discord API.

00:02:54.560 --> 00:02:55.600
<v Speaker 0>We can click connect,

00:02:57.055 --> 00:02:58.175
<v Speaker 0>does a dance,

00:02:58.735 --> 00:03:01.375
<v Speaker 0>and now our API is connected.

00:03:01.535 --> 00:03:02.815
<v Speaker 0>There we go.

00:03:03.455 --> 00:03:06.175
<v Speaker 0>Our phase is set to connected,

00:03:06.415 --> 00:03:08.334
<v Speaker 0>which is good. And if we run get

00:03:08.334 --> 00:03:10.175
<v Speaker 0>secrets, we'll see that we have the shop

00:03:10.175 --> 00:03:11.694
<v Speaker 0>AI Discord secret.

00:03:12.300 --> 00:03:13.580
<v Speaker 0>Of course, I'm not gonna show you this

00:03:13.580 --> 00:03:15.260
<v Speaker 0>secret because that will give away my OAuth

00:03:15.260 --> 00:03:15.900
<v Speaker 0>token.

00:03:16.300 --> 00:03:18.940
<v Speaker 0>But now, the secret is under management of

00:03:18.940 --> 00:03:19.660
<v Speaker 0>shop I.

00:03:20.349 --> 00:03:23.309
<v Speaker 0>Whenever our OAuth token is about to expire,

00:03:23.309 --> 00:03:27.069
<v Speaker 0>Shopify will request a refresh from Discord.

00:03:28.109 --> 00:03:28.909
<v Speaker 0>Happy OAuth.
