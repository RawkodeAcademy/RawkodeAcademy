---
import type { CollectionEntry } from "astro:content";

interface Props {
	article: CollectionEntry<"articles">;
	authors: Array<{ data: { name: string } }>;
	imageUrl?: URL; // absolute URL if available
	// Allow placement into a named slot in parents (for TS exactOptionalPropertyTypes)
	slot?: string;
}

const { article, authors, imageUrl } = Astro.props;

const jsonLd = {
	"@context": "https://schema.org",
	"@type": "TechArticle",
	headline: article.data.title,
	author: authors.map((a) => ({ "@type": "Person", name: a.data.name })),
	datePublished: new Date(article.data.publishedAt).toISOString(),
	dateModified: new Date(
		article.data.updatedAt ?? article.data.publishedAt,
	).toISOString(),
	mainEntityOfPage: { "@type": "WebPage", "@id": Astro.url.href },
	image: imageUrl
		? imageUrl.href
		: new URL("/android-chrome-512x512.png", Astro.site || Astro.url).href,
};
---

<script is:inline type="application/ld+json" set:html={JSON.stringify(jsonLd)} />
